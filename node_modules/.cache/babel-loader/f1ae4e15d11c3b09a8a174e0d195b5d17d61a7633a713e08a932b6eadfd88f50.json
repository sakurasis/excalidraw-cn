{"ast":null,"code":"import{register as registerServiceWorker}from\"../serviceWorkerRegistration\";import{EVENT}from\"../constants\";// On Apple mobile devices add the proprietary app icon and splashscreen markup.\n// No one should have to do this manually, and eventually this annoyance will\n// go away once https://bugs.webkit.org/show_bug.cgi?id=183937 is fixed.\nif(/\\b(iPad|iPhone|iPod|Safari)\\b/.test(navigator.userAgent)&&!matchMedia(\"(display-mode: standalone)\").matches){import(/* webpackChunkName: \"pwacompat\" */\"pwacompat\");}registerServiceWorker({onUpdate:function onUpdate(registration){var waitingServiceWorker=registration.waiting;if(waitingServiceWorker){waitingServiceWorker.addEventListener(EVENT.STATE_CHANGE,function(event){var target=event.target;var state=target.state;if(state===\"activated\"){window.location.reload();}});waitingServiceWorker.postMessage({type:\"SKIP_WAITING\"});}}});","map":{"version":3,"names":["register","registerServiceWorker","EVENT","test","navigator","userAgent","matchMedia","matches","onUpdate","registration","waitingServiceWorker","waiting","addEventListener","STATE_CHANGE","event","target","state","window","location","reload","postMessage","type"],"sources":["D:/project/excalidraw-cn/src/excalidraw-app/pwa.ts"],"sourcesContent":["import { register as registerServiceWorker } from \"../serviceWorkerRegistration\";\nimport { EVENT } from \"../constants\";\n\n// On Apple mobile devices add the proprietary app icon and splashscreen markup.\n// No one should have to do this manually, and eventually this annoyance will\n// go away once https://bugs.webkit.org/show_bug.cgi?id=183937 is fixed.\nif (\n  /\\b(iPad|iPhone|iPod|Safari)\\b/.test(navigator.userAgent) &&\n  !matchMedia(\"(display-mode: standalone)\").matches\n) {\n  import(/* webpackChunkName: \"pwacompat\" */ \"pwacompat\");\n}\n\nregisterServiceWorker({\n  onUpdate: (registration) => {\n    const waitingServiceWorker = registration.waiting;\n    if (waitingServiceWorker) {\n      waitingServiceWorker.addEventListener(\n        EVENT.STATE_CHANGE,\n        (event: Event) => {\n          const target = event.target as ServiceWorker;\n          const state = target.state as ServiceWorkerState;\n          if (state === \"activated\") {\n            window.location.reload();\n          }\n        },\n      );\n      waitingServiceWorker.postMessage({ type: \"SKIP_WAITING\" });\n    }\n  },\n});\n"],"mappings":"AAAA,OAASA,QAAQ,GAAI,CAAAC,qBAAqB,KAAQ,8BAA8B,CAChF,OAASC,KAAK,KAAQ,cAAc,CAEpC;AACA;AACA;AACA,GACE,+BAA+B,CAACC,IAAI,CAACC,SAAS,CAACC,SAAS,CAAC,EACzD,CAACC,UAAU,CAAC,4BAA4B,CAAC,CAACC,OAAO,CACjD,CACA,MAAM,CAAC,mCAAoC,WAAW,CAAC,CACzD,CAEAN,qBAAqB,CAAC,CACpBO,QAAQ,CAAE,SAAAA,SAACC,YAAY,CAAK,CAC1B,GAAM,CAAAC,oBAAoB,CAAGD,YAAY,CAACE,OAAO,CACjD,GAAID,oBAAoB,CAAE,CACxBA,oBAAoB,CAACE,gBAAgB,CACnCV,KAAK,CAACW,YAAY,CAClB,SAACC,KAAY,CAAK,CAChB,GAAM,CAAAC,MAAM,CAAGD,KAAK,CAACC,MAAuB,CAC5C,GAAM,CAAAC,KAAK,CAAGD,MAAM,CAACC,KAA2B,CAChD,GAAIA,KAAK,GAAK,WAAW,CAAE,CACzBC,MAAM,CAACC,QAAQ,CAACC,MAAM,EAAE,CAC1B,CACF,CAAC,CACF,CACDT,oBAAoB,CAACU,WAAW,CAAC,CAAEC,IAAI,CAAE,cAAe,CAAC,CAAC,CAC5D,CACF,CACF,CAAC,CAAC"},"metadata":{},"sourceType":"module","externalDependencies":[]}