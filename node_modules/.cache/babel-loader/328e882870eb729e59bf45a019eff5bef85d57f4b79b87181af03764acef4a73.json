{"ast":null,"code":"import _toConsumableArray from\"D:/project/excalidraw-cn/node_modules/@babel/runtime/helpers/esm/toConsumableArray.js\";import _objectSpread from\"D:/project/excalidraw-cn/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import{register}from\"./register\";import{deepCopyElement}from\"../element/newElement\";import{randomId}from\"../random\";import{t}from\"../i18n\";export var actionAddToLibrary=register({name:\"addToLibrary\",trackEvent:{category:\"element\"},perform:function perform(elements,appState,_,app){var selectedElements=app.scene.getSelectedElements({selectedElementIds:appState.selectedElementIds,includeBoundTextElement:true,includeElementsInFrames:true});if(selectedElements.some(function(element){return element.type===\"image\";})){return{commitToHistory:false,appState:_objectSpread(_objectSpread({},appState),{},{errorMessage:\"Support for adding images to the library coming soon!\"})};}return app.library.getLatestLibrary().then(function(items){return app.library.setLibrary([{id:randomId(),status:\"unpublished\",elements:selectedElements.map(deepCopyElement),created:Date.now()}].concat(_toConsumableArray(items)));}).then(function(){return{commitToHistory:false,appState:_objectSpread(_objectSpread({},appState),{},{toast:{message:t(\"toast.addedToLibrary\")}})};}).catch(function(error){return{commitToHistory:false,appState:_objectSpread(_objectSpread({},appState),{},{errorMessage:error.message})};});},contextItemLabel:\"labels.addToLibrary\"});","map":{"version":3,"names":["register","deepCopyElement","randomId","t","actionAddToLibrary","name","trackEvent","category","perform","elements","appState","_","app","selectedElements","scene","getSelectedElements","selectedElementIds","includeBoundTextElement","includeElementsInFrames","some","element","type","commitToHistory","_objectSpread","errorMessage","library","getLatestLibrary","then","items","setLibrary","id","status","map","created","Date","now","concat","_toConsumableArray","toast","message","catch","error","contextItemLabel"],"sources":["D:/project/excalidraw-cn/src/actions/actionAddToLibrary.ts"],"sourcesContent":["import { register } from \"./register\";\nimport { deepCopyElement } from \"../element/newElement\";\nimport { randomId } from \"../random\";\nimport { t } from \"../i18n\";\n\nexport const actionAddToLibrary = register({\n  name: \"addToLibrary\",\n  trackEvent: { category: \"element\" },\n  perform: (elements, appState, _, app) => {\n    const selectedElements = app.scene.getSelectedElements({\n      selectedElementIds: appState.selectedElementIds,\n      includeBoundTextElement: true,\n      includeElementsInFrames: true,\n    });\n    if (selectedElements.some((element) => element.type === \"image\")) {\n      return {\n        commitToHistory: false,\n        appState: {\n          ...appState,\n          errorMessage: \"Support for adding images to the library coming soon!\",\n        },\n      };\n    }\n\n    return app.library\n      .getLatestLibrary()\n      .then((items) => {\n        return app.library.setLibrary([\n          {\n            id: randomId(),\n            status: \"unpublished\",\n            elements: selectedElements.map(deepCopyElement),\n            created: Date.now(),\n          },\n          ...items,\n        ]);\n      })\n      .then(() => {\n        return {\n          commitToHistory: false,\n          appState: {\n            ...appState,\n            toast: { message: t(\"toast.addedToLibrary\") },\n          },\n        };\n      })\n      .catch((error) => {\n        return {\n          commitToHistory: false,\n          appState: {\n            ...appState,\n            errorMessage: error.message,\n          },\n        };\n      });\n  },\n  contextItemLabel: \"labels.addToLibrary\",\n});\n"],"mappings":"mOAAA,OAASA,QAAQ,KAAQ,YAAY,CACrC,OAASC,eAAe,KAAQ,uBAAuB,CACvD,OAASC,QAAQ,KAAQ,WAAW,CACpC,OAASC,CAAC,KAAQ,SAAS,CAE3B,MAAO,IAAM,CAAAC,kBAAkB,CAAGJ,QAAQ,CAAC,CACzCK,IAAI,CAAE,cAAc,CACpBC,UAAU,CAAE,CAAEC,QAAQ,CAAE,SAAU,CAAC,CACnCC,OAAO,CAAE,SAAAA,QAACC,QAAQ,CAAEC,QAAQ,CAAEC,CAAC,CAAEC,GAAG,CAAK,CACvC,GAAM,CAAAC,gBAAgB,CAAGD,GAAG,CAACE,KAAK,CAACC,mBAAmB,CAAC,CACrDC,kBAAkB,CAAEN,QAAQ,CAACM,kBAAkB,CAC/CC,uBAAuB,CAAE,IAAI,CAC7BC,uBAAuB,CAAE,IAC3B,CAAC,CAAC,CACF,GAAIL,gBAAgB,CAACM,IAAI,CAAC,SAACC,OAAO,QAAK,CAAAA,OAAO,CAACC,IAAI,GAAK,OAAO,GAAC,CAAE,CAChE,MAAO,CACLC,eAAe,CAAE,KAAK,CACtBZ,QAAQ,CAAAa,aAAA,CAAAA,aAAA,IACHb,QAAQ,MACXc,YAAY,CAAE,uDAAuD,EAEzE,CAAC,CACH,CAEA,MAAO,CAAAZ,GAAG,CAACa,OAAO,CACfC,gBAAgB,EAAE,CAClBC,IAAI,CAAC,SAACC,KAAK,CAAK,CACf,MAAO,CAAAhB,GAAG,CAACa,OAAO,CAACI,UAAU,EAC3B,CACEC,EAAE,CAAE5B,QAAQ,EAAE,CACd6B,MAAM,CAAE,aAAa,CACrBtB,QAAQ,CAAEI,gBAAgB,CAACmB,GAAG,CAAC/B,eAAe,CAAC,CAC/CgC,OAAO,CAAEC,IAAI,CAACC,GAAG,EACnB,CAAC,EAAAC,MAAA,CAAAC,kBAAA,CACET,KAAK,GACR,CACJ,CAAC,CAAC,CACDD,IAAI,CAAC,UAAM,CACV,MAAO,CACLL,eAAe,CAAE,KAAK,CACtBZ,QAAQ,CAAAa,aAAA,CAAAA,aAAA,IACHb,QAAQ,MACX4B,KAAK,CAAE,CAAEC,OAAO,CAAEpC,CAAC,CAAC,sBAAsB,CAAE,CAAC,EAEjD,CAAC,CACH,CAAC,CAAC,CACDqC,KAAK,CAAC,SAACC,KAAK,CAAK,CAChB,MAAO,CACLnB,eAAe,CAAE,KAAK,CACtBZ,QAAQ,CAAAa,aAAA,CAAAA,aAAA,IACHb,QAAQ,MACXc,YAAY,CAAEiB,KAAK,CAACF,OAAO,EAE/B,CAAC,CACH,CAAC,CAAC,CACN,CAAC,CACDG,gBAAgB,CAAE,qBACpB,CAAC,CAAC"},"metadata":{},"sourceType":"module","externalDependencies":[]}