{"ast":null,"code":"import { __read, __spread } from \"tslib\";\nimport { addGlobalEventProcessor, getCurrentHub } from '@sentry/hub';\nimport { logger } from '@sentry/utils';\nexport var installedIntegrations = [];\n/** Gets integration to install */\nexport function getIntegrationsToSetup(options) {\n  var defaultIntegrations = options.defaultIntegrations && __spread(options.defaultIntegrations) || [];\n  var userIntegrations = options.integrations;\n  var integrations = [];\n  if (Array.isArray(userIntegrations)) {\n    var userIntegrationsNames_1 = userIntegrations.map(function (i) {\n      return i.name;\n    });\n    var pickedIntegrationsNames_1 = [];\n    // Leave only unique default integrations, that were not overridden with provided user integrations\n    defaultIntegrations.forEach(function (defaultIntegration) {\n      if (userIntegrationsNames_1.indexOf(defaultIntegration.name) === -1 && pickedIntegrationsNames_1.indexOf(defaultIntegration.name) === -1) {\n        integrations.push(defaultIntegration);\n        pickedIntegrationsNames_1.push(defaultIntegration.name);\n      }\n    });\n    // Don't add same user integration twice\n    userIntegrations.forEach(function (userIntegration) {\n      if (pickedIntegrationsNames_1.indexOf(userIntegration.name) === -1) {\n        integrations.push(userIntegration);\n        pickedIntegrationsNames_1.push(userIntegration.name);\n      }\n    });\n  } else if (typeof userIntegrations === 'function') {\n    integrations = userIntegrations(defaultIntegrations);\n    integrations = Array.isArray(integrations) ? integrations : [integrations];\n  } else {\n    integrations = __spread(defaultIntegrations);\n  }\n  // Make sure that if present, `Debug` integration will always run last\n  var integrationsNames = integrations.map(function (i) {\n    return i.name;\n  });\n  var alwaysLastToRun = 'Debug';\n  if (integrationsNames.indexOf(alwaysLastToRun) !== -1) {\n    integrations.push.apply(integrations, __spread(integrations.splice(integrationsNames.indexOf(alwaysLastToRun), 1)));\n  }\n  return integrations;\n}\n/** Setup given integration */\nexport function setupIntegration(integration) {\n  if (installedIntegrations.indexOf(integration.name) !== -1) {\n    return;\n  }\n  integration.setupOnce(addGlobalEventProcessor, getCurrentHub);\n  installedIntegrations.push(integration.name);\n  logger.log(\"Integration installed: \" + integration.name);\n}\n/**\n * Given a list of integration instances this installs them all. When `withDefaults` is set to `true` then all default\n * integrations are added unless they were already provided before.\n * @param integrations array of integration instances\n * @param withDefault should enable default integrations\n */\nexport function setupIntegrations(options) {\n  var integrations = {};\n  getIntegrationsToSetup(options).forEach(function (integration) {\n    integrations[integration.name] = integration;\n    setupIntegration(integration);\n  });\n  return integrations;\n}","map":{"version":3,"names":["addGlobalEventProcessor","getCurrentHub","logger","installedIntegrations","getIntegrationsToSetup","options","defaultIntegrations","__spread","userIntegrations","integrations","Array","isArray","userIntegrationsNames_1","map","i","name","pickedIntegrationsNames_1","forEach","defaultIntegration","indexOf","push","userIntegration","integrationsNames","alwaysLastToRun","apply","splice","setupIntegration","integration","setupOnce","log","setupIntegrations"],"sources":["D:\\project\\excalidraw-cn\\node_modules\\@sentry\\core\\src\\integration.ts"],"sourcesContent":["import { addGlobalEventProcessor, getCurrentHub } from '@sentry/hub';\nimport { Integration, Options } from '@sentry/types';\nimport { logger } from '@sentry/utils';\n\nexport const installedIntegrations: string[] = [];\n\n/** Map of integrations assigned to a client */\nexport interface IntegrationIndex {\n  [key: string]: Integration;\n}\n\n/** Gets integration to install */\nexport function getIntegrationsToSetup(options: Options): Integration[] {\n  const defaultIntegrations = (options.defaultIntegrations && [...options.defaultIntegrations]) || [];\n  const userIntegrations = options.integrations;\n  let integrations: Integration[] = [];\n  if (Array.isArray(userIntegrations)) {\n    const userIntegrationsNames = userIntegrations.map(i => i.name);\n    const pickedIntegrationsNames: string[] = [];\n\n    // Leave only unique default integrations, that were not overridden with provided user integrations\n    defaultIntegrations.forEach(defaultIntegration => {\n      if (\n        userIntegrationsNames.indexOf(defaultIntegration.name) === -1 &&\n        pickedIntegrationsNames.indexOf(defaultIntegration.name) === -1\n      ) {\n        integrations.push(defaultIntegration);\n        pickedIntegrationsNames.push(defaultIntegration.name);\n      }\n    });\n\n    // Don't add same user integration twice\n    userIntegrations.forEach(userIntegration => {\n      if (pickedIntegrationsNames.indexOf(userIntegration.name) === -1) {\n        integrations.push(userIntegration);\n        pickedIntegrationsNames.push(userIntegration.name);\n      }\n    });\n  } else if (typeof userIntegrations === 'function') {\n    integrations = userIntegrations(defaultIntegrations);\n    integrations = Array.isArray(integrations) ? integrations : [integrations];\n  } else {\n    integrations = [...defaultIntegrations];\n  }\n\n  // Make sure that if present, `Debug` integration will always run last\n  const integrationsNames = integrations.map(i => i.name);\n  const alwaysLastToRun = 'Debug';\n  if (integrationsNames.indexOf(alwaysLastToRun) !== -1) {\n    integrations.push(...integrations.splice(integrationsNames.indexOf(alwaysLastToRun), 1));\n  }\n\n  return integrations;\n}\n\n/** Setup given integration */\nexport function setupIntegration(integration: Integration): void {\n  if (installedIntegrations.indexOf(integration.name) !== -1) {\n    return;\n  }\n  integration.setupOnce(addGlobalEventProcessor, getCurrentHub);\n  installedIntegrations.push(integration.name);\n  logger.log(`Integration installed: ${integration.name}`);\n}\n\n/**\n * Given a list of integration instances this installs them all. When `withDefaults` is set to `true` then all default\n * integrations are added unless they were already provided before.\n * @param integrations array of integration instances\n * @param withDefault should enable default integrations\n */\nexport function setupIntegrations<O extends Options>(options: O): IntegrationIndex {\n  const integrations: IntegrationIndex = {};\n  getIntegrationsToSetup(options).forEach(integration => {\n    integrations[integration.name] = integration;\n    setupIntegration(integration);\n  });\n  return integrations;\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}