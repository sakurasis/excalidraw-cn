{"ast":null,"code":"import { useState, useRef, useLayoutEffect } from \"react\";\nimport { useDevice, useExcalidrawContainer } from \"../components/App\";\nimport { useUIAppState } from \"../context/ui-appState\";\nexport const useCreatePortalContainer = opts => {\n  const [div, setDiv] = useState(null);\n  const device = useDevice();\n  const {\n    theme\n  } = useUIAppState();\n  const isMobileRef = useRef(device.isMobile);\n  isMobileRef.current = device.isMobile;\n  const {\n    container: excalidrawContainer\n  } = useExcalidrawContainer();\n  useLayoutEffect(() => {\n    if (div) {\n      div.classList.toggle(\"excalidraw--mobile\", device.isMobile);\n    }\n  }, [div, device.isMobile]);\n  useLayoutEffect(() => {\n    var _opts$className;\n    const container = opts !== null && opts !== void 0 && opts.parentSelector ? excalidrawContainer === null || excalidrawContainer === void 0 ? void 0 : excalidrawContainer.querySelector(opts.parentSelector) : document.body;\n    if (!container) {\n      return;\n    }\n    const div = document.createElement(\"div\");\n    div.classList.add(\"excalidraw\", ...((opts === null || opts === void 0 ? void 0 : (_opts$className = opts.className) === null || _opts$className === void 0 ? void 0 : _opts$className.split(/\\s+/)) || []));\n    div.classList.toggle(\"excalidraw--mobile\", isMobileRef.current);\n    div.classList.toggle(\"theme--dark\", theme === \"dark\");\n    container.appendChild(div);\n    setDiv(div);\n    return () => {\n      container.removeChild(div);\n    };\n  }, [excalidrawContainer, theme, opts === null || opts === void 0 ? void 0 : opts.className, opts === null || opts === void 0 ? void 0 : opts.parentSelector]);\n  return div;\n};","map":{"version":3,"names":["useState","useRef","useLayoutEffect","useDevice","useExcalidrawContainer","useUIAppState","useCreatePortalContainer","opts","div","setDiv","device","theme","isMobileRef","isMobile","current","container","excalidrawContainer","classList","toggle","_opts$className","parentSelector","querySelector","document","body","createElement","add","className","split","appendChild","removeChild"],"sources":["D:/project/excalidraw-cn/src/hooks/useCreatePortalContainer.ts"],"sourcesContent":["import { useState, useRef, useLayoutEffect } from \"react\";\nimport { useDevice, useExcalidrawContainer } from \"../components/App\";\nimport { useUIAppState } from \"../context/ui-appState\";\n\nexport const useCreatePortalContainer = (opts?: {\n  className?: string;\n  parentSelector?: string;\n}) => {\n  const [div, setDiv] = useState<HTMLDivElement | null>(null);\n\n  const device = useDevice();\n  const { theme } = useUIAppState();\n  const isMobileRef = useRef(device.isMobile);\n  isMobileRef.current = device.isMobile;\n\n  const { container: excalidrawContainer } = useExcalidrawContainer();\n\n  useLayoutEffect(() => {\n    if (div) {\n      div.classList.toggle(\"excalidraw--mobile\", device.isMobile);\n    }\n  }, [div, device.isMobile]);\n\n  useLayoutEffect(() => {\n    const container = opts?.parentSelector\n      ? excalidrawContainer?.querySelector(opts.parentSelector)\n      : document.body;\n\n    if (!container) {\n      return;\n    }\n\n    const div = document.createElement(\"div\");\n\n    div.classList.add(\"excalidraw\", ...(opts?.className?.split(/\\s+/) || []));\n    div.classList.toggle(\"excalidraw--mobile\", isMobileRef.current);\n    div.classList.toggle(\"theme--dark\", theme === \"dark\");\n\n    container.appendChild(div);\n\n    setDiv(div);\n\n    return () => {\n      container.removeChild(div);\n    };\n  }, [excalidrawContainer, theme, opts?.className, opts?.parentSelector]);\n\n  return div;\n};\n"],"mappings":"AAAA,SAASA,QAAQ,EAAEC,MAAM,EAAEC,eAAe,QAAQ,OAAO;AACzD,SAASC,SAAS,EAAEC,sBAAsB,QAAQ,mBAAmB;AACrE,SAASC,aAAa,QAAQ,wBAAwB;AAEtD,OAAO,MAAMC,wBAAwB,GAAIC,IAGxC,IAAK;EACJ,MAAM,CAACC,GAAG,EAAEC,MAAM,CAAC,GAAGT,QAAQ,CAAwB,IAAI,CAAC;EAE3D,MAAMU,MAAM,GAAGP,SAAS,EAAE;EAC1B,MAAM;IAAEQ;EAAM,CAAC,GAAGN,aAAa,EAAE;EACjC,MAAMO,WAAW,GAAGX,MAAM,CAACS,MAAM,CAACG,QAAQ,CAAC;EAC3CD,WAAW,CAACE,OAAO,GAAGJ,MAAM,CAACG,QAAQ;EAErC,MAAM;IAAEE,SAAS,EAAEC;EAAoB,CAAC,GAAGZ,sBAAsB,EAAE;EAEnEF,eAAe,CAAC,MAAM;IACpB,IAAIM,GAAG,EAAE;MACPA,GAAG,CAACS,SAAS,CAACC,MAAM,CAAC,oBAAoB,EAAER,MAAM,CAACG,QAAQ,CAAC;IAC7D;EACF,CAAC,EAAE,CAACL,GAAG,EAAEE,MAAM,CAACG,QAAQ,CAAC,CAAC;EAE1BX,eAAe,CAAC,MAAM;IAAA,IAAAiB,eAAA;IACpB,MAAMJ,SAAS,GAAGR,IAAI,aAAJA,IAAI,eAAJA,IAAI,CAAEa,cAAc,GAClCJ,mBAAmB,aAAnBA,mBAAmB,uBAAnBA,mBAAmB,CAAEK,aAAa,CAACd,IAAI,CAACa,cAAc,CAAC,GACvDE,QAAQ,CAACC,IAAI;IAEjB,IAAI,CAACR,SAAS,EAAE;MACd;IACF;IAEA,MAAMP,GAAG,GAAGc,QAAQ,CAACE,aAAa,CAAC,KAAK,CAAC;IAEzChB,GAAG,CAACS,SAAS,CAACQ,GAAG,CAAC,YAAY,EAAE,IAAI,CAAAlB,IAAI,aAAJA,IAAI,wBAAAY,eAAA,GAAJZ,IAAI,CAAEmB,SAAS,cAAAP,eAAA,uBAAfA,eAAA,CAAiBQ,KAAK,CAAC,KAAK,CAAC,KAAI,EAAE,CAAC,CAAC;IACzEnB,GAAG,CAACS,SAAS,CAACC,MAAM,CAAC,oBAAoB,EAAEN,WAAW,CAACE,OAAO,CAAC;IAC/DN,GAAG,CAACS,SAAS,CAACC,MAAM,CAAC,aAAa,EAAEP,KAAK,KAAK,MAAM,CAAC;IAErDI,SAAS,CAACa,WAAW,CAACpB,GAAG,CAAC;IAE1BC,MAAM,CAACD,GAAG,CAAC;IAEX,OAAO,MAAM;MACXO,SAAS,CAACc,WAAW,CAACrB,GAAG,CAAC;IAC5B,CAAC;EACH,CAAC,EAAE,CAACQ,mBAAmB,EAAEL,KAAK,EAAEJ,IAAI,aAAJA,IAAI,uBAAJA,IAAI,CAAEmB,SAAS,EAAEnB,IAAI,aAAJA,IAAI,uBAAJA,IAAI,CAAEa,cAAc,CAAC,CAAC;EAEvE,OAAOZ,GAAG;AACZ,CAAC"},"metadata":{},"sourceType":"module","externalDependencies":[]}