{"ast":null,"code":"import React from\"react\";import{t}from\"../i18n\";import{Dialog}from\"./Dialog\";import{exportToFileIcon,LinkIcon}from\"./icons\";import{ToolButton}from\"./ToolButton\";import{actionSaveFileToDisk}from\"../actions/actionExport\";import{Card}from\"./Card\";import\"./ExportDialog.scss\";import{nativeFileSystemSupported}from\"../data/filesystem\";import{trackEvent}from\"../analytics\";import{getFrame}from\"../utils\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";var JSONExportModal=function JSONExportModal(_ref){var elements=_ref.elements,appState=_ref.appState,files=_ref.files,actionManager=_ref.actionManager,exportOpts=_ref.exportOpts,canvas=_ref.canvas;var onExportToBackend=exportOpts.onExportToBackend;return/*#__PURE__*/_jsx(\"div\",{className:\"ExportDialog ExportDialog--json\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"ExportDialog-cards\",children:[exportOpts.saveFileToDisk&&/*#__PURE__*/_jsxs(Card,{color:\"lime\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"Card-icon\",children:exportToFileIcon}),/*#__PURE__*/_jsx(\"h2\",{children:t(\"exportDialog.disk_title\")}),/*#__PURE__*/_jsxs(\"div\",{className:\"Card-details\",children:[t(\"exportDialog.disk_details\"),!nativeFileSystemSupported&&actionManager.renderAction(\"changeProjectName\")]}),/*#__PURE__*/_jsx(ToolButton,{className:\"Card-button\",type:\"button\",title:t(\"exportDialog.disk_button\"),\"aria-label\":t(\"exportDialog.disk_button\"),showAriaLabel:true,onClick:function onClick(){actionManager.executeAction(actionSaveFileToDisk,\"ui\");}})]}),onExportToBackend&&/*#__PURE__*/_jsxs(Card,{color:\"pink\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"Card-icon\",children:LinkIcon}),/*#__PURE__*/_jsx(\"h2\",{children:t(\"exportDialog.link_title\")}),/*#__PURE__*/_jsx(\"div\",{className:\"Card-details\",children:t(\"exportDialog.link_details\")}),/*#__PURE__*/_jsx(ToolButton,{className:\"Card-button\",type:\"button\",title:t(\"exportDialog.link_button\"),\"aria-label\":t(\"exportDialog.link_button\"),showAriaLabel:true,onClick:function onClick(){onExportToBackend(elements,appState,files,canvas);trackEvent(\"export\",\"link\",\"ui (\".concat(getFrame(),\")\"));}})]}),exportOpts.renderCustomUI&&exportOpts.renderCustomUI(elements,appState,files,canvas)]})});};export var JSONExportDialog=function JSONExportDialog(_ref2){var elements=_ref2.elements,appState=_ref2.appState,files=_ref2.files,actionManager=_ref2.actionManager,exportOpts=_ref2.exportOpts,canvas=_ref2.canvas,setAppState=_ref2.setAppState;var handleClose=React.useCallback(function(){setAppState({openDialog:null});},[setAppState]);return/*#__PURE__*/_jsx(_Fragment,{children:appState.openDialog===\"jsonExport\"&&/*#__PURE__*/_jsx(Dialog,{onCloseRequest:handleClose,title:t(\"buttons.export\"),children:/*#__PURE__*/_jsx(JSONExportModal,{elements:elements,appState:appState,files:files,actionManager:actionManager,onCloseRequest:handleClose,exportOpts:exportOpts,canvas:canvas})})});};","map":{"version":3,"names":["React","t","Dialog","exportToFileIcon","LinkIcon","ToolButton","actionSaveFileToDisk","Card","nativeFileSystemSupported","trackEvent","getFrame","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","JSONExportModal","_ref","elements","appState","files","actionManager","exportOpts","canvas","onExportToBackend","className","children","saveFileToDisk","color","renderAction","type","title","showAriaLabel","onClick","executeAction","concat","renderCustomUI","JSONExportDialog","_ref2","setAppState","handleClose","useCallback","openDialog","onCloseRequest"],"sources":["D:/project/excalidraw-cn/src/components/JSONExportDialog.tsx"],"sourcesContent":["import React from \"react\";\nimport { NonDeletedExcalidrawElement } from \"../element/types\";\nimport { t } from \"../i18n\";\n\nimport { ExportOpts, BinaryFiles, UIAppState } from \"../types\";\nimport { Dialog } from \"./Dialog\";\nimport { exportToFileIcon, LinkIcon } from \"./icons\";\nimport { ToolButton } from \"./ToolButton\";\nimport { actionSaveFileToDisk } from \"../actions/actionExport\";\nimport { Card } from \"./Card\";\n\nimport \"./ExportDialog.scss\";\nimport { nativeFileSystemSupported } from \"../data/filesystem\";\nimport { trackEvent } from \"../analytics\";\nimport { ActionManager } from \"../actions/manager\";\nimport { getFrame } from \"../utils\";\n\nexport type ExportCB = (\n  elements: readonly NonDeletedExcalidrawElement[],\n  scale?: number,\n) => void;\n\nconst JSONExportModal = ({\n  elements,\n  appState,\n  files,\n  actionManager,\n  exportOpts,\n  canvas,\n}: {\n  appState: UIAppState;\n  files: BinaryFiles;\n  elements: readonly NonDeletedExcalidrawElement[];\n  actionManager: ActionManager;\n  onCloseRequest: () => void;\n  exportOpts: ExportOpts;\n  canvas: HTMLCanvasElement | null;\n}) => {\n  const { onExportToBackend } = exportOpts;\n  return (\n    <div className=\"ExportDialog ExportDialog--json\">\n      <div className=\"ExportDialog-cards\">\n        {exportOpts.saveFileToDisk && (\n          <Card color=\"lime\">\n            <div className=\"Card-icon\">{exportToFileIcon}</div>\n            <h2>{t(\"exportDialog.disk_title\")}</h2>\n            <div className=\"Card-details\">\n              {t(\"exportDialog.disk_details\")}\n              {!nativeFileSystemSupported &&\n                actionManager.renderAction(\"changeProjectName\")}\n            </div>\n            <ToolButton\n              className=\"Card-button\"\n              type=\"button\"\n              title={t(\"exportDialog.disk_button\")}\n              aria-label={t(\"exportDialog.disk_button\")}\n              showAriaLabel={true}\n              onClick={() => {\n                actionManager.executeAction(actionSaveFileToDisk, \"ui\");\n              }}\n            />\n          </Card>\n        )}\n        {onExportToBackend && (\n          <Card color=\"pink\">\n            <div className=\"Card-icon\">{LinkIcon}</div>\n            <h2>{t(\"exportDialog.link_title\")}</h2>\n            <div className=\"Card-details\">{t(\"exportDialog.link_details\")}</div>\n            <ToolButton\n              className=\"Card-button\"\n              type=\"button\"\n              title={t(\"exportDialog.link_button\")}\n              aria-label={t(\"exportDialog.link_button\")}\n              showAriaLabel={true}\n              onClick={() => {\n                onExportToBackend(elements, appState, files, canvas);\n                trackEvent(\"export\", \"link\", `ui (${getFrame()})`);\n              }}\n            />\n          </Card>\n        )}\n        {exportOpts.renderCustomUI &&\n          exportOpts.renderCustomUI(elements, appState, files, canvas)}\n      </div>\n    </div>\n  );\n};\n\nexport const JSONExportDialog = ({\n  elements,\n  appState,\n  files,\n  actionManager,\n  exportOpts,\n  canvas,\n  setAppState,\n}: {\n  elements: readonly NonDeletedExcalidrawElement[];\n  appState: UIAppState;\n  files: BinaryFiles;\n  actionManager: ActionManager;\n  exportOpts: ExportOpts;\n  canvas: HTMLCanvasElement | null;\n  setAppState: React.Component<any, UIAppState>[\"setState\"];\n}) => {\n  const handleClose = React.useCallback(() => {\n    setAppState({ openDialog: null });\n  }, [setAppState]);\n\n  return (\n    <>\n      {appState.openDialog === \"jsonExport\" && (\n        <Dialog onCloseRequest={handleClose} title={t(\"buttons.export\")}>\n          <JSONExportModal\n            elements={elements}\n            appState={appState}\n            files={files}\n            actionManager={actionManager}\n            onCloseRequest={handleClose}\n            exportOpts={exportOpts}\n            canvas={canvas}\n          />\n        </Dialog>\n      )}\n    </>\n  );\n};\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}