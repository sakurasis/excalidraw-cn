{"ast":null,"code":"import _objectSpread from\"D:/project/excalidraw-cn/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import _toConsumableArray from\"D:/project/excalidraw-cn/node_modules/@babel/runtime/helpers/esm/toConsumableArray.js\";import _slicedToArray from\"D:/project/excalidraw-cn/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import oc from\"open-color\";import{COLOR_PALETTE}from\"./colors\";import{CURSOR_TYPE,DEFAULT_VERSION,FONT_FAMILY,isDarwin,MIME_TYPES,THEME,WINDOWS_EMOJI_FALLBACK_FONT}from\"./constants\";import{unstable_batchedUpdates}from\"react-dom\";import{isEraserActive,isHandToolActive}from\"./appState\";var mockDateTime=null;export var setDateTimeForTests=function setDateTimeForTests(dateTime){mockDateTime=dateTime;};export var getDateTime=function getDateTime(){if(mockDateTime){return mockDateTime;}var date=new Date();var year=date.getFullYear();var month=\"\".concat(date.getMonth()+1).padStart(2,\"0\");var day=\"\".concat(date.getDate()).padStart(2,\"0\");var hr=\"\".concat(date.getHours()).padStart(2,\"0\");var min=\"\".concat(date.getMinutes()).padStart(2,\"0\");return\"\".concat(year,\"-\").concat(month,\"-\").concat(day,\"-\").concat(hr).concat(min);};export var capitalizeString=function capitalizeString(str){return str.charAt(0).toUpperCase()+str.slice(1);};export var isToolIcon=function isToolIcon(target){return target instanceof HTMLElement&&target.className.includes(\"ToolIcon\");};export var isInputLike=function isInputLike(target){return target instanceof HTMLElement&&target.dataset.type===\"wysiwyg\"||target instanceof HTMLBRElement||// newline in wysiwyg\ntarget instanceof HTMLInputElement||target instanceof HTMLTextAreaElement||target instanceof HTMLSelectElement;};export var isInteractive=function isInteractive(target){return isInputLike(target)||target instanceof Element&&!!target.closest(\"label, button\");};export var isWritableElement=function isWritableElement(target){return target instanceof HTMLElement&&target.dataset.type===\"wysiwyg\"||target instanceof HTMLBRElement||// newline in wysiwyg\ntarget instanceof HTMLTextAreaElement||target instanceof HTMLInputElement&&(target.type===\"text\"||target.type===\"number\");};export var getFontFamilyString=function getFontFamilyString(_ref){var fontFamily=_ref.fontFamily;for(var _i=0,_Object$entries=Object.entries(FONT_FAMILY);_i<_Object$entries.length;_i++){var _Object$entries$_i=_slicedToArray(_Object$entries[_i],2),fontFamilyString=_Object$entries$_i[0],id=_Object$entries$_i[1];if(id===fontFamily){return\"\".concat(fontFamilyString,\", \").concat(WINDOWS_EMOJI_FALLBACK_FONT);}}return WINDOWS_EMOJI_FALLBACK_FONT;};/** returns fontSize+fontFamily string for assignment to DOM elements */export var getFontString=function getFontString(_ref2){var fontSize=_ref2.fontSize,fontFamily=_ref2.fontFamily;return\"\".concat(fontSize,\"px \").concat(getFontFamilyString({fontFamily:fontFamily}));};export var debounce=function debounce(fn,timeout){var handle=0;var lastArgs=null;var ret=function ret(){for(var _len=arguments.length,args=new Array(_len),_key2=0;_key2<_len;_key2++){args[_key2]=arguments[_key2];}lastArgs=args;clearTimeout(handle);handle=window.setTimeout(function(){lastArgs=null;fn.apply(void 0,args);},timeout);};ret.flush=function(){clearTimeout(handle);if(lastArgs){var _lastArgs=lastArgs;lastArgs=null;fn.apply(void 0,_toConsumableArray(_lastArgs));}};ret.cancel=function(){lastArgs=null;clearTimeout(handle);};return ret;};// throttle callback to execute once per animation frame\nexport var throttleRAF=function throttleRAF(fn,opts){var timerId=null;var lastArgs=null;var lastArgsTrailing=null;var scheduleFunc=function scheduleFunc(args){timerId=window.requestAnimationFrame(function(){timerId=null;fn.apply(void 0,_toConsumableArray(args));lastArgs=null;if(lastArgsTrailing){lastArgs=lastArgsTrailing;lastArgsTrailing=null;scheduleFunc(lastArgs);}});};var ret=function ret(){for(var _len2=arguments.length,args=new Array(_len2),_key3=0;_key3<_len2;_key3++){args[_key3]=arguments[_key3];}if(process.env.NODE_ENV===\"test\"){fn.apply(void 0,args);return;}lastArgs=args;if(timerId===null){scheduleFunc(lastArgs);}else if(opts!==null&&opts!==void 0&&opts.trailing){lastArgsTrailing=args;}};ret.flush=function(){if(timerId!==null){cancelAnimationFrame(timerId);timerId=null;}if(lastArgs){fn.apply(void 0,_toConsumableArray(lastArgsTrailing||lastArgs));lastArgs=lastArgsTrailing=null;}};ret.cancel=function(){lastArgs=lastArgsTrailing=null;if(timerId!==null){cancelAnimationFrame(timerId);timerId=null;}};return ret;};/**\n * Exponential ease-out method\n *\n * @param {number} k - The value to be tweened.\n * @returns {number} The tweened value.\n */export var easeOut=function easeOut(k){return 1-Math.pow(1-k,4);};var easeOutInterpolate=function easeOutInterpolate(from,to,progress){return(to-from)*easeOut(progress)+from;};/**\n * Animates values from `fromValues` to `toValues` using the requestAnimationFrame API.\n * Executes the `onStep` callback on each step with the interpolated values.\n * Returns a function that can be called to cancel the animation.\n *\n * @example\n * // Example usage:\n * const fromValues = { x: 0, y: 0 };\n * const toValues = { x: 100, y: 200 };\n * const onStep = ({x, y}) => {\n *   setState(x, y)\n * };\n * const onCancel = () => {\n *   console.log(\"Animation canceled\");\n * };\n *\n * const cancelAnimation = easeToValuesRAF({\n *   fromValues,\n *   toValues,\n *   onStep,\n *   onCancel,\n * });\n *\n * // To cancel the animation:\n * cancelAnimation();\n */export var easeToValuesRAF=function easeToValuesRAF(_ref3){var fromValues=_ref3.fromValues,toValues=_ref3.toValues,onStep=_ref3.onStep,_ref3$duration=_ref3.duration,duration=_ref3$duration===void 0?250:_ref3$duration,interpolateValue=_ref3.interpolateValue,onStart=_ref3.onStart,onEnd=_ref3.onEnd,onCancel=_ref3.onCancel;var canceled=false;var frameId=0;var startTime;function step(timestamp){if(canceled){return;}if(startTime===undefined){startTime=timestamp;onStart===null||onStart===void 0?void 0:onStart();}var elapsed=Math.min(timestamp-startTime,duration);var factor=easeOut(elapsed/duration);var newValues={};Object.keys(fromValues).forEach(function(key){var _key=key;var result=(toValues[_key]-fromValues[_key])*factor+fromValues[_key];newValues[_key]=result;});onStep(newValues);if(elapsed<duration){var _progress=elapsed/duration;var _newValues={};Object.keys(fromValues).forEach(function(key){var _key=key;var startValue=fromValues[_key];var endValue=toValues[_key];var result;result=interpolateValue?interpolateValue(startValue,endValue,_progress,_key):easeOutInterpolate(startValue,endValue,_progress);if(result==null){result=easeOutInterpolate(startValue,endValue,_progress);}_newValues[_key]=result;});onStep(_newValues);frameId=window.requestAnimationFrame(step);}else{onStep(toValues);onEnd===null||onEnd===void 0?void 0:onEnd();}}frameId=window.requestAnimationFrame(step);return function(){onCancel===null||onCancel===void 0?void 0:onCancel();canceled=true;window.cancelAnimationFrame(frameId);};};// https://github.com/lodash/lodash/blob/es/chunk.js\nexport var chunk=function chunk(array,size){if(!array.length||size<1){return[];}var index=0;var resIndex=0;var result=Array(Math.ceil(array.length/size));while(index<array.length){result[resIndex++]=array.slice(index,index+=size);}return result;};export var selectNode=function selectNode(node){var selection=window.getSelection();if(selection){var range=document.createRange();range.selectNodeContents(node);selection.removeAllRanges();selection.addRange(range);}};export var removeSelection=function removeSelection(){var selection=window.getSelection();if(selection){selection.removeAllRanges();}};export var distance=function distance(x,y){return Math.abs(x-y);};export var updateActiveTool=function updateActiveTool(appState,data){if(data.type===\"custom\"){return _objectSpread(_objectSpread({},appState.activeTool),{},{type:\"custom\",customType:data.customType});}return _objectSpread(_objectSpread({},appState.activeTool),{},{lastActiveTool:data.lastActiveToolBeforeEraser===undefined?appState.activeTool.lastActiveTool:data.lastActiveToolBeforeEraser,type:data.type,customType:null});};export var resetCursor=function resetCursor(canvas){if(canvas){canvas.style.cursor=\"\";}};export var setCursor=function setCursor(canvas,cursor){if(canvas){canvas.style.cursor=cursor;}};var eraserCanvasCache;var previewDataURL;export var setEraserCursor=function setEraserCursor(canvas,theme){var cursorImageSizePx=20;var drawCanvas=function drawCanvas(){var isDarkTheme=theme===THEME.DARK;eraserCanvasCache=document.createElement(\"canvas\");eraserCanvasCache.theme=theme;eraserCanvasCache.height=cursorImageSizePx;eraserCanvasCache.width=cursorImageSizePx;var context=eraserCanvasCache.getContext(\"2d\");context.lineWidth=1;context.beginPath();context.arc(eraserCanvasCache.width/2,eraserCanvasCache.height/2,5,0,2*Math.PI);context.fillStyle=isDarkTheme?oc.black:oc.white;context.fill();context.strokeStyle=isDarkTheme?oc.white:oc.black;context.stroke();previewDataURL=eraserCanvasCache.toDataURL(MIME_TYPES.svg);};if(!eraserCanvasCache||eraserCanvasCache.theme!==theme){drawCanvas();}setCursor(canvas,\"url(\".concat(previewDataURL,\") \").concat(cursorImageSizePx/2,\" \").concat(cursorImageSizePx/2,\", auto\"));};export var setCursorForShape=function setCursorForShape(canvas,appState){if(!canvas){return;}if(appState.activeTool.type===\"selection\"){resetCursor(canvas);}else if(isHandToolActive(appState)){canvas.style.cursor=CURSOR_TYPE.GRAB;}else if(isEraserActive(appState)){setEraserCursor(canvas,appState.theme);// do nothing if image tool is selected which suggests there's\n// a image-preview set as the cursor\n// Ignore custom type as well and let host decide\n}else if(![\"image\",\"custom\"].includes(appState.activeTool.type)){canvas.style.cursor=CURSOR_TYPE.CROSSHAIR;}};export var isFullScreen=function isFullScreen(){var _document$fullscreenE;return((_document$fullscreenE=document.fullscreenElement)===null||_document$fullscreenE===void 0?void 0:_document$fullscreenE.nodeName)===\"HTML\";};export var allowFullScreen=function allowFullScreen(){return document.documentElement.requestFullscreen();};export var exitFullScreen=function exitFullScreen(){return document.exitFullscreen();};export var getShortcutKey=function getShortcutKey(shortcut){shortcut=shortcut.replace(/\\bAlt\\b/i,\"Alt\").replace(/\\bShift\\b/i,\"Shift\").replace(/\\b(Enter|Return)\\b/i,\"Enter\");if(isDarwin){return shortcut.replace(/\\bCtrlOrCmd\\b/gi,\"Cmd\").replace(/\\bAlt\\b/i,\"Option\");}return shortcut.replace(/\\bCtrlOrCmd\\b/gi,\"Ctrl\");};export var viewportCoordsToSceneCoords=function viewportCoordsToSceneCoords(_ref4,_ref5){var clientX=_ref4.clientX,clientY=_ref4.clientY;var zoom=_ref5.zoom,offsetLeft=_ref5.offsetLeft,offsetTop=_ref5.offsetTop,scrollX=_ref5.scrollX,scrollY=_ref5.scrollY;var x=(clientX-offsetLeft)/zoom.value-scrollX;var y=(clientY-offsetTop)/zoom.value-scrollY;return{x:x,y:y};};export var sceneCoordsToViewportCoords=function sceneCoordsToViewportCoords(_ref6,_ref7){var sceneX=_ref6.sceneX,sceneY=_ref6.sceneY;var zoom=_ref7.zoom,offsetLeft=_ref7.offsetLeft,offsetTop=_ref7.offsetTop,scrollX=_ref7.scrollX,scrollY=_ref7.scrollY;var x=(sceneX+scrollX)*zoom.value+offsetLeft;var y=(sceneY+scrollY)*zoom.value+offsetTop;return{x:x,y:y};};export var getGlobalCSSVariable=function getGlobalCSSVariable(name){return getComputedStyle(document.documentElement).getPropertyValue(\"--\".concat(name));};var RS_LTR_CHARS=\"A-Za-z\\xC0-\\xD6\\xD8-\\xF6\\xF8-\\u02B8\\u0300-\\u0590\\u0800-\\u1FFF\"+\"\\u2C00-\\uFB1C\\uFDFE-\\uFE6F\\uFEFD-\\uFFFF\";var RS_RTL_CHARS=\"\\u0591-\\u07FF\\uFB1D-\\uFDFD\\uFE70-\\uFEFC\";var RE_RTL_CHECK=new RegExp(\"^[^\".concat(RS_LTR_CHARS,\"]*[\").concat(RS_RTL_CHARS,\"]\"));/**\n * Checks whether first directional character is RTL. Meaning whether it starts\n *  with RTL characters, or indeterminate (numbers etc.) characters followed by\n *  RTL.\n * See https://github.com/excalidraw/excalidraw/pull/1722#discussion_r436340171\n */export var isRTL=function isRTL(text){return RE_RTL_CHECK.test(text);};export var tupleToCoors=function tupleToCoors(xyTuple){var _xyTuple=_slicedToArray(xyTuple,2),x=_xyTuple[0],y=_xyTuple[1];return{x:x,y:y};};/** use as a rejectionHandler to mute filesystem Abort errors */export var muteFSAbortError=function muteFSAbortError(error){if((error===null||error===void 0?void 0:error.name)===\"AbortError\"){console.warn(error);return;}throw error;};export var findIndex=function findIndex(array,cb){var fromIndex=arguments.length>2&&arguments[2]!==undefined?arguments[2]:0;if(fromIndex<0){fromIndex=array.length+fromIndex;}fromIndex=Math.min(array.length,Math.max(fromIndex,0));var index=fromIndex-1;while(++index<array.length){if(cb(array[index],index,array)){return index;}}return-1;};export var findLastIndex=function findLastIndex(array,cb){var fromIndex=arguments.length>2&&arguments[2]!==undefined?arguments[2]:array.length-1;if(fromIndex<0){fromIndex=array.length+fromIndex;}fromIndex=Math.min(array.length-1,Math.max(fromIndex,0));var index=fromIndex+1;while(--index>-1){if(cb(array[index],index,array)){return index;}}return-1;};export var isTransparent=function isTransparent(color){var isRGBTransparent=color.length===5&&color.substr(4,1)===\"0\";var isRRGGBBTransparent=color.length===9&&color.substr(7,2)===\"00\";return isRGBTransparent||isRRGGBBTransparent||color===COLOR_PALETTE.transparent;};export var resolvablePromise=function resolvablePromise(){var resolve;var reject;var promise=new Promise(function(_resolve,_reject){resolve=_resolve;reject=_reject;});promise.resolve=resolve;promise.reject=reject;return promise;};/**\n * @param func handler taking at most single parameter (event).\n */export var withBatchedUpdates=function withBatchedUpdates(func){return function(event){unstable_batchedUpdates(func,event);};};/**\n * barches React state updates and throttles the calls to a single call per\n * animation frame\n */export var withBatchedUpdatesThrottled=function withBatchedUpdatesThrottled(func){// @ts-ignore\nreturn throttleRAF(function(event){unstable_batchedUpdates(func,event);});};//https://stackoverflow.com/a/9462382/8418\nexport var nFormatter=function nFormatter(num,digits){var si=[{value:1,symbol:\"b\"},{value:1e3,symbol:\"k\"},{value:1e6,symbol:\"M\"},{value:1e9,symbol:\"G\"}];var rx=/\\.0+$|(\\.[0-9]*[1-9])0+$/;var index;for(index=si.length-1;index>0;index--){if(num>=si[index].value){break;}}return(num/si[index].value).toFixed(digits).replace(rx,\"$1\")+si[index].symbol;};export var getVersion=function getVersion(){var _document$querySelect;return((_document$querySelect=document.querySelector('meta[name=\"version\"]'))===null||_document$querySelect===void 0?void 0:_document$querySelect.content)||DEFAULT_VERSION;};// Adapted from https://github.com/Modernizr/Modernizr/blob/master/feature-detects/emoji.js\nexport var supportsEmoji=function supportsEmoji(){var canvas=document.createElement(\"canvas\");var ctx=canvas.getContext(\"2d\");if(!ctx){return false;}var offset=12;ctx.fillStyle=\"#f00\";ctx.textBaseline=\"top\";ctx.font=\"32px Arial\";// Modernizr used ðŸ¨, but it is sort of supported on Windows 7.\n// Luckily ðŸ˜€ isn't supported.\nctx.fillText(\"ðŸ˜€\",0,0);return ctx.getImageData(offset,offset,1,1).data[0]!==0;};export var getNearestScrollableContainer=function getNearestScrollableContainer(element){var parent=element.parentElement;while(parent){if(parent===document.body){return document;}var _window$getComputedSt=window.getComputedStyle(parent),overflowY=_window$getComputedSt.overflowY;var hasScrollableContent=parent.scrollHeight>parent.clientHeight;if(hasScrollableContent&&(overflowY===\"auto\"||overflowY===\"scroll\"||overflowY===\"overlay\")){return parent;}parent=parent.parentElement;}return document;};export var focusNearestParent=function focusNearestParent(element){var parent=element.parentElement;while(parent){if(parent.tabIndex>-1){parent.focus();return;}parent=parent.parentElement;}};export var preventUnload=function preventUnload(event){event.preventDefault();// NOTE: modern browsers no longer allow showing a custom message here\nevent.returnValue=\"\";};export var bytesToHexString=function bytesToHexString(bytes){return Array.from(bytes).map(function(byte){return\"0\".concat(byte.toString(16)).slice(-2);}).join(\"\");};export var getUpdatedTimestamp=function getUpdatedTimestamp(){return isTestEnv()?1:Date.now();};/**\n * Transforms array of objects containing `id` attribute,\n * or array of ids (strings), into a Map, keyd by `id`.\n */export var arrayToMap=function arrayToMap(items){return items.reduce(function(acc,element){acc.set(typeof element===\"string\"?element:element.id,element);return acc;},new Map());};export var arrayToMapWithIndex=function arrayToMapWithIndex(elements){return elements.reduce(function(acc,element,idx){acc.set(element.id,[element,idx]);return acc;},new Map());};export var isTestEnv=function isTestEnv(){return process.env.NODE_ENV===\"test\";};export var wrapEvent=function wrapEvent(name,nativeEvent){return new CustomEvent(name,{detail:{nativeEvent:nativeEvent},cancelable:true});};export var updateObject=function updateObject(obj,updates){var didChange=false;for(var _key4 in updates){var _value=updates[_key4];if(typeof _value!==\"undefined\"){if(obj[_key4]===_value&&(// if object, always update because its attrs could have changed\ntypeof _value!==\"object\"||_value===null)){continue;}didChange=true;}}if(!didChange){return obj;}return _objectSpread(_objectSpread({},obj),updates);};export var isPrimitive=function isPrimitive(val){var type=typeof val;return val==null||type!==\"object\"&&type!==\"function\";};export var getFrame=function getFrame(){try{return window.self===window.top?\"top\":\"iframe\";}catch(error){return\"iframe\";}};export var isRunningInIframe=function isRunningInIframe(){return getFrame()===\"iframe\";};export var isPromiseLike=function isPromiseLike(value){return!!value&&typeof value===\"object\"&&\"then\"in value&&\"catch\"in value&&\"finally\"in value;};export var queryFocusableElements=function queryFocusableElements(container){var focusableElements=container===null||container===void 0?void 0:container.querySelectorAll(\"button, a, input, select, textarea, div[tabindex], label[tabindex]\");return focusableElements?Array.from(focusableElements).filter(function(element){return element.tabIndex>-1&&!element.disabled;}):[];};export var isShallowEqual=function isShallowEqual(objA,objB,comparators){var debug=arguments.length>3&&arguments[3]!==undefined?arguments[3]:false;var aKeys=Object.keys(objA);var bKeys=Object.keys(objB);if(aKeys.length!==bKeys.length){return false;}return aKeys.every(function(key){var comparator=comparators===null||comparators===void 0?void 0:comparators[key];var ret=comparator?comparator(objA[key],objB[key]):objA[key]===objB[key];if(!ret&&debug){console.info(\"%cisShallowEqual: \".concat(key,\" not equal ->\"),\"color: #8B4000\",objA[key],objB[key]);}return ret;});};// taken from Radix UI\n// https://github.com/radix-ui/primitives/blob/main/packages/core/primitive/src/primitive.tsx\nexport var composeEventHandlers=function composeEventHandlers(originalEventHandler,ourEventHandler){var _ref8=arguments.length>2&&arguments[2]!==undefined?arguments[2]:{},_ref8$checkForDefault=_ref8.checkForDefaultPrevented,checkForDefaultPrevented=_ref8$checkForDefault===void 0?true:_ref8$checkForDefault;return function handleEvent(event){originalEventHandler===null||originalEventHandler===void 0?void 0:originalEventHandler(event);if(!checkForDefaultPrevented||!event.defaultPrevented){return ourEventHandler===null||ourEventHandler===void 0?void 0:ourEventHandler(event);}};};export var isOnlyExportingSingleFrame=function isOnlyExportingSingleFrame(elements){var frames=elements.filter(function(element){return element.type===\"frame\";});return frames.length===1&&elements.every(function(element){return element.type===\"frame\"||element.frameId===frames[0].id;});};","map":{"version":3,"names":["oc","COLOR_PALETTE","CURSOR_TYPE","DEFAULT_VERSION","FONT_FAMILY","isDarwin","MIME_TYPES","THEME","WINDOWS_EMOJI_FALLBACK_FONT","unstable_batchedUpdates","isEraserActive","isHandToolActive","mockDateTime","setDateTimeForTests","dateTime","getDateTime","date","Date","year","getFullYear","month","concat","getMonth","padStart","day","getDate","hr","getHours","min","getMinutes","capitalizeString","str","charAt","toUpperCase","slice","isToolIcon","target","HTMLElement","className","includes","isInputLike","dataset","type","HTMLBRElement","HTMLInputElement","HTMLTextAreaElement","HTMLSelectElement","isInteractive","Element","closest","isWritableElement","getFontFamilyString","_ref","fontFamily","_i","_Object$entries","Object","entries","length","_Object$entries$_i","_slicedToArray","fontFamilyString","id","getFontString","_ref2","fontSize","debounce","fn","timeout","handle","lastArgs","ret","_len","arguments","args","Array","_key2","clearTimeout","window","setTimeout","apply","flush","_lastArgs","_toConsumableArray","cancel","throttleRAF","opts","timerId","lastArgsTrailing","scheduleFunc","requestAnimationFrame","_len2","_key3","process","env","NODE_ENV","trailing","cancelAnimationFrame","easeOut","k","Math","pow","easeOutInterpolate","from","to","progress","easeToValuesRAF","_ref3","fromValues","toValues","onStep","_ref3$duration","duration","interpolateValue","onStart","onEnd","onCancel","canceled","frameId","startTime","step","timestamp","undefined","elapsed","factor","newValues","keys","forEach","key","_key","result","startValue","endValue","chunk","array","size","index","resIndex","ceil","selectNode","node","selection","getSelection","range","document","createRange","selectNodeContents","removeAllRanges","addRange","removeSelection","distance","x","y","abs","updateActiveTool","appState","data","_objectSpread","activeTool","customType","lastActiveTool","lastActiveToolBeforeEraser","resetCursor","canvas","style","cursor","setCursor","eraserCanvasCache","previewDataURL","setEraserCursor","theme","cursorImageSizePx","drawCanvas","isDarkTheme","DARK","createElement","height","width","context","getContext","lineWidth","beginPath","arc","PI","fillStyle","black","white","fill","strokeStyle","stroke","toDataURL","svg","setCursorForShape","GRAB","CROSSHAIR","isFullScreen","_document$fullscreenE","fullscreenElement","nodeName","allowFullScreen","documentElement","requestFullscreen","exitFullScreen","exitFullscreen","getShortcutKey","shortcut","replace","viewportCoordsToSceneCoords","_ref4","_ref5","clientX","clientY","zoom","offsetLeft","offsetTop","scrollX","scrollY","value","sceneCoordsToViewportCoords","_ref6","_ref7","sceneX","sceneY","getGlobalCSSVariable","name","getComputedStyle","getPropertyValue","RS_LTR_CHARS","RS_RTL_CHARS","RE_RTL_CHECK","RegExp","isRTL","text","test","tupleToCoors","xyTuple","_xyTuple","muteFSAbortError","error","console","warn","findIndex","cb","fromIndex","max","findLastIndex","isTransparent","color","isRGBTransparent","substr","isRRGGBBTransparent","transparent","resolvablePromise","resolve","reject","promise","Promise","_resolve","_reject","withBatchedUpdates","func","event","withBatchedUpdatesThrottled","nFormatter","num","digits","si","symbol","rx","toFixed","getVersion","_document$querySelect","querySelector","content","supportsEmoji","ctx","offset","textBaseline","font","fillText","getImageData","getNearestScrollableContainer","element","parent","parentElement","body","_window$getComputedSt","overflowY","hasScrollableContent","scrollHeight","clientHeight","focusNearestParent","tabIndex","focus","preventUnload","preventDefault","returnValue","bytesToHexString","bytes","map","byte","toString","join","getUpdatedTimestamp","isTestEnv","now","arrayToMap","items","reduce","acc","set","Map","arrayToMapWithIndex","elements","idx","wrapEvent","nativeEvent","CustomEvent","detail","cancelable","updateObject","obj","updates","didChange","isPrimitive","val","getFrame","self","top","isRunningInIframe","isPromiseLike","queryFocusableElements","container","focusableElements","querySelectorAll","filter","disabled","isShallowEqual","objA","objB","comparators","debug","aKeys","bKeys","every","comparator","info","composeEventHandlers","originalEventHandler","ourEventHandler","_ref8","_ref8$checkForDefault","checkForDefaultPrevented","handleEvent","defaultPrevented","isOnlyExportingSingleFrame","frames"],"sources":["D:/project/excalidraw-cn/src/utils.ts"],"sourcesContent":["import oc from \"open-color\";\nimport { COLOR_PALETTE } from \"./colors\";\nimport {\n  CURSOR_TYPE,\n  DEFAULT_VERSION,\n  EVENT,\n  FONT_FAMILY,\n  isDarwin,\n  MIME_TYPES,\n  THEME,\n  WINDOWS_EMOJI_FALLBACK_FONT,\n} from \"./constants\";\nimport {\n  FontFamilyValues,\n  FontString,\n  NonDeletedExcalidrawElement,\n} from \"./element/types\";\nimport { AppState, DataURL, LastActiveTool, Zoom } from \"./types\";\nimport { unstable_batchedUpdates } from \"react-dom\";\nimport { SHAPES } from \"./shapes\";\nimport { isEraserActive, isHandToolActive } from \"./appState\";\nimport { ResolutionType } from \"./utility-types\";\n\nlet mockDateTime: string | null = null;\n\nexport const setDateTimeForTests = (dateTime: string) => {\n  mockDateTime = dateTime;\n};\n\nexport const getDateTime = () => {\n  if (mockDateTime) {\n    return mockDateTime;\n  }\n\n  const date = new Date();\n  const year = date.getFullYear();\n  const month = `${date.getMonth() + 1}`.padStart(2, \"0\");\n  const day = `${date.getDate()}`.padStart(2, \"0\");\n  const hr = `${date.getHours()}`.padStart(2, \"0\");\n  const min = `${date.getMinutes()}`.padStart(2, \"0\");\n\n  return `${year}-${month}-${day}-${hr}${min}`;\n};\n\nexport const capitalizeString = (str: string) =>\n  str.charAt(0).toUpperCase() + str.slice(1);\n\nexport const isToolIcon = (\n  target: Element | EventTarget | null,\n): target is HTMLElement =>\n  target instanceof HTMLElement && target.className.includes(\"ToolIcon\");\n\nexport const isInputLike = (\n  target: Element | EventTarget | null,\n): target is\n  | HTMLInputElement\n  | HTMLTextAreaElement\n  | HTMLSelectElement\n  | HTMLBRElement\n  | HTMLDivElement =>\n  (target instanceof HTMLElement && target.dataset.type === \"wysiwyg\") ||\n  target instanceof HTMLBRElement || // newline in wysiwyg\n  target instanceof HTMLInputElement ||\n  target instanceof HTMLTextAreaElement ||\n  target instanceof HTMLSelectElement;\n\nexport const isInteractive = (target: Element | EventTarget | null) => {\n  return (\n    isInputLike(target) ||\n    (target instanceof Element && !!target.closest(\"label, button\"))\n  );\n};\n\nexport const isWritableElement = (\n  target: Element | EventTarget | null,\n): target is\n  | HTMLInputElement\n  | HTMLTextAreaElement\n  | HTMLBRElement\n  | HTMLDivElement =>\n  (target instanceof HTMLElement && target.dataset.type === \"wysiwyg\") ||\n  target instanceof HTMLBRElement || // newline in wysiwyg\n  target instanceof HTMLTextAreaElement ||\n  (target instanceof HTMLInputElement &&\n    (target.type === \"text\" || target.type === \"number\"));\n\nexport const getFontFamilyString = ({\n  fontFamily,\n}: {\n  fontFamily: FontFamilyValues;\n}) => {\n  for (const [fontFamilyString, id] of Object.entries(FONT_FAMILY)) {\n    if (id === fontFamily) {\n      return `${fontFamilyString}, ${WINDOWS_EMOJI_FALLBACK_FONT}`;\n    }\n  }\n  return WINDOWS_EMOJI_FALLBACK_FONT;\n};\n\n/** returns fontSize+fontFamily string for assignment to DOM elements */\nexport const getFontString = ({\n  fontSize,\n  fontFamily,\n}: {\n  fontSize: number;\n  fontFamily: FontFamilyValues;\n}) => {\n  return `${fontSize}px ${getFontFamilyString({ fontFamily })}` as FontString;\n};\n\nexport const debounce = <T extends any[]>(\n  fn: (...args: T) => void,\n  timeout: number,\n) => {\n  let handle = 0;\n  let lastArgs: T | null = null;\n  const ret = (...args: T) => {\n    lastArgs = args;\n    clearTimeout(handle);\n    handle = window.setTimeout(() => {\n      lastArgs = null;\n      fn(...args);\n    }, timeout);\n  };\n  ret.flush = () => {\n    clearTimeout(handle);\n    if (lastArgs) {\n      const _lastArgs = lastArgs;\n      lastArgs = null;\n      fn(..._lastArgs);\n    }\n  };\n  ret.cancel = () => {\n    lastArgs = null;\n    clearTimeout(handle);\n  };\n  return ret;\n};\n\n// throttle callback to execute once per animation frame\nexport const throttleRAF = <T extends any[]>(\n  fn: (...args: T) => void,\n  opts?: { trailing?: boolean },\n) => {\n  let timerId: number | null = null;\n  let lastArgs: T | null = null;\n  let lastArgsTrailing: T | null = null;\n\n  const scheduleFunc = (args: T) => {\n    timerId = window.requestAnimationFrame(() => {\n      timerId = null;\n      fn(...args);\n      lastArgs = null;\n      if (lastArgsTrailing) {\n        lastArgs = lastArgsTrailing;\n        lastArgsTrailing = null;\n        scheduleFunc(lastArgs);\n      }\n    });\n  };\n\n  const ret = (...args: T) => {\n    if (process.env.NODE_ENV === \"test\") {\n      fn(...args);\n      return;\n    }\n    lastArgs = args;\n    if (timerId === null) {\n      scheduleFunc(lastArgs);\n    } else if (opts?.trailing) {\n      lastArgsTrailing = args;\n    }\n  };\n  ret.flush = () => {\n    if (timerId !== null) {\n      cancelAnimationFrame(timerId);\n      timerId = null;\n    }\n    if (lastArgs) {\n      fn(...(lastArgsTrailing || lastArgs));\n      lastArgs = lastArgsTrailing = null;\n    }\n  };\n  ret.cancel = () => {\n    lastArgs = lastArgsTrailing = null;\n    if (timerId !== null) {\n      cancelAnimationFrame(timerId);\n      timerId = null;\n    }\n  };\n  return ret;\n};\n\n/**\n * Exponential ease-out method\n *\n * @param {number} k - The value to be tweened.\n * @returns {number} The tweened value.\n */\nexport const easeOut = (k: number) => {\n  return 1 - Math.pow(1 - k, 4);\n};\n\nconst easeOutInterpolate = (from: number, to: number, progress: number) => {\n  return (to - from) * easeOut(progress) + from;\n};\n\n/**\n * Animates values from `fromValues` to `toValues` using the requestAnimationFrame API.\n * Executes the `onStep` callback on each step with the interpolated values.\n * Returns a function that can be called to cancel the animation.\n *\n * @example\n * // Example usage:\n * const fromValues = { x: 0, y: 0 };\n * const toValues = { x: 100, y: 200 };\n * const onStep = ({x, y}) => {\n *   setState(x, y)\n * };\n * const onCancel = () => {\n *   console.log(\"Animation canceled\");\n * };\n *\n * const cancelAnimation = easeToValuesRAF({\n *   fromValues,\n *   toValues,\n *   onStep,\n *   onCancel,\n * });\n *\n * // To cancel the animation:\n * cancelAnimation();\n */\nexport const easeToValuesRAF = <\n  T extends Record<keyof T, number>,\n  K extends keyof T,\n>({\n  fromValues,\n  toValues,\n  onStep,\n  duration = 250,\n  interpolateValue,\n  onStart,\n  onEnd,\n  onCancel,\n}: {\n  fromValues: T;\n  toValues: T;\n  /**\n   * Interpolate a single value.\n   * Return undefined to be handled by the default interpolator.\n   */\n  interpolateValue?: (\n    fromValue: number,\n    toValue: number,\n    /** no easing applied  */\n    progress: number,\n    key: K,\n  ) => number | undefined;\n  onStep: (values: T) => void;\n  duration?: number;\n  onStart?: () => void;\n  onEnd?: () => void;\n  onCancel?: () => void;\n}) => {\n  let canceled = false;\n  let frameId = 0;\n  let startTime: number;\n\n  function step(timestamp: number) {\n    if (canceled) {\n      return;\n    }\n    if (startTime === undefined) {\n      startTime = timestamp;\n      onStart?.();\n    }\n\n    const elapsed = Math.min(timestamp - startTime, duration);\n    const factor = easeOut(elapsed / duration);\n\n    const newValues = {} as T;\n\n    Object.keys(fromValues).forEach((key) => {\n      const _key = key as keyof T;\n      const result = ((toValues[_key] - fromValues[_key]) * factor +\n        fromValues[_key]) as T[keyof T];\n      newValues[_key] = result;\n    });\n\n    onStep(newValues);\n\n    if (elapsed < duration) {\n      const progress = elapsed / duration;\n\n      const newValues = {} as T;\n\n      Object.keys(fromValues).forEach((key) => {\n        const _key = key as K;\n        const startValue = fromValues[_key];\n        const endValue = toValues[_key];\n\n        let result;\n\n        result = interpolateValue\n          ? interpolateValue(startValue, endValue, progress, _key)\n          : easeOutInterpolate(startValue, endValue, progress);\n\n        if (result == null) {\n          result = easeOutInterpolate(startValue, endValue, progress);\n        }\n\n        newValues[_key] = result as T[K];\n      });\n      onStep(newValues);\n\n      frameId = window.requestAnimationFrame(step);\n    } else {\n      onStep(toValues);\n      onEnd?.();\n    }\n  }\n\n  frameId = window.requestAnimationFrame(step);\n\n  return () => {\n    onCancel?.();\n    canceled = true;\n    window.cancelAnimationFrame(frameId);\n  };\n};\n\n// https://github.com/lodash/lodash/blob/es/chunk.js\nexport const chunk = <T extends any>(\n  array: readonly T[],\n  size: number,\n): T[][] => {\n  if (!array.length || size < 1) {\n    return [];\n  }\n  let index = 0;\n  let resIndex = 0;\n  const result = Array(Math.ceil(array.length / size));\n  while (index < array.length) {\n    result[resIndex++] = array.slice(index, (index += size));\n  }\n  return result;\n};\n\nexport const selectNode = (node: Element) => {\n  const selection = window.getSelection();\n  if (selection) {\n    const range = document.createRange();\n    range.selectNodeContents(node);\n    selection.removeAllRanges();\n    selection.addRange(range);\n  }\n};\n\nexport const removeSelection = () => {\n  const selection = window.getSelection();\n  if (selection) {\n    selection.removeAllRanges();\n  }\n};\n\nexport const distance = (x: number, y: number) => Math.abs(x - y);\n\nexport const updateActiveTool = (\n  appState: Pick<AppState, \"activeTool\">,\n  data: (\n    | { type: typeof SHAPES[number][\"value\"] | \"eraser\" | \"hand\" | \"frame\" }\n    | { type: \"custom\"; customType: string }\n  ) & { lastActiveToolBeforeEraser?: LastActiveTool },\n): AppState[\"activeTool\"] => {\n  if (data.type === \"custom\") {\n    return {\n      ...appState.activeTool,\n      type: \"custom\",\n      customType: data.customType,\n    };\n  }\n\n  return {\n    ...appState.activeTool,\n    lastActiveTool:\n      data.lastActiveToolBeforeEraser === undefined\n        ? appState.activeTool.lastActiveTool\n        : data.lastActiveToolBeforeEraser,\n    type: data.type,\n    customType: null,\n  };\n};\n\nexport const resetCursor = (canvas: HTMLCanvasElement | null) => {\n  if (canvas) {\n    canvas.style.cursor = \"\";\n  }\n};\n\nexport const setCursor = (canvas: HTMLCanvasElement | null, cursor: string) => {\n  if (canvas) {\n    canvas.style.cursor = cursor;\n  }\n};\n\nlet eraserCanvasCache: any;\nlet previewDataURL: string;\nexport const setEraserCursor = (\n  canvas: HTMLCanvasElement | null,\n  theme: AppState[\"theme\"],\n) => {\n  const cursorImageSizePx = 20;\n\n  const drawCanvas = () => {\n    const isDarkTheme = theme === THEME.DARK;\n    eraserCanvasCache = document.createElement(\"canvas\");\n    eraserCanvasCache.theme = theme;\n    eraserCanvasCache.height = cursorImageSizePx;\n    eraserCanvasCache.width = cursorImageSizePx;\n    const context = eraserCanvasCache.getContext(\"2d\")!;\n    context.lineWidth = 1;\n    context.beginPath();\n    context.arc(\n      eraserCanvasCache.width / 2,\n      eraserCanvasCache.height / 2,\n      5,\n      0,\n      2 * Math.PI,\n    );\n    context.fillStyle = isDarkTheme ? oc.black : oc.white;\n    context.fill();\n    context.strokeStyle = isDarkTheme ? oc.white : oc.black;\n    context.stroke();\n    previewDataURL = eraserCanvasCache.toDataURL(MIME_TYPES.svg) as DataURL;\n  };\n  if (!eraserCanvasCache || eraserCanvasCache.theme !== theme) {\n    drawCanvas();\n  }\n\n  setCursor(\n    canvas,\n    `url(${previewDataURL}) ${cursorImageSizePx / 2} ${\n      cursorImageSizePx / 2\n    }, auto`,\n  );\n};\n\nexport const setCursorForShape = (\n  canvas: HTMLCanvasElement | null,\n  appState: Pick<AppState, \"activeTool\" | \"theme\">,\n) => {\n  if (!canvas) {\n    return;\n  }\n  if (appState.activeTool.type === \"selection\") {\n    resetCursor(canvas);\n  } else if (isHandToolActive(appState)) {\n    canvas.style.cursor = CURSOR_TYPE.GRAB;\n  } else if (isEraserActive(appState)) {\n    setEraserCursor(canvas, appState.theme);\n    // do nothing if image tool is selected which suggests there's\n    // a image-preview set as the cursor\n    // Ignore custom type as well and let host decide\n  } else if (![\"image\", \"custom\"].includes(appState.activeTool.type)) {\n    canvas.style.cursor = CURSOR_TYPE.CROSSHAIR;\n  }\n};\n\nexport const isFullScreen = () =>\n  document.fullscreenElement?.nodeName === \"HTML\";\n\nexport const allowFullScreen = () =>\n  document.documentElement.requestFullscreen();\n\nexport const exitFullScreen = () => document.exitFullscreen();\n\nexport const getShortcutKey = (shortcut: string): string => {\n  shortcut = shortcut\n    .replace(/\\bAlt\\b/i, \"Alt\")\n    .replace(/\\bShift\\b/i, \"Shift\")\n    .replace(/\\b(Enter|Return)\\b/i, \"Enter\");\n  if (isDarwin) {\n    return shortcut\n      .replace(/\\bCtrlOrCmd\\b/gi, \"Cmd\")\n      .replace(/\\bAlt\\b/i, \"Option\");\n  }\n  return shortcut.replace(/\\bCtrlOrCmd\\b/gi, \"Ctrl\");\n};\n\nexport const viewportCoordsToSceneCoords = (\n  { clientX, clientY }: { clientX: number; clientY: number },\n  {\n    zoom,\n    offsetLeft,\n    offsetTop,\n    scrollX,\n    scrollY,\n  }: {\n    zoom: Zoom;\n    offsetLeft: number;\n    offsetTop: number;\n    scrollX: number;\n    scrollY: number;\n  },\n) => {\n  const x = (clientX - offsetLeft) / zoom.value - scrollX;\n  const y = (clientY - offsetTop) / zoom.value - scrollY;\n\n  return { x, y };\n};\n\nexport const sceneCoordsToViewportCoords = (\n  { sceneX, sceneY }: { sceneX: number; sceneY: number },\n  {\n    zoom,\n    offsetLeft,\n    offsetTop,\n    scrollX,\n    scrollY,\n  }: {\n    zoom: Zoom;\n    offsetLeft: number;\n    offsetTop: number;\n    scrollX: number;\n    scrollY: number;\n  },\n) => {\n  const x = (sceneX + scrollX) * zoom.value + offsetLeft;\n  const y = (sceneY + scrollY) * zoom.value + offsetTop;\n  return { x, y };\n};\n\nexport const getGlobalCSSVariable = (name: string) =>\n  getComputedStyle(document.documentElement).getPropertyValue(`--${name}`);\n\nconst RS_LTR_CHARS =\n  \"A-Za-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02B8\\u0300-\\u0590\\u0800-\\u1FFF\" +\n  \"\\u2C00-\\uFB1C\\uFDFE-\\uFE6F\\uFEFD-\\uFFFF\";\nconst RS_RTL_CHARS = \"\\u0591-\\u07FF\\uFB1D-\\uFDFD\\uFE70-\\uFEFC\";\nconst RE_RTL_CHECK = new RegExp(`^[^${RS_LTR_CHARS}]*[${RS_RTL_CHARS}]`);\n/**\n * Checks whether first directional character is RTL. Meaning whether it starts\n *  with RTL characters, or indeterminate (numbers etc.) characters followed by\n *  RTL.\n * See https://github.com/excalidraw/excalidraw/pull/1722#discussion_r436340171\n */\nexport const isRTL = (text: string) => RE_RTL_CHECK.test(text);\n\nexport const tupleToCoors = (\n  xyTuple: readonly [number, number],\n): { x: number; y: number } => {\n  const [x, y] = xyTuple;\n  return { x, y };\n};\n\n/** use as a rejectionHandler to mute filesystem Abort errors */\nexport const muteFSAbortError = (error?: Error) => {\n  if (error?.name === \"AbortError\") {\n    console.warn(error);\n    return;\n  }\n  throw error;\n};\n\nexport const findIndex = <T>(\n  array: readonly T[],\n  cb: (element: T, index: number, array: readonly T[]) => boolean,\n  fromIndex: number = 0,\n) => {\n  if (fromIndex < 0) {\n    fromIndex = array.length + fromIndex;\n  }\n  fromIndex = Math.min(array.length, Math.max(fromIndex, 0));\n  let index = fromIndex - 1;\n  while (++index < array.length) {\n    if (cb(array[index], index, array)) {\n      return index;\n    }\n  }\n  return -1;\n};\n\nexport const findLastIndex = <T>(\n  array: readonly T[],\n  cb: (element: T, index: number, array: readonly T[]) => boolean,\n  fromIndex: number = array.length - 1,\n) => {\n  if (fromIndex < 0) {\n    fromIndex = array.length + fromIndex;\n  }\n  fromIndex = Math.min(array.length - 1, Math.max(fromIndex, 0));\n  let index = fromIndex + 1;\n  while (--index > -1) {\n    if (cb(array[index], index, array)) {\n      return index;\n    }\n  }\n  return -1;\n};\n\nexport const isTransparent = (color: string) => {\n  const isRGBTransparent = color.length === 5 && color.substr(4, 1) === \"0\";\n  const isRRGGBBTransparent = color.length === 9 && color.substr(7, 2) === \"00\";\n  return (\n    isRGBTransparent ||\n    isRRGGBBTransparent ||\n    color === COLOR_PALETTE.transparent\n  );\n};\n\nexport type ResolvablePromise<T> = Promise<T> & {\n  resolve: [T] extends [undefined] ? (value?: T) => void : (value: T) => void;\n  reject: (error: Error) => void;\n};\nexport const resolvablePromise = <T>() => {\n  let resolve!: any;\n  let reject!: any;\n  const promise = new Promise((_resolve, _reject) => {\n    resolve = _resolve;\n    reject = _reject;\n  });\n  (promise as any).resolve = resolve;\n  (promise as any).reject = reject;\n  return promise as ResolvablePromise<T>;\n};\n\n/**\n * @param func handler taking at most single parameter (event).\n */\nexport const withBatchedUpdates = <\n  TFunction extends ((event: any) => void) | (() => void),\n>(\n  func: Parameters<TFunction>[\"length\"] extends 0 | 1 ? TFunction : never,\n) =>\n  ((event) => {\n    unstable_batchedUpdates(func as TFunction, event);\n  }) as TFunction;\n\n/**\n * barches React state updates and throttles the calls to a single call per\n * animation frame\n */\nexport const withBatchedUpdatesThrottled = <\n  TFunction extends ((event: any) => void) | (() => void),\n>(\n  func: Parameters<TFunction>[\"length\"] extends 0 | 1 ? TFunction : never,\n) => {\n  // @ts-ignore\n  return throttleRAF<Parameters<TFunction>>(((event) => {\n    unstable_batchedUpdates(func, event);\n  }) as TFunction);\n};\n\n//https://stackoverflow.com/a/9462382/8418\nexport const nFormatter = (num: number, digits: number): string => {\n  const si = [\n    { value: 1, symbol: \"b\" },\n    { value: 1e3, symbol: \"k\" },\n    { value: 1e6, symbol: \"M\" },\n    { value: 1e9, symbol: \"G\" },\n  ];\n  const rx = /\\.0+$|(\\.[0-9]*[1-9])0+$/;\n  let index;\n  for (index = si.length - 1; index > 0; index--) {\n    if (num >= si[index].value) {\n      break;\n    }\n  }\n  return (\n    (num / si[index].value).toFixed(digits).replace(rx, \"$1\") + si[index].symbol\n  );\n};\n\nexport const getVersion = () => {\n  return (\n    document.querySelector<HTMLMetaElement>('meta[name=\"version\"]')?.content ||\n    DEFAULT_VERSION\n  );\n};\n\n// Adapted from https://github.com/Modernizr/Modernizr/blob/master/feature-detects/emoji.js\nexport const supportsEmoji = () => {\n  const canvas = document.createElement(\"canvas\");\n  const ctx = canvas.getContext(\"2d\");\n  if (!ctx) {\n    return false;\n  }\n  const offset = 12;\n  ctx.fillStyle = \"#f00\";\n  ctx.textBaseline = \"top\";\n  ctx.font = \"32px Arial\";\n  // Modernizr used ðŸ¨, but it is sort of supported on Windows 7.\n  // Luckily ðŸ˜€ isn't supported.\n  ctx.fillText(\"ðŸ˜€\", 0, 0);\n  return ctx.getImageData(offset, offset, 1, 1).data[0] !== 0;\n};\n\nexport const getNearestScrollableContainer = (\n  element: HTMLElement,\n): HTMLElement | Document => {\n  let parent = element.parentElement;\n  while (parent) {\n    if (parent === document.body) {\n      return document;\n    }\n    const { overflowY } = window.getComputedStyle(parent);\n    const hasScrollableContent = parent.scrollHeight > parent.clientHeight;\n    if (\n      hasScrollableContent &&\n      (overflowY === \"auto\" ||\n        overflowY === \"scroll\" ||\n        overflowY === \"overlay\")\n    ) {\n      return parent;\n    }\n    parent = parent.parentElement;\n  }\n  return document;\n};\n\nexport const focusNearestParent = (element: HTMLInputElement) => {\n  let parent = element.parentElement;\n  while (parent) {\n    if (parent.tabIndex > -1) {\n      parent.focus();\n      return;\n    }\n    parent = parent.parentElement;\n  }\n};\n\nexport const preventUnload = (event: BeforeUnloadEvent) => {\n  event.preventDefault();\n  // NOTE: modern browsers no longer allow showing a custom message here\n  event.returnValue = \"\";\n};\n\nexport const bytesToHexString = (bytes: Uint8Array) => {\n  return Array.from(bytes)\n    .map((byte) => `0${byte.toString(16)}`.slice(-2))\n    .join(\"\");\n};\n\nexport const getUpdatedTimestamp = () => (isTestEnv() ? 1 : Date.now());\n\n/**\n * Transforms array of objects containing `id` attribute,\n * or array of ids (strings), into a Map, keyd by `id`.\n */\nexport const arrayToMap = <T extends { id: string } | string>(\n  items: readonly T[],\n) => {\n  return items.reduce((acc: Map<string, T>, element) => {\n    acc.set(typeof element === \"string\" ? element : element.id, element);\n    return acc;\n  }, new Map());\n};\n\nexport const arrayToMapWithIndex = <T extends { id: string }>(\n  elements: readonly T[],\n) =>\n  elements.reduce((acc, element: T, idx) => {\n    acc.set(element.id, [element, idx]);\n    return acc;\n  }, new Map<string, [element: T, index: number]>());\n\nexport const isTestEnv = () => process.env.NODE_ENV === \"test\";\n\nexport const wrapEvent = <T extends Event>(name: EVENT, nativeEvent: T) => {\n  return new CustomEvent(name, {\n    detail: {\n      nativeEvent,\n    },\n    cancelable: true,\n  });\n};\n\nexport const updateObject = <T extends Record<string, any>>(\n  obj: T,\n  updates: Partial<T>,\n): T => {\n  let didChange = false;\n  for (const key in updates) {\n    const value = (updates as any)[key];\n    if (typeof value !== \"undefined\") {\n      if (\n        (obj as any)[key] === value &&\n        // if object, always update because its attrs could have changed\n        (typeof value !== \"object\" || value === null)\n      ) {\n        continue;\n      }\n      didChange = true;\n    }\n  }\n\n  if (!didChange) {\n    return obj;\n  }\n\n  return {\n    ...obj,\n    ...updates,\n  };\n};\n\nexport const isPrimitive = (val: any) => {\n  const type = typeof val;\n  return val == null || (type !== \"object\" && type !== \"function\");\n};\n\nexport const getFrame = () => {\n  try {\n    return window.self === window.top ? \"top\" : \"iframe\";\n  } catch (error) {\n    return \"iframe\";\n  }\n};\n\nexport const isRunningInIframe = () => getFrame() === \"iframe\";\n\nexport const isPromiseLike = (\n  value: any,\n): value is Promise<ResolutionType<typeof value>> => {\n  return (\n    !!value &&\n    typeof value === \"object\" &&\n    \"then\" in value &&\n    \"catch\" in value &&\n    \"finally\" in value\n  );\n};\n\nexport const queryFocusableElements = (container: HTMLElement | null) => {\n  const focusableElements = container?.querySelectorAll<HTMLElement>(\n    \"button, a, input, select, textarea, div[tabindex], label[tabindex]\",\n  );\n\n  return focusableElements\n    ? Array.from(focusableElements).filter(\n        (element) =>\n          element.tabIndex > -1 && !(element as HTMLInputElement).disabled,\n      )\n    : [];\n};\n\nexport const isShallowEqual = <\n  T extends Record<string, any>,\n  I extends keyof T,\n>(\n  objA: T,\n  objB: T,\n  comparators?: Record<I, (a: T[I], b: T[I]) => boolean>,\n  debug = false,\n) => {\n  const aKeys = Object.keys(objA);\n  const bKeys = Object.keys(objB);\n  if (aKeys.length !== bKeys.length) {\n    return false;\n  }\n  return aKeys.every((key) => {\n    const comparator = comparators?.[key as I];\n    const ret = comparator\n      ? comparator(objA[key], objB[key])\n      : objA[key] === objB[key];\n    if (!ret && debug) {\n      console.info(\n        `%cisShallowEqual: ${key} not equal ->`,\n        \"color: #8B4000\",\n        objA[key],\n        objB[key],\n      );\n    }\n    return ret;\n  });\n};\n\n// taken from Radix UI\n// https://github.com/radix-ui/primitives/blob/main/packages/core/primitive/src/primitive.tsx\nexport const composeEventHandlers = <E>(\n  originalEventHandler?: (event: E) => void,\n  ourEventHandler?: (event: E) => void,\n  { checkForDefaultPrevented = true } = {},\n) => {\n  return function handleEvent(event: E) {\n    originalEventHandler?.(event);\n\n    if (\n      !checkForDefaultPrevented ||\n      !(event as unknown as Event).defaultPrevented\n    ) {\n      return ourEventHandler?.(event);\n    }\n  };\n};\n\nexport const isOnlyExportingSingleFrame = (\n  elements: readonly NonDeletedExcalidrawElement[],\n) => {\n  const frames = elements.filter((element) => element.type === \"frame\");\n\n  return (\n    frames.length === 1 &&\n    elements.every(\n      (element) => element.type === \"frame\" || element.frameId === frames[0].id,\n    )\n  );\n};\n"],"mappings":"iVAAA,MAAO,CAAAA,EAAE,KAAM,YAAY,CAC3B,OAASC,aAAa,KAAQ,UAAU,CACxC,OACEC,WAAW,CACXC,eAAe,CAEfC,WAAW,CACXC,QAAQ,CACRC,UAAU,CACVC,KAAK,CACLC,2BAA2B,KACtB,aAAa,CAOpB,OAASC,uBAAuB,KAAQ,WAAW,CAEnD,OAASC,cAAc,CAAEC,gBAAgB,KAAQ,YAAY,CAG7D,GAAI,CAAAC,YAA2B,CAAG,IAAI,CAEtC,MAAO,IAAM,CAAAC,mBAAmB,CAAG,QAAtB,CAAAA,mBAAmBA,CAAIC,QAAgB,CAAK,CACvDF,YAAY,CAAGE,QAAQ,CACzB,CAAC,CAED,MAAO,IAAM,CAAAC,WAAW,CAAG,QAAd,CAAAA,WAAWA,CAAA,CAAS,CAC/B,GAAIH,YAAY,CAAE,CAChB,MAAO,CAAAA,YAAY,CACrB,CAEA,GAAM,CAAAI,IAAI,CAAG,GAAI,CAAAC,IAAI,EAAE,CACvB,GAAM,CAAAC,IAAI,CAAGF,IAAI,CAACG,WAAW,EAAE,CAC/B,GAAM,CAAAC,KAAK,CAAG,GAAAC,MAAA,CAAGL,IAAI,CAACM,QAAQ,EAAE,CAAG,CAAC,EAAGC,QAAQ,CAAC,CAAC,CAAE,GAAG,CAAC,CACvD,GAAM,CAAAC,GAAG,CAAG,GAAAH,MAAA,CAAGL,IAAI,CAACS,OAAO,EAAE,EAAGF,QAAQ,CAAC,CAAC,CAAE,GAAG,CAAC,CAChD,GAAM,CAAAG,EAAE,CAAG,GAAAL,MAAA,CAAGL,IAAI,CAACW,QAAQ,EAAE,EAAGJ,QAAQ,CAAC,CAAC,CAAE,GAAG,CAAC,CAChD,GAAM,CAAAK,GAAG,CAAG,GAAAP,MAAA,CAAGL,IAAI,CAACa,UAAU,EAAE,EAAGN,QAAQ,CAAC,CAAC,CAAE,GAAG,CAAC,CAEnD,SAAAF,MAAA,CAAUH,IAAI,MAAAG,MAAA,CAAID,KAAK,MAAAC,MAAA,CAAIG,GAAG,MAAAH,MAAA,CAAIK,EAAE,EAAAL,MAAA,CAAGO,GAAG,EAC5C,CAAC,CAED,MAAO,IAAM,CAAAE,gBAAgB,CAAG,QAAnB,CAAAA,gBAAgBA,CAAIC,GAAW,QAC1C,CAAAA,GAAG,CAACC,MAAM,CAAC,CAAC,CAAC,CAACC,WAAW,EAAE,CAAGF,GAAG,CAACG,KAAK,CAAC,CAAC,CAAC,GAE5C,MAAO,IAAM,CAAAC,UAAU,CAAG,QAAb,CAAAA,UAAUA,CACrBC,MAAoC,QAEpC,CAAAA,MAAM,WAAY,CAAAC,WAAW,EAAID,MAAM,CAACE,SAAS,CAACC,QAAQ,CAAC,UAAU,CAAC,GAExE,MAAO,IAAM,CAAAC,WAAW,CAAG,QAAd,CAAAA,WAAWA,CACtBJ,MAAoC,QAOnC,CAAAA,MAAM,WAAY,CAAAC,WAAW,EAAID,MAAM,CAACK,OAAO,CAACC,IAAI,GAAK,SAAS,EACnEN,MAAM,WAAY,CAAAO,aAAa,EAAI;AACnCP,MAAM,WAAY,CAAAQ,gBAAgB,EAClCR,MAAM,WAAY,CAAAS,mBAAmB,EACrCT,MAAM,WAAY,CAAAU,iBAAiB,GAErC,MAAO,IAAM,CAAAC,aAAa,CAAG,QAAhB,CAAAA,aAAaA,CAAIX,MAAoC,CAAK,CACrE,MACE,CAAAI,WAAW,CAACJ,MAAM,CAAC,EAClBA,MAAM,WAAY,CAAAY,OAAO,EAAI,CAAC,CAACZ,MAAM,CAACa,OAAO,CAAC,eAAe,CAAE,CAEpE,CAAC,CAED,MAAO,IAAM,CAAAC,iBAAiB,CAAG,QAApB,CAAAA,iBAAiBA,CAC5Bd,MAAoC,QAMnC,CAAAA,MAAM,WAAY,CAAAC,WAAW,EAAID,MAAM,CAACK,OAAO,CAACC,IAAI,GAAK,SAAS,EACnEN,MAAM,WAAY,CAAAO,aAAa,EAAI;AACnCP,MAAM,WAAY,CAAAS,mBAAmB,EACpCT,MAAM,WAAY,CAAAQ,gBAAgB,GAChCR,MAAM,CAACM,IAAI,GAAK,MAAM,EAAIN,MAAM,CAACM,IAAI,GAAK,QAAQ,CAAE,GAEzD,MAAO,IAAM,CAAAS,mBAAmB,CAAG,QAAtB,CAAAA,mBAAmBA,CAAAC,IAAA,CAI1B,IAHJ,CAAAC,UAAU,CAAAD,IAAA,CAAVC,UAAU,CAIV,QAAAC,EAAA,GAAAC,eAAA,CAAqCC,MAAM,CAACC,OAAO,CAACrD,WAAW,CAAC,CAAAkD,EAAA,CAAAC,eAAA,CAAAG,MAAA,CAAAJ,EAAA,GAAE,CAA7D,IAAAK,kBAAA,CAAAC,cAAA,CAAAL,eAAA,CAAAD,EAAA,KAAOO,gBAAgB,CAAAF,kBAAA,IAAEG,EAAE,CAAAH,kBAAA,IAC9B,GAAIG,EAAE,GAAKT,UAAU,CAAE,CACrB,SAAAhC,MAAA,CAAUwC,gBAAgB,OAAAxC,MAAA,CAAKb,2BAA2B,EAC5D,CACF,CACA,MAAO,CAAAA,2BAA2B,CACpC,CAAC,CAED,wEACA,MAAO,IAAM,CAAAuD,aAAa,CAAG,QAAhB,CAAAA,aAAaA,CAAAC,KAAA,CAMpB,IALJ,CAAAC,QAAQ,CAAAD,KAAA,CAARC,QAAQ,CACRZ,UAAU,CAAAW,KAAA,CAAVX,UAAU,CAKV,SAAAhC,MAAA,CAAU4C,QAAQ,QAAA5C,MAAA,CAAM8B,mBAAmB,CAAC,CAAEE,UAAU,CAAVA,UAAW,CAAC,CAAC,EAC7D,CAAC,CAED,MAAO,IAAM,CAAAa,QAAQ,CAAG,QAAX,CAAAA,QAAQA,CACnBC,EAAwB,CACxBC,OAAe,CACZ,CACH,GAAI,CAAAC,MAAM,CAAG,CAAC,CACd,GAAI,CAAAC,QAAkB,CAAG,IAAI,CAC7B,GAAM,CAAAC,GAAG,CAAG,QAAN,CAAAA,GAAGA,CAAA,CAAmB,SAAAC,IAAA,CAAAC,SAAA,CAAAf,MAAA,CAAZgB,IAAI,KAAAC,KAAA,CAAAH,IAAA,EAAAI,KAAA,GAAAA,KAAA,CAAAJ,IAAA,CAAAI,KAAA,IAAJF,IAAI,CAAAE,KAAA,EAAAH,SAAA,CAAAG,KAAA,GAClBN,QAAQ,CAAGI,IAAI,CACfG,YAAY,CAACR,MAAM,CAAC,CACpBA,MAAM,CAAGS,MAAM,CAACC,UAAU,CAAC,UAAM,CAC/BT,QAAQ,CAAG,IAAI,CACfH,EAAE,CAAAa,KAAA,QAAIN,IAAI,CAAC,CACb,CAAC,CAAEN,OAAO,CAAC,CACb,CAAC,CACDG,GAAG,CAACU,KAAK,CAAG,UAAM,CAChBJ,YAAY,CAACR,MAAM,CAAC,CACpB,GAAIC,QAAQ,CAAE,CACZ,GAAM,CAAAY,SAAS,CAAGZ,QAAQ,CAC1BA,QAAQ,CAAG,IAAI,CACfH,EAAE,CAAAa,KAAA,QAAAG,kBAAA,CAAID,SAAS,EAAC,CAClB,CACF,CAAC,CACDX,GAAG,CAACa,MAAM,CAAG,UAAM,CACjBd,QAAQ,CAAG,IAAI,CACfO,YAAY,CAACR,MAAM,CAAC,CACtB,CAAC,CACD,MAAO,CAAAE,GAAG,CACZ,CAAC,CAED;AACA,MAAO,IAAM,CAAAc,WAAW,CAAG,QAAd,CAAAA,WAAWA,CACtBlB,EAAwB,CACxBmB,IAA6B,CAC1B,CACH,GAAI,CAAAC,OAAsB,CAAG,IAAI,CACjC,GAAI,CAAAjB,QAAkB,CAAG,IAAI,CAC7B,GAAI,CAAAkB,gBAA0B,CAAG,IAAI,CAErC,GAAM,CAAAC,YAAY,CAAG,QAAf,CAAAA,YAAYA,CAAIf,IAAO,CAAK,CAChCa,OAAO,CAAGT,MAAM,CAACY,qBAAqB,CAAC,UAAM,CAC3CH,OAAO,CAAG,IAAI,CACdpB,EAAE,CAAAa,KAAA,QAAAG,kBAAA,CAAIT,IAAI,EAAC,CACXJ,QAAQ,CAAG,IAAI,CACf,GAAIkB,gBAAgB,CAAE,CACpBlB,QAAQ,CAAGkB,gBAAgB,CAC3BA,gBAAgB,CAAG,IAAI,CACvBC,YAAY,CAACnB,QAAQ,CAAC,CACxB,CACF,CAAC,CAAC,CACJ,CAAC,CAED,GAAM,CAAAC,GAAG,CAAG,QAAN,CAAAA,GAAGA,CAAA,CAAmB,SAAAoB,KAAA,CAAAlB,SAAA,CAAAf,MAAA,CAAZgB,IAAI,KAAAC,KAAA,CAAAgB,KAAA,EAAAC,KAAA,GAAAA,KAAA,CAAAD,KAAA,CAAAC,KAAA,IAAJlB,IAAI,CAAAkB,KAAA,EAAAnB,SAAA,CAAAmB,KAAA,GAClB,GAAIC,OAAO,CAACC,GAAG,CAACC,QAAQ,GAAK,MAAM,CAAE,CACnC5B,EAAE,CAAAa,KAAA,QAAIN,IAAI,CAAC,CACX,OACF,CACAJ,QAAQ,CAAGI,IAAI,CACf,GAAIa,OAAO,GAAK,IAAI,CAAE,CACpBE,YAAY,CAACnB,QAAQ,CAAC,CACxB,CAAC,IAAM,IAAIgB,IAAI,SAAJA,IAAI,WAAJA,IAAI,CAAEU,QAAQ,CAAE,CACzBR,gBAAgB,CAAGd,IAAI,CACzB,CACF,CAAC,CACDH,GAAG,CAACU,KAAK,CAAG,UAAM,CAChB,GAAIM,OAAO,GAAK,IAAI,CAAE,CACpBU,oBAAoB,CAACV,OAAO,CAAC,CAC7BA,OAAO,CAAG,IAAI,CAChB,CACA,GAAIjB,QAAQ,CAAE,CACZH,EAAE,CAAAa,KAAA,QAAAG,kBAAA,CAAKK,gBAAgB,EAAIlB,QAAQ,EAAE,CACrCA,QAAQ,CAAGkB,gBAAgB,CAAG,IAAI,CACpC,CACF,CAAC,CACDjB,GAAG,CAACa,MAAM,CAAG,UAAM,CACjBd,QAAQ,CAAGkB,gBAAgB,CAAG,IAAI,CAClC,GAAID,OAAO,GAAK,IAAI,CAAE,CACpBU,oBAAoB,CAACV,OAAO,CAAC,CAC7BA,OAAO,CAAG,IAAI,CAChB,CACF,CAAC,CACD,MAAO,CAAAhB,GAAG,CACZ,CAAC,CAED;AACA;AACA;AACA;AACA;AACA,GACA,MAAO,IAAM,CAAA2B,OAAO,CAAG,QAAV,CAAAA,OAAOA,CAAIC,CAAS,CAAK,CACpC,MAAO,EAAC,CAAGC,IAAI,CAACC,GAAG,CAAC,CAAC,CAAGF,CAAC,CAAE,CAAC,CAAC,CAC/B,CAAC,CAED,GAAM,CAAAG,kBAAkB,CAAG,QAArB,CAAAA,kBAAkBA,CAAIC,IAAY,CAAEC,EAAU,CAAEC,QAAgB,CAAK,CACzE,MAAO,CAACD,EAAE,CAAGD,IAAI,EAAIL,OAAO,CAACO,QAAQ,CAAC,CAAGF,IAAI,CAC/C,CAAC,CAED;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GACA,MAAO,IAAM,CAAAG,eAAe,CAAG,QAAlB,CAAAA,eAAeA,CAAAC,KAAA,CA+BtB,IA3BJ,CAAAC,UAAU,CAAAD,KAAA,CAAVC,UAAU,CACVC,QAAQ,CAAAF,KAAA,CAARE,QAAQ,CACRC,MAAM,CAAAH,KAAA,CAANG,MAAM,CAAAC,cAAA,CAAAJ,KAAA,CACNK,QAAQ,CAARA,QAAQ,CAAAD,cAAA,UAAG,GAAG,CAAAA,cAAA,CACdE,gBAAgB,CAAAN,KAAA,CAAhBM,gBAAgB,CAChBC,OAAO,CAAAP,KAAA,CAAPO,OAAO,CACPC,KAAK,CAAAR,KAAA,CAALQ,KAAK,CACLC,QAAQ,CAAAT,KAAA,CAARS,QAAQ,CAqBR,GAAI,CAAAC,QAAQ,CAAG,KAAK,CACpB,GAAI,CAAAC,OAAO,CAAG,CAAC,CACf,GAAI,CAAAC,SAAiB,CAErB,QAAS,CAAAC,IAAIA,CAACC,SAAiB,CAAE,CAC/B,GAAIJ,QAAQ,CAAE,CACZ,OACF,CACA,GAAIE,SAAS,GAAKG,SAAS,CAAE,CAC3BH,SAAS,CAAGE,SAAS,CACrBP,OAAO,SAAPA,OAAO,iBAAPA,OAAO,EAAI,CACb,CAEA,GAAM,CAAAS,OAAO,CAAGvB,IAAI,CAACxE,GAAG,CAAC6F,SAAS,CAAGF,SAAS,CAAEP,QAAQ,CAAC,CACzD,GAAM,CAAAY,MAAM,CAAG1B,OAAO,CAACyB,OAAO,CAAGX,QAAQ,CAAC,CAE1C,GAAM,CAAAa,SAAS,CAAG,CAAC,CAAM,CAEzBrE,MAAM,CAACsE,IAAI,CAAClB,UAAU,CAAC,CAACmB,OAAO,CAAC,SAACC,GAAG,CAAK,CACvC,GAAM,CAAAC,IAAI,CAAGD,GAAc,CAC3B,GAAM,CAAAE,MAAM,CAAI,CAACrB,QAAQ,CAACoB,IAAI,CAAC,CAAGrB,UAAU,CAACqB,IAAI,CAAC,EAAIL,MAAM,CAC1DhB,UAAU,CAACqB,IAAI,CAAgB,CACjCJ,SAAS,CAACI,IAAI,CAAC,CAAGC,MAAM,CAC1B,CAAC,CAAC,CAEFpB,MAAM,CAACe,SAAS,CAAC,CAEjB,GAAIF,OAAO,CAAGX,QAAQ,CAAE,CACtB,GAAM,CAAAP,SAAQ,CAAGkB,OAAO,CAAGX,QAAQ,CAEnC,GAAM,CAAAa,UAAS,CAAG,CAAC,CAAM,CAEzBrE,MAAM,CAACsE,IAAI,CAAClB,UAAU,CAAC,CAACmB,OAAO,CAAC,SAACC,GAAG,CAAK,CACvC,GAAM,CAAAC,IAAI,CAAGD,GAAQ,CACrB,GAAM,CAAAG,UAAU,CAAGvB,UAAU,CAACqB,IAAI,CAAC,CACnC,GAAM,CAAAG,QAAQ,CAAGvB,QAAQ,CAACoB,IAAI,CAAC,CAE/B,GAAI,CAAAC,MAAM,CAEVA,MAAM,CAAGjB,gBAAgB,CACrBA,gBAAgB,CAACkB,UAAU,CAAEC,QAAQ,CAAE3B,SAAQ,CAAEwB,IAAI,CAAC,CACtD3B,kBAAkB,CAAC6B,UAAU,CAAEC,QAAQ,CAAE3B,SAAQ,CAAC,CAEtD,GAAIyB,MAAM,EAAI,IAAI,CAAE,CAClBA,MAAM,CAAG5B,kBAAkB,CAAC6B,UAAU,CAAEC,QAAQ,CAAE3B,SAAQ,CAAC,CAC7D,CAEAoB,UAAS,CAACI,IAAI,CAAC,CAAGC,MAAc,CAClC,CAAC,CAAC,CACFpB,MAAM,CAACe,UAAS,CAAC,CAEjBP,OAAO,CAAGxC,MAAM,CAACY,qBAAqB,CAAC8B,IAAI,CAAC,CAC9C,CAAC,IAAM,CACLV,MAAM,CAACD,QAAQ,CAAC,CAChBM,KAAK,SAALA,KAAK,iBAALA,KAAK,EAAI,CACX,CACF,CAEAG,OAAO,CAAGxC,MAAM,CAACY,qBAAqB,CAAC8B,IAAI,CAAC,CAE5C,MAAO,WAAM,CACXJ,QAAQ,SAARA,QAAQ,iBAARA,QAAQ,EAAI,CACZC,QAAQ,CAAG,IAAI,CACfvC,MAAM,CAACmB,oBAAoB,CAACqB,OAAO,CAAC,CACtC,CAAC,CACH,CAAC,CAED;AACA,MAAO,IAAM,CAAAe,KAAK,CAAG,QAAR,CAAAA,KAAKA,CAChBC,KAAmB,CACnBC,IAAY,CACF,CACV,GAAI,CAACD,KAAK,CAAC5E,MAAM,EAAI6E,IAAI,CAAG,CAAC,CAAE,CAC7B,MAAO,EAAE,CACX,CACA,GAAI,CAAAC,KAAK,CAAG,CAAC,CACb,GAAI,CAAAC,QAAQ,CAAG,CAAC,CAChB,GAAM,CAAAP,MAAM,CAAGvD,KAAK,CAACyB,IAAI,CAACsC,IAAI,CAACJ,KAAK,CAAC5E,MAAM,CAAG6E,IAAI,CAAC,CAAC,CACpD,MAAOC,KAAK,CAAGF,KAAK,CAAC5E,MAAM,CAAE,CAC3BwE,MAAM,CAACO,QAAQ,EAAE,CAAC,CAAGH,KAAK,CAACpG,KAAK,CAACsG,KAAK,CAAGA,KAAK,EAAID,IAAI,CAAE,CAC1D,CACA,MAAO,CAAAL,MAAM,CACf,CAAC,CAED,MAAO,IAAM,CAAAS,UAAU,CAAG,QAAb,CAAAA,UAAUA,CAAIC,IAAa,CAAK,CAC3C,GAAM,CAAAC,SAAS,CAAG/D,MAAM,CAACgE,YAAY,EAAE,CACvC,GAAID,SAAS,CAAE,CACb,GAAM,CAAAE,KAAK,CAAGC,QAAQ,CAACC,WAAW,EAAE,CACpCF,KAAK,CAACG,kBAAkB,CAACN,IAAI,CAAC,CAC9BC,SAAS,CAACM,eAAe,EAAE,CAC3BN,SAAS,CAACO,QAAQ,CAACL,KAAK,CAAC,CAC3B,CACF,CAAC,CAED,MAAO,IAAM,CAAAM,eAAe,CAAG,QAAlB,CAAAA,eAAeA,CAAA,CAAS,CACnC,GAAM,CAAAR,SAAS,CAAG/D,MAAM,CAACgE,YAAY,EAAE,CACvC,GAAID,SAAS,CAAE,CACbA,SAAS,CAACM,eAAe,EAAE,CAC7B,CACF,CAAC,CAED,MAAO,IAAM,CAAAG,QAAQ,CAAG,QAAX,CAAAA,QAAQA,CAAIC,CAAS,CAAEC,CAAS,QAAK,CAAApD,IAAI,CAACqD,GAAG,CAACF,CAAC,CAAGC,CAAC,CAAC,GAEjE,MAAO,IAAM,CAAAE,gBAAgB,CAAG,QAAnB,CAAAA,gBAAgBA,CAC3BC,QAAsC,CACtCC,IAGmD,CACxB,CAC3B,GAAIA,IAAI,CAAClH,IAAI,GAAK,QAAQ,CAAE,CAC1B,OAAAmH,aAAA,CAAAA,aAAA,IACKF,QAAQ,CAACG,UAAU,MACtBpH,IAAI,CAAE,QAAQ,CACdqH,UAAU,CAAEH,IAAI,CAACG,UAAU,GAE/B,CAEA,OAAAF,aAAA,CAAAA,aAAA,IACKF,QAAQ,CAACG,UAAU,MACtBE,cAAc,CACZJ,IAAI,CAACK,0BAA0B,GAAKvC,SAAS,CACzCiC,QAAQ,CAACG,UAAU,CAACE,cAAc,CAClCJ,IAAI,CAACK,0BAA0B,CACrCvH,IAAI,CAAEkH,IAAI,CAAClH,IAAI,CACfqH,UAAU,CAAE,IAAI,GAEpB,CAAC,CAED,MAAO,IAAM,CAAAG,WAAW,CAAG,QAAd,CAAAA,WAAWA,CAAIC,MAAgC,CAAK,CAC/D,GAAIA,MAAM,CAAE,CACVA,MAAM,CAACC,KAAK,CAACC,MAAM,CAAG,EAAE,CAC1B,CACF,CAAC,CAED,MAAO,IAAM,CAAAC,SAAS,CAAG,QAAZ,CAAAA,SAASA,CAAIH,MAAgC,CAAEE,MAAc,CAAK,CAC7E,GAAIF,MAAM,CAAE,CACVA,MAAM,CAACC,KAAK,CAACC,MAAM,CAAGA,MAAM,CAC9B,CACF,CAAC,CAED,GAAI,CAAAE,iBAAsB,CAC1B,GAAI,CAAAC,cAAsB,CAC1B,MAAO,IAAM,CAAAC,eAAe,CAAG,QAAlB,CAAAA,eAAeA,CAC1BN,MAAgC,CAChCO,KAAwB,CACrB,CACH,GAAM,CAAAC,iBAAiB,CAAG,EAAE,CAE5B,GAAM,CAAAC,UAAU,CAAG,QAAb,CAAAA,UAAUA,CAAA,CAAS,CACvB,GAAM,CAAAC,WAAW,CAAGH,KAAK,GAAKnK,KAAK,CAACuK,IAAI,CACxCP,iBAAiB,CAAGvB,QAAQ,CAAC+B,aAAa,CAAC,QAAQ,CAAC,CACpDR,iBAAiB,CAACG,KAAK,CAAGA,KAAK,CAC/BH,iBAAiB,CAACS,MAAM,CAAGL,iBAAiB,CAC5CJ,iBAAiB,CAACU,KAAK,CAAGN,iBAAiB,CAC3C,GAAM,CAAAO,OAAO,CAAGX,iBAAiB,CAACY,UAAU,CAAC,IAAI,CAAE,CACnDD,OAAO,CAACE,SAAS,CAAG,CAAC,CACrBF,OAAO,CAACG,SAAS,EAAE,CACnBH,OAAO,CAACI,GAAG,CACTf,iBAAiB,CAACU,KAAK,CAAG,CAAC,CAC3BV,iBAAiB,CAACS,MAAM,CAAG,CAAC,CAC5B,CAAC,CACD,CAAC,CACD,CAAC,CAAG5E,IAAI,CAACmF,EAAE,CACZ,CACDL,OAAO,CAACM,SAAS,CAAGX,WAAW,CAAG7K,EAAE,CAACyL,KAAK,CAAGzL,EAAE,CAAC0L,KAAK,CACrDR,OAAO,CAACS,IAAI,EAAE,CACdT,OAAO,CAACU,WAAW,CAAGf,WAAW,CAAG7K,EAAE,CAAC0L,KAAK,CAAG1L,EAAE,CAACyL,KAAK,CACvDP,OAAO,CAACW,MAAM,EAAE,CAChBrB,cAAc,CAAGD,iBAAiB,CAACuB,SAAS,CAACxL,UAAU,CAACyL,GAAG,CAAY,CACzE,CAAC,CACD,GAAI,CAACxB,iBAAiB,EAAIA,iBAAiB,CAACG,KAAK,GAAKA,KAAK,CAAE,CAC3DE,UAAU,EAAE,CACd,CAEAN,SAAS,CACPH,MAAM,QAAA9I,MAAA,CACCmJ,cAAc,OAAAnJ,MAAA,CAAKsJ,iBAAiB,CAAG,CAAC,MAAAtJ,MAAA,CAC7CsJ,iBAAiB,CAAG,CAAC,WAExB,CACH,CAAC,CAED,MAAO,IAAM,CAAAqB,iBAAiB,CAAG,QAApB,CAAAA,iBAAiBA,CAC5B7B,MAAgC,CAChCR,QAAgD,CAC7C,CACH,GAAI,CAACQ,MAAM,CAAE,CACX,OACF,CACA,GAAIR,QAAQ,CAACG,UAAU,CAACpH,IAAI,GAAK,WAAW,CAAE,CAC5CwH,WAAW,CAACC,MAAM,CAAC,CACrB,CAAC,IAAM,IAAIxJ,gBAAgB,CAACgJ,QAAQ,CAAC,CAAE,CACrCQ,MAAM,CAACC,KAAK,CAACC,MAAM,CAAGnK,WAAW,CAAC+L,IAAI,CACxC,CAAC,IAAM,IAAIvL,cAAc,CAACiJ,QAAQ,CAAC,CAAE,CACnCc,eAAe,CAACN,MAAM,CAAER,QAAQ,CAACe,KAAK,CAAC,CACvC;AACA;AACA;AACF,CAAC,IAAM,IAAI,CAAC,CAAC,OAAO,CAAE,QAAQ,CAAC,CAACnI,QAAQ,CAACoH,QAAQ,CAACG,UAAU,CAACpH,IAAI,CAAC,CAAE,CAClEyH,MAAM,CAACC,KAAK,CAACC,MAAM,CAAGnK,WAAW,CAACgM,SAAS,CAC7C,CACF,CAAC,CAED,MAAO,IAAM,CAAAC,YAAY,CAAG,QAAf,CAAAA,YAAYA,CAAA,MAAAC,qBAAA,OACvB,EAAAA,qBAAA,CAAApD,QAAQ,CAACqD,iBAAiB,UAAAD,qBAAA,iBAA1BA,qBAAA,CAA4BE,QAAQ,IAAK,MAAM,GAEjD,MAAO,IAAM,CAAAC,eAAe,CAAG,QAAlB,CAAAA,eAAeA,CAAA,QAC1B,CAAAvD,QAAQ,CAACwD,eAAe,CAACC,iBAAiB,EAAE,GAE9C,MAAO,IAAM,CAAAC,cAAc,CAAG,QAAjB,CAAAA,cAAcA,CAAA,QAAS,CAAA1D,QAAQ,CAAC2D,cAAc,EAAE,GAE7D,MAAO,IAAM,CAAAC,cAAc,CAAG,QAAjB,CAAAA,cAAcA,CAAIC,QAAgB,CAAa,CAC1DA,QAAQ,CAAGA,QAAQ,CAChBC,OAAO,CAAC,UAAU,CAAE,KAAK,CAAC,CAC1BA,OAAO,CAAC,YAAY,CAAE,OAAO,CAAC,CAC9BA,OAAO,CAAC,qBAAqB,CAAE,OAAO,CAAC,CAC1C,GAAIzM,QAAQ,CAAE,CACZ,MAAO,CAAAwM,QAAQ,CACZC,OAAO,CAAC,iBAAiB,CAAE,KAAK,CAAC,CACjCA,OAAO,CAAC,UAAU,CAAE,QAAQ,CAAC,CAClC,CACA,MAAO,CAAAD,QAAQ,CAACC,OAAO,CAAC,iBAAiB,CAAE,MAAM,CAAC,CACpD,CAAC,CAED,MAAO,IAAM,CAAAC,2BAA2B,CAAG,QAA9B,CAAAA,2BAA2BA,CAAAC,KAAA,CAAAC,KAAA,CAenC,IAdD,CAAAC,OAAO,CAAAF,KAAA,CAAPE,OAAO,CAAEC,OAAO,CAAAH,KAAA,CAAPG,OAAO,IAEhB,CAAAC,IAAI,CAAAH,KAAA,CAAJG,IAAI,CACJC,UAAU,CAAAJ,KAAA,CAAVI,UAAU,CACVC,SAAS,CAAAL,KAAA,CAATK,SAAS,CACTC,OAAO,CAAAN,KAAA,CAAPM,OAAO,CACPC,OAAO,CAAAP,KAAA,CAAPO,OAAO,CAST,GAAM,CAAAjE,CAAC,CAAG,CAAC2D,OAAO,CAAGG,UAAU,EAAID,IAAI,CAACK,KAAK,CAAGF,OAAO,CACvD,GAAM,CAAA/D,CAAC,CAAG,CAAC2D,OAAO,CAAGG,SAAS,EAAIF,IAAI,CAACK,KAAK,CAAGD,OAAO,CAEtD,MAAO,CAAEjE,CAAC,CAADA,CAAC,CAAEC,CAAC,CAADA,CAAE,CAAC,CACjB,CAAC,CAED,MAAO,IAAM,CAAAkE,2BAA2B,CAAG,QAA9B,CAAAA,2BAA2BA,CAAAC,KAAA,CAAAC,KAAA,CAenC,IAdD,CAAAC,MAAM,CAAAF,KAAA,CAANE,MAAM,CAAEC,MAAM,CAAAH,KAAA,CAANG,MAAM,IAEd,CAAAV,IAAI,CAAAQ,KAAA,CAAJR,IAAI,CACJC,UAAU,CAAAO,KAAA,CAAVP,UAAU,CACVC,SAAS,CAAAM,KAAA,CAATN,SAAS,CACTC,OAAO,CAAAK,KAAA,CAAPL,OAAO,CACPC,OAAO,CAAAI,KAAA,CAAPJ,OAAO,CAST,GAAM,CAAAjE,CAAC,CAAG,CAACsE,MAAM,CAAGN,OAAO,EAAIH,IAAI,CAACK,KAAK,CAAGJ,UAAU,CACtD,GAAM,CAAA7D,CAAC,CAAG,CAACsE,MAAM,CAAGN,OAAO,EAAIJ,IAAI,CAACK,KAAK,CAAGH,SAAS,CACrD,MAAO,CAAE/D,CAAC,CAADA,CAAC,CAAEC,CAAC,CAADA,CAAE,CAAC,CACjB,CAAC,CAED,MAAO,IAAM,CAAAuE,oBAAoB,CAAG,QAAvB,CAAAA,oBAAoBA,CAAIC,IAAY,QAC/C,CAAAC,gBAAgB,CAACjF,QAAQ,CAACwD,eAAe,CAAC,CAAC0B,gBAAgB,MAAA7M,MAAA,CAAM2M,IAAI,EAAG,GAE1E,GAAM,CAAAG,YAAY,CAChB,+DAAyE,CACzE,yCAAyC,CAC3C,GAAM,CAAAC,YAAY,CAAG,yCAAyC,CAC9D,GAAM,CAAAC,YAAY,CAAG,GAAI,CAAAC,MAAM,OAAAjN,MAAA,CAAO8M,YAAY,QAAA9M,MAAA,CAAM+M,YAAY,MAAI,CACxE;AACA;AACA;AACA;AACA;AACA,GACA,MAAO,IAAM,CAAAG,KAAK,CAAG,QAAR,CAAAA,KAAKA,CAAIC,IAAY,QAAK,CAAAH,YAAY,CAACI,IAAI,CAACD,IAAI,CAAC,GAE9D,MAAO,IAAM,CAAAE,YAAY,CAAG,QAAf,CAAAA,YAAYA,CACvBC,OAAkC,CACL,CAC7B,IAAAC,QAAA,CAAAhL,cAAA,CAAe+K,OAAO,IAAfpF,CAAC,CAAAqF,QAAA,IAAEpF,CAAC,CAAAoF,QAAA,IACX,MAAO,CAAErF,CAAC,CAADA,CAAC,CAAEC,CAAC,CAADA,CAAE,CAAC,CACjB,CAAC,CAED,gEACA,MAAO,IAAM,CAAAqF,gBAAgB,CAAG,QAAnB,CAAAA,gBAAgBA,CAAIC,KAAa,CAAK,CACjD,GAAI,CAAAA,KAAK,SAALA,KAAK,iBAALA,KAAK,CAAEd,IAAI,IAAK,YAAY,CAAE,CAChCe,OAAO,CAACC,IAAI,CAACF,KAAK,CAAC,CACnB,OACF,CACA,KAAM,CAAAA,KAAK,CACb,CAAC,CAED,MAAO,IAAM,CAAAG,SAAS,CAAG,QAAZ,CAAAA,SAASA,CACpB3G,KAAmB,CACnB4G,EAA+D,CAE5D,IADH,CAAAC,SAAiB,CAAA1K,SAAA,CAAAf,MAAA,IAAAe,SAAA,MAAAiD,SAAA,CAAAjD,SAAA,IAAG,CAAC,CAErB,GAAI0K,SAAS,CAAG,CAAC,CAAE,CACjBA,SAAS,CAAG7G,KAAK,CAAC5E,MAAM,CAAGyL,SAAS,CACtC,CACAA,SAAS,CAAG/I,IAAI,CAACxE,GAAG,CAAC0G,KAAK,CAAC5E,MAAM,CAAE0C,IAAI,CAACgJ,GAAG,CAACD,SAAS,CAAE,CAAC,CAAC,CAAC,CAC1D,GAAI,CAAA3G,KAAK,CAAG2G,SAAS,CAAG,CAAC,CACzB,MAAO,EAAE3G,KAAK,CAAGF,KAAK,CAAC5E,MAAM,CAAE,CAC7B,GAAIwL,EAAE,CAAC5G,KAAK,CAACE,KAAK,CAAC,CAAEA,KAAK,CAAEF,KAAK,CAAC,CAAE,CAClC,MAAO,CAAAE,KAAK,CACd,CACF,CACA,MAAO,CAAC,CAAC,CACX,CAAC,CAED,MAAO,IAAM,CAAA6G,aAAa,CAAG,QAAhB,CAAAA,aAAaA,CACxB/G,KAAmB,CACnB4G,EAA+D,CAE5D,IADH,CAAAC,SAAiB,CAAA1K,SAAA,CAAAf,MAAA,IAAAe,SAAA,MAAAiD,SAAA,CAAAjD,SAAA,IAAG6D,KAAK,CAAC5E,MAAM,CAAG,CAAC,CAEpC,GAAIyL,SAAS,CAAG,CAAC,CAAE,CACjBA,SAAS,CAAG7G,KAAK,CAAC5E,MAAM,CAAGyL,SAAS,CACtC,CACAA,SAAS,CAAG/I,IAAI,CAACxE,GAAG,CAAC0G,KAAK,CAAC5E,MAAM,CAAG,CAAC,CAAE0C,IAAI,CAACgJ,GAAG,CAACD,SAAS,CAAE,CAAC,CAAC,CAAC,CAC9D,GAAI,CAAA3G,KAAK,CAAG2G,SAAS,CAAG,CAAC,CACzB,MAAO,EAAE3G,KAAK,CAAG,CAAC,CAAC,CAAE,CACnB,GAAI0G,EAAE,CAAC5G,KAAK,CAACE,KAAK,CAAC,CAAEA,KAAK,CAAEF,KAAK,CAAC,CAAE,CAClC,MAAO,CAAAE,KAAK,CACd,CACF,CACA,MAAO,CAAC,CAAC,CACX,CAAC,CAED,MAAO,IAAM,CAAA8G,aAAa,CAAG,QAAhB,CAAAA,aAAaA,CAAIC,KAAa,CAAK,CAC9C,GAAM,CAAAC,gBAAgB,CAAGD,KAAK,CAAC7L,MAAM,GAAK,CAAC,EAAI6L,KAAK,CAACE,MAAM,CAAC,CAAC,CAAE,CAAC,CAAC,GAAK,GAAG,CACzE,GAAM,CAAAC,mBAAmB,CAAGH,KAAK,CAAC7L,MAAM,GAAK,CAAC,EAAI6L,KAAK,CAACE,MAAM,CAAC,CAAC,CAAE,CAAC,CAAC,GAAK,IAAI,CAC7E,MACE,CAAAD,gBAAgB,EAChBE,mBAAmB,EACnBH,KAAK,GAAKtP,aAAa,CAAC0P,WAAW,CAEvC,CAAC,CAMD,MAAO,IAAM,CAAAC,iBAAiB,CAAG,QAApB,CAAAA,iBAAiBA,CAAA,CAAY,CACxC,GAAI,CAAAC,OAAa,CACjB,GAAI,CAAAC,MAAY,CAChB,GAAM,CAAAC,OAAO,CAAG,GAAI,CAAAC,OAAO,CAAC,SAACC,QAAQ,CAAEC,OAAO,CAAK,CACjDL,OAAO,CAAGI,QAAQ,CAClBH,MAAM,CAAGI,OAAO,CAClB,CAAC,CAAC,CACDH,OAAO,CAASF,OAAO,CAAGA,OAAO,CACjCE,OAAO,CAASD,MAAM,CAAGA,MAAM,CAChC,MAAO,CAAAC,OAAO,CAChB,CAAC,CAED;AACA;AACA,GACA,MAAO,IAAM,CAAAI,kBAAkB,CAAG,QAArB,CAAAA,kBAAkBA,CAG7BC,IAAuE,QAEtE,UAACC,KAAK,CAAK,CACV5P,uBAAuB,CAAC2P,IAAI,CAAeC,KAAK,CAAC,CACnD,CAAC,EAAc,CAEjB;AACA;AACA;AACA,GACA,MAAO,IAAM,CAAAC,2BAA2B,CAAG,QAA9B,CAAAA,2BAA2BA,CAGtCF,IAAuE,CACpE,CACH;AACA,MAAO,CAAA/K,WAAW,CAAyB,SAACgL,KAAK,CAAK,CACpD5P,uBAAuB,CAAC2P,IAAI,CAAEC,KAAK,CAAC,CACtC,CAAC,CAAe,CAClB,CAAC,CAED;AACA,MAAO,IAAM,CAAAE,UAAU,CAAG,QAAb,CAAAA,UAAUA,CAAIC,GAAW,CAAEC,MAAc,CAAa,CACjE,GAAM,CAAAC,EAAE,CAAG,CACT,CAAEjD,KAAK,CAAE,CAAC,CAAEkD,MAAM,CAAE,GAAI,CAAC,CACzB,CAAElD,KAAK,CAAE,GAAG,CAAEkD,MAAM,CAAE,GAAI,CAAC,CAC3B,CAAElD,KAAK,CAAE,GAAG,CAAEkD,MAAM,CAAE,GAAI,CAAC,CAC3B,CAAElD,KAAK,CAAE,GAAG,CAAEkD,MAAM,CAAE,GAAI,CAAC,CAC5B,CACD,GAAM,CAAAC,EAAE,CAAG,0BAA0B,CACrC,GAAI,CAAApI,KAAK,CACT,IAAKA,KAAK,CAAGkI,EAAE,CAAChN,MAAM,CAAG,CAAC,CAAE8E,KAAK,CAAG,CAAC,CAAEA,KAAK,EAAE,CAAE,CAC9C,GAAIgI,GAAG,EAAIE,EAAE,CAAClI,KAAK,CAAC,CAACiF,KAAK,CAAE,CAC1B,MACF,CACF,CACA,MACE,CAAC+C,GAAG,CAAGE,EAAE,CAAClI,KAAK,CAAC,CAACiF,KAAK,EAAEoD,OAAO,CAACJ,MAAM,CAAC,CAAC3D,OAAO,CAAC8D,EAAE,CAAE,IAAI,CAAC,CAAGF,EAAE,CAAClI,KAAK,CAAC,CAACmI,MAAM,CAEhF,CAAC,CAED,MAAO,IAAM,CAAAG,UAAU,CAAG,QAAb,CAAAA,UAAUA,CAAA,CAAS,KAAAC,qBAAA,CAC9B,MACE,EAAAA,qBAAA,CAAA/H,QAAQ,CAACgI,aAAa,CAAkB,sBAAsB,CAAC,UAAAD,qBAAA,iBAA/DA,qBAAA,CAAiEE,OAAO,GACxE9Q,eAAe,CAEnB,CAAC,CAED;AACA,MAAO,IAAM,CAAA+Q,aAAa,CAAG,QAAhB,CAAAA,aAAaA,CAAA,CAAS,CACjC,GAAM,CAAA/G,MAAM,CAAGnB,QAAQ,CAAC+B,aAAa,CAAC,QAAQ,CAAC,CAC/C,GAAM,CAAAoG,GAAG,CAAGhH,MAAM,CAACgB,UAAU,CAAC,IAAI,CAAC,CACnC,GAAI,CAACgG,GAAG,CAAE,CACR,MAAO,MAAK,CACd,CACA,GAAM,CAAAC,MAAM,CAAG,EAAE,CACjBD,GAAG,CAAC3F,SAAS,CAAG,MAAM,CACtB2F,GAAG,CAACE,YAAY,CAAG,KAAK,CACxBF,GAAG,CAACG,IAAI,CAAG,YAAY,CACvB;AACA;AACAH,GAAG,CAACI,QAAQ,CAAC,IAAI,CAAE,CAAC,CAAE,CAAC,CAAC,CACxB,MAAO,CAAAJ,GAAG,CAACK,YAAY,CAACJ,MAAM,CAAEA,MAAM,CAAE,CAAC,CAAE,CAAC,CAAC,CAACxH,IAAI,CAAC,CAAC,CAAC,GAAK,CAAC,CAC7D,CAAC,CAED,MAAO,IAAM,CAAA6H,6BAA6B,CAAG,QAAhC,CAAAA,6BAA6BA,CACxCC,OAAoB,CACO,CAC3B,GAAI,CAAAC,MAAM,CAAGD,OAAO,CAACE,aAAa,CAClC,MAAOD,MAAM,CAAE,CACb,GAAIA,MAAM,GAAK3I,QAAQ,CAAC6I,IAAI,CAAE,CAC5B,MAAO,CAAA7I,QAAQ,CACjB,CACA,IAAA8I,qBAAA,CAAsBhN,MAAM,CAACmJ,gBAAgB,CAAC0D,MAAM,CAAC,CAA7CI,SAAS,CAAAD,qBAAA,CAATC,SAAS,CACjB,GAAM,CAAAC,oBAAoB,CAAGL,MAAM,CAACM,YAAY,CAAGN,MAAM,CAACO,YAAY,CACtE,GACEF,oBAAoB,GACnBD,SAAS,GAAK,MAAM,EACnBA,SAAS,GAAK,QAAQ,EACtBA,SAAS,GAAK,SAAS,CAAC,CAC1B,CACA,MAAO,CAAAJ,MAAM,CACf,CACAA,MAAM,CAAGA,MAAM,CAACC,aAAa,CAC/B,CACA,MAAO,CAAA5I,QAAQ,CACjB,CAAC,CAED,MAAO,IAAM,CAAAmJ,kBAAkB,CAAG,QAArB,CAAAA,kBAAkBA,CAAIT,OAAyB,CAAK,CAC/D,GAAI,CAAAC,MAAM,CAAGD,OAAO,CAACE,aAAa,CAClC,MAAOD,MAAM,CAAE,CACb,GAAIA,MAAM,CAACS,QAAQ,CAAG,CAAC,CAAC,CAAE,CACxBT,MAAM,CAACU,KAAK,EAAE,CACd,OACF,CACAV,MAAM,CAAGA,MAAM,CAACC,aAAa,CAC/B,CACF,CAAC,CAED,MAAO,IAAM,CAAAU,aAAa,CAAG,QAAhB,CAAAA,aAAaA,CAAIjC,KAAwB,CAAK,CACzDA,KAAK,CAACkC,cAAc,EAAE,CACtB;AACAlC,KAAK,CAACmC,WAAW,CAAG,EAAE,CACxB,CAAC,CAED,MAAO,IAAM,CAAAC,gBAAgB,CAAG,QAAnB,CAAAA,gBAAgBA,CAAIC,KAAiB,CAAK,CACrD,MAAO,CAAA/N,KAAK,CAAC4B,IAAI,CAACmM,KAAK,CAAC,CACrBC,GAAG,CAAC,SAACC,IAAI,QAAK,IAAAvR,MAAA,CAAIuR,IAAI,CAACC,QAAQ,CAAC,EAAE,CAAC,EAAG3Q,KAAK,CAAC,CAAC,CAAC,CAAC,GAAC,CAChD4Q,IAAI,CAAC,EAAE,CAAC,CACb,CAAC,CAED,MAAO,IAAM,CAAAC,mBAAmB,CAAG,QAAtB,CAAAA,mBAAmBA,CAAA,QAAU,CAAAC,SAAS,EAAE,CAAG,CAAC,CAAG/R,IAAI,CAACgS,GAAG,EAAE,EAAC,CAEvE;AACA;AACA;AACA,GACA,MAAO,IAAM,CAAAC,UAAU,CAAG,QAAb,CAAAA,UAAUA,CACrBC,KAAmB,CAChB,CACH,MAAO,CAAAA,KAAK,CAACC,MAAM,CAAC,SAACC,GAAmB,CAAE3B,OAAO,CAAK,CACpD2B,GAAG,CAACC,GAAG,CAAC,MAAO,CAAA5B,OAAO,GAAK,QAAQ,CAAGA,OAAO,CAAGA,OAAO,CAAC5N,EAAE,CAAE4N,OAAO,CAAC,CACpE,MAAO,CAAA2B,GAAG,CACZ,CAAC,CAAE,GAAI,CAAAE,GAAG,EAAE,CAAC,CACf,CAAC,CAED,MAAO,IAAM,CAAAC,mBAAmB,CAAG,QAAtB,CAAAA,mBAAmBA,CAC9BC,QAAsB,QAEtB,CAAAA,QAAQ,CAACL,MAAM,CAAC,SAACC,GAAG,CAAE3B,OAAU,CAAEgC,GAAG,CAAK,CACxCL,GAAG,CAACC,GAAG,CAAC5B,OAAO,CAAC5N,EAAE,CAAE,CAAC4N,OAAO,CAAEgC,GAAG,CAAC,CAAC,CACnC,MAAO,CAAAL,GAAG,CACZ,CAAC,CAAE,GAAI,CAAAE,GAAG,EAAuC,CAAC,GAEpD,MAAO,IAAM,CAAAP,SAAS,CAAG,QAAZ,CAAAA,SAASA,CAAA,QAAS,CAAAnN,OAAO,CAACC,GAAG,CAACC,QAAQ,GAAK,MAAM,GAE9D,MAAO,IAAM,CAAA4N,SAAS,CAAG,QAAZ,CAAAA,SAASA,CAAqB3F,IAAW,CAAE4F,WAAc,CAAK,CACzE,MAAO,IAAI,CAAAC,WAAW,CAAC7F,IAAI,CAAE,CAC3B8F,MAAM,CAAE,CACNF,WAAW,CAAXA,WACF,CAAC,CACDG,UAAU,CAAE,IACd,CAAC,CAAC,CACJ,CAAC,CAED,MAAO,IAAM,CAAAC,YAAY,CAAG,QAAf,CAAAA,YAAYA,CACvBC,GAAM,CACNC,OAAmB,CACb,CACN,GAAI,CAAAC,SAAS,CAAG,KAAK,CACrB,IAAK,GAAM,CAAAnM,KAAG,GAAI,CAAAkM,OAAO,CAAE,CACzB,GAAM,CAAAzG,MAAK,CAAIyG,OAAO,CAASlM,KAAG,CAAC,CACnC,GAAI,MAAO,CAAAyF,MAAK,GAAK,WAAW,CAAE,CAChC,GACGwG,GAAG,CAASjM,KAAG,CAAC,GAAKyF,MAAK,GAC3B;AACC,MAAO,CAAAA,MAAK,GAAK,QAAQ,EAAIA,MAAK,GAAK,IAAI,CAAC,CAC7C,CACA,SACF,CACA0G,SAAS,CAAG,IAAI,CAClB,CACF,CAEA,GAAI,CAACA,SAAS,CAAE,CACd,MAAO,CAAAF,GAAG,CACZ,CAEA,OAAApK,aAAA,CAAAA,aAAA,IACKoK,GAAG,EACHC,OAAO,EAEd,CAAC,CAED,MAAO,IAAM,CAAAE,WAAW,CAAG,QAAd,CAAAA,WAAWA,CAAIC,GAAQ,CAAK,CACvC,GAAM,CAAA3R,IAAI,CAAG,MAAO,CAAA2R,GAAG,CACvB,MAAO,CAAAA,GAAG,EAAI,IAAI,EAAK3R,IAAI,GAAK,QAAQ,EAAIA,IAAI,GAAK,UAAW,CAClE,CAAC,CAED,MAAO,IAAM,CAAA4R,QAAQ,CAAG,QAAX,CAAAA,QAAQA,CAAA,CAAS,CAC5B,GAAI,CACF,MAAO,CAAAxP,MAAM,CAACyP,IAAI,GAAKzP,MAAM,CAAC0P,GAAG,CAAG,KAAK,CAAG,QAAQ,CACtD,CAAE,MAAO1F,KAAK,CAAE,CACd,MAAO,QAAQ,CACjB,CACF,CAAC,CAED,MAAO,IAAM,CAAA2F,iBAAiB,CAAG,QAApB,CAAAA,iBAAiBA,CAAA,QAAS,CAAAH,QAAQ,EAAE,GAAK,QAAQ,GAE9D,MAAO,IAAM,CAAAI,aAAa,CAAG,QAAhB,CAAAA,aAAaA,CACxBjH,KAAU,CACyC,CACnD,MACE,CAAC,CAACA,KAAK,EACP,MAAO,CAAAA,KAAK,GAAK,QAAQ,EACzB,MAAM,EAAI,CAAAA,KAAK,EACf,OAAO,EAAI,CAAAA,KAAK,EAChB,SAAS,EAAI,CAAAA,KAAK,CAEtB,CAAC,CAED,MAAO,IAAM,CAAAkH,sBAAsB,CAAG,QAAzB,CAAAA,sBAAsBA,CAAIC,SAA6B,CAAK,CACvE,GAAM,CAAAC,iBAAiB,CAAGD,SAAS,SAATA,SAAS,iBAATA,SAAS,CAAEE,gBAAgB,CACnD,oEAAoE,CACrE,CAED,MAAO,CAAAD,iBAAiB,CACpBlQ,KAAK,CAAC4B,IAAI,CAACsO,iBAAiB,CAAC,CAACE,MAAM,CAClC,SAACrD,OAAO,QACN,CAAAA,OAAO,CAACU,QAAQ,CAAG,CAAC,CAAC,EAAI,CAAEV,OAAO,CAAsBsD,QAAQ,GACnE,CACD,EAAE,CACR,CAAC,CAED,MAAO,IAAM,CAAAC,cAAc,CAAG,QAAjB,CAAAA,cAAcA,CAIzBC,IAAO,CACPC,IAAO,CACPC,WAAsD,CAEnD,IADH,CAAAC,KAAK,CAAA5Q,SAAA,CAAAf,MAAA,IAAAe,SAAA,MAAAiD,SAAA,CAAAjD,SAAA,IAAG,KAAK,CAEb,GAAM,CAAA6Q,KAAK,CAAG9R,MAAM,CAACsE,IAAI,CAACoN,IAAI,CAAC,CAC/B,GAAM,CAAAK,KAAK,CAAG/R,MAAM,CAACsE,IAAI,CAACqN,IAAI,CAAC,CAC/B,GAAIG,KAAK,CAAC5R,MAAM,GAAK6R,KAAK,CAAC7R,MAAM,CAAE,CACjC,MAAO,MAAK,CACd,CACA,MAAO,CAAA4R,KAAK,CAACE,KAAK,CAAC,SAACxN,GAAG,CAAK,CAC1B,GAAM,CAAAyN,UAAU,CAAGL,WAAW,SAAXA,WAAW,iBAAXA,WAAW,CAAGpN,GAAG,CAAM,CAC1C,GAAM,CAAAzD,GAAG,CAAGkR,UAAU,CAClBA,UAAU,CAACP,IAAI,CAAClN,GAAG,CAAC,CAAEmN,IAAI,CAACnN,GAAG,CAAC,CAAC,CAChCkN,IAAI,CAAClN,GAAG,CAAC,GAAKmN,IAAI,CAACnN,GAAG,CAAC,CAC3B,GAAI,CAACzD,GAAG,EAAI8Q,KAAK,CAAE,CACjBtG,OAAO,CAAC2G,IAAI,sBAAArU,MAAA,CACW2G,GAAG,kBACxB,gBAAgB,CAChBkN,IAAI,CAAClN,GAAG,CAAC,CACTmN,IAAI,CAACnN,GAAG,CAAC,CACV,CACH,CACA,MAAO,CAAAzD,GAAG,CACZ,CAAC,CAAC,CACJ,CAAC,CAED;AACA;AACA,MAAO,IAAM,CAAAoR,oBAAoB,CAAG,QAAvB,CAAAA,oBAAoBA,CAC/BC,oBAAyC,CACzCC,eAAoC,CAEjC,KAAAC,KAAA,CAAArR,SAAA,CAAAf,MAAA,IAAAe,SAAA,MAAAiD,SAAA,CAAAjD,SAAA,IADmC,CAAC,CAAC,CAAAsR,qBAAA,CAAAD,KAAA,CAAtCE,wBAAwB,CAAxBA,wBAAwB,CAAAD,qBAAA,UAAG,IAAI,CAAAA,qBAAA,CAEjC,MAAO,SAAS,CAAAE,WAAWA,CAAC5F,KAAQ,CAAE,CACpCuF,oBAAoB,SAApBA,oBAAoB,iBAApBA,oBAAoB,CAAGvF,KAAK,CAAC,CAE7B,GACE,CAAC2F,wBAAwB,EACzB,CAAE3F,KAAK,CAAsB6F,gBAAgB,CAC7C,CACA,MAAO,CAAAL,eAAe,SAAfA,eAAe,iBAAfA,eAAe,CAAGxF,KAAK,CAAC,CACjC,CACF,CAAC,CACH,CAAC,CAED,MAAO,IAAM,CAAA8F,0BAA0B,CAAG,QAA7B,CAAAA,0BAA0BA,CACrC1C,QAAgD,CAC7C,CACH,GAAM,CAAA2C,MAAM,CAAG3C,QAAQ,CAACsB,MAAM,CAAC,SAACrD,OAAO,QAAK,CAAAA,OAAO,CAAChP,IAAI,GAAK,OAAO,GAAC,CAErE,MACE,CAAA0T,MAAM,CAAC1S,MAAM,GAAK,CAAC,EACnB+P,QAAQ,CAAC+B,KAAK,CACZ,SAAC9D,OAAO,QAAK,CAAAA,OAAO,CAAChP,IAAI,GAAK,OAAO,EAAIgP,OAAO,CAACpK,OAAO,GAAK8O,MAAM,CAAC,CAAC,CAAC,CAACtS,EAAE,GAC1E,CAEL,CAAC"},"metadata":{},"sourceType":"module","externalDependencies":[]}