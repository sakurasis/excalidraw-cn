{"ast":null,"code":"import _toConsumableArray from\"D:/project/excalidraw-cn/node_modules/@babel/runtime/helpers/esm/toConsumableArray.js\";import _slicedToArray from\"D:/project/excalidraw-cn/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import{useState,useRef,useLayoutEffect}from\"react\";import{useDevice,useExcalidrawContainer}from\"../components/App\";import{useUIAppState}from\"../context/ui-appState\";export var useCreatePortalContainer=function useCreatePortalContainer(opts){var _useState=useState(null),_useState2=_slicedToArray(_useState,2),div=_useState2[0],setDiv=_useState2[1];var device=useDevice();var _useUIAppState=useUIAppState(),theme=_useUIAppState.theme;var isMobileRef=useRef(device.isMobile);isMobileRef.current=device.isMobile;var _useExcalidrawContain=useExcalidrawContainer(),excalidrawContainer=_useExcalidrawContain.container;useLayoutEffect(function(){if(div){div.classList.toggle(\"excalidraw--mobile\",device.isMobile);}},[div,device.isMobile]);useLayoutEffect(function(){var _div$classList,_opts$className;var container=opts!==null&&opts!==void 0&&opts.parentSelector?excalidrawContainer===null||excalidrawContainer===void 0?void 0:excalidrawContainer.querySelector(opts.parentSelector):document.body;if(!container){return;}var div=document.createElement(\"div\");(_div$classList=div.classList).add.apply(_div$classList,[\"excalidraw\"].concat(_toConsumableArray((opts===null||opts===void 0?void 0:(_opts$className=opts.className)===null||_opts$className===void 0?void 0:_opts$className.split(/\\s+/))||[])));div.classList.toggle(\"excalidraw--mobile\",isMobileRef.current);div.classList.toggle(\"theme--dark\",theme===\"dark\");container.appendChild(div);setDiv(div);return function(){container.removeChild(div);};},[excalidrawContainer,theme,opts===null||opts===void 0?void 0:opts.className,opts===null||opts===void 0?void 0:opts.parentSelector]);return div;};","map":{"version":3,"names":["useState","useRef","useLayoutEffect","useDevice","useExcalidrawContainer","useUIAppState","useCreatePortalContainer","opts","_useState","_useState2","_slicedToArray","div","setDiv","device","_useUIAppState","theme","isMobileRef","isMobile","current","_useExcalidrawContain","excalidrawContainer","container","classList","toggle","_div$classList","_opts$className","parentSelector","querySelector","document","body","createElement","add","apply","concat","_toConsumableArray","className","split","appendChild","removeChild"],"sources":["D:/project/excalidraw-cn/src/hooks/useCreatePortalContainer.ts"],"sourcesContent":["import { useState, useRef, useLayoutEffect } from \"react\";\nimport { useDevice, useExcalidrawContainer } from \"../components/App\";\nimport { useUIAppState } from \"../context/ui-appState\";\n\nexport const useCreatePortalContainer = (opts?: {\n  className?: string;\n  parentSelector?: string;\n}) => {\n  const [div, setDiv] = useState<HTMLDivElement | null>(null);\n\n  const device = useDevice();\n  const { theme } = useUIAppState();\n  const isMobileRef = useRef(device.isMobile);\n  isMobileRef.current = device.isMobile;\n\n  const { container: excalidrawContainer } = useExcalidrawContainer();\n\n  useLayoutEffect(() => {\n    if (div) {\n      div.classList.toggle(\"excalidraw--mobile\", device.isMobile);\n    }\n  }, [div, device.isMobile]);\n\n  useLayoutEffect(() => {\n    const container = opts?.parentSelector\n      ? excalidrawContainer?.querySelector(opts.parentSelector)\n      : document.body;\n\n    if (!container) {\n      return;\n    }\n\n    const div = document.createElement(\"div\");\n\n    div.classList.add(\"excalidraw\", ...(opts?.className?.split(/\\s+/) || []));\n    div.classList.toggle(\"excalidraw--mobile\", isMobileRef.current);\n    div.classList.toggle(\"theme--dark\", theme === \"dark\");\n\n    container.appendChild(div);\n\n    setDiv(div);\n\n    return () => {\n      container.removeChild(div);\n    };\n  }, [excalidrawContainer, theme, opts?.className, opts?.parentSelector]);\n\n  return div;\n};\n"],"mappings":"oOAAA,OAASA,QAAQ,CAAEC,MAAM,CAAEC,eAAe,KAAQ,OAAO,CACzD,OAASC,SAAS,CAAEC,sBAAsB,KAAQ,mBAAmB,CACrE,OAASC,aAAa,KAAQ,wBAAwB,CAEtD,MAAO,IAAM,CAAAC,wBAAwB,CAAG,QAA3B,CAAAA,wBAAwBA,CAAIC,IAGxC,CAAK,CACJ,IAAAC,SAAA,CAAsBR,QAAQ,CAAwB,IAAI,CAAC,CAAAS,UAAA,CAAAC,cAAA,CAAAF,SAAA,IAApDG,GAAG,CAAAF,UAAA,IAAEG,MAAM,CAAAH,UAAA,IAElB,GAAM,CAAAI,MAAM,CAAGV,SAAS,EAAE,CAC1B,IAAAW,cAAA,CAAkBT,aAAa,EAAE,CAAzBU,KAAK,CAAAD,cAAA,CAALC,KAAK,CACb,GAAM,CAAAC,WAAW,CAAGf,MAAM,CAACY,MAAM,CAACI,QAAQ,CAAC,CAC3CD,WAAW,CAACE,OAAO,CAAGL,MAAM,CAACI,QAAQ,CAErC,IAAAE,qBAAA,CAA2Cf,sBAAsB,EAAE,CAAhDgB,mBAAmB,CAAAD,qBAAA,CAA9BE,SAAS,CAEjBnB,eAAe,CAAC,UAAM,CACpB,GAAIS,GAAG,CAAE,CACPA,GAAG,CAACW,SAAS,CAACC,MAAM,CAAC,oBAAoB,CAAEV,MAAM,CAACI,QAAQ,CAAC,CAC7D,CACF,CAAC,CAAE,CAACN,GAAG,CAAEE,MAAM,CAACI,QAAQ,CAAC,CAAC,CAE1Bf,eAAe,CAAC,UAAM,KAAAsB,cAAA,CAAAC,eAAA,CACpB,GAAM,CAAAJ,SAAS,CAAGd,IAAI,SAAJA,IAAI,WAAJA,IAAI,CAAEmB,cAAc,CAClCN,mBAAmB,SAAnBA,mBAAmB,iBAAnBA,mBAAmB,CAAEO,aAAa,CAACpB,IAAI,CAACmB,cAAc,CAAC,CACvDE,QAAQ,CAACC,IAAI,CAEjB,GAAI,CAACR,SAAS,CAAE,CACd,OACF,CAEA,GAAM,CAAAV,GAAG,CAAGiB,QAAQ,CAACE,aAAa,CAAC,KAAK,CAAC,CAEzC,CAAAN,cAAA,CAAAb,GAAG,CAACW,SAAS,EAACS,GAAG,CAAAC,KAAA,CAAAR,cAAA,EAAC,YAAY,EAAAS,MAAA,CAAAC,kBAAA,CAAM,CAAA3B,IAAI,SAAJA,IAAI,kBAAAkB,eAAA,CAAJlB,IAAI,CAAE4B,SAAS,UAAAV,eAAA,iBAAfA,eAAA,CAAiBW,KAAK,CAAC,KAAK,CAAC,GAAI,EAAE,GAAE,CACzEzB,GAAG,CAACW,SAAS,CAACC,MAAM,CAAC,oBAAoB,CAAEP,WAAW,CAACE,OAAO,CAAC,CAC/DP,GAAG,CAACW,SAAS,CAACC,MAAM,CAAC,aAAa,CAAER,KAAK,GAAK,MAAM,CAAC,CAErDM,SAAS,CAACgB,WAAW,CAAC1B,GAAG,CAAC,CAE1BC,MAAM,CAACD,GAAG,CAAC,CAEX,MAAO,WAAM,CACXU,SAAS,CAACiB,WAAW,CAAC3B,GAAG,CAAC,CAC5B,CAAC,CACH,CAAC,CAAE,CAACS,mBAAmB,CAAEL,KAAK,CAAER,IAAI,SAAJA,IAAI,iBAAJA,IAAI,CAAE4B,SAAS,CAAE5B,IAAI,SAAJA,IAAI,iBAAJA,IAAI,CAAEmB,cAAc,CAAC,CAAC,CAEvE,MAAO,CAAAf,GAAG,CACZ,CAAC"},"metadata":{},"sourceType":"module","externalDependencies":[]}