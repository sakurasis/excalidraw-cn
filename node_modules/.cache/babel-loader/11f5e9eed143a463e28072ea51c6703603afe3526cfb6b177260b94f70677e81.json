{"ast":null,"code":"import _slicedToArray from\"D:/project/excalidraw-cn/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import _objectSpread from\"D:/project/excalidraw-cn/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import{ColorPicker}from\"../components/ColorPicker/ColorPicker\";import{ZoomInIcon,ZoomOutIcon}from\"../components/icons\";import{ToolButton}from\"../components/ToolButton\";import{CURSOR_TYPE,MIN_ZOOM,THEME,ZOOM_STEP}from\"../constants\";import{getCommonBounds,getNonDeletedElements}from\"../element\";import{t}from\"../i18n\";import{CODES,KEYS}from\"../keys\";import{getNormalizedZoom}from\"../scene\";import{centerScrollOn}from\"../scene/scroll\";import{getStateForZoom}from\"../scene/zoom\";import{getShortcutKey,setCursor,updateActiveTool}from\"../utils\";import{register}from\"./register\";import{Tooltip}from\"../components/Tooltip\";import{newElementWith}from\"../element/mutateElement\";import{getDefaultAppState,isEraserActive,isHandToolActive}from\"../appState\";import{DEFAULT_CANVAS_BACKGROUND_PICKS}from\"../colors\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";export var actionChangeViewBackgroundColor=register({name:\"changeViewBackgroundColor\",trackEvent:false,predicate:function predicate(elements,appState,props,app){return!!app.props.UIOptions.canvasActions.changeViewBackgroundColor&&!appState.viewModeEnabled;},perform:function perform(_,appState,value){return{appState:_objectSpread(_objectSpread({},appState),value),commitToHistory:!!value.viewBackgroundColor};},PanelComponent:function PanelComponent(_ref){var elements=_ref.elements,appState=_ref.appState,updateData=_ref.updateData,appProps=_ref.appProps;// FIXME move me to src/components/mainMenu/DefaultItems.tsx\nreturn/*#__PURE__*/_jsx(ColorPicker,{palette:null,topPicks:DEFAULT_CANVAS_BACKGROUND_PICKS,label:t(\"labels.canvasBackground\"),type:\"canvasBackground\",color:appState.viewBackgroundColor,onChange:function onChange(color){return updateData({viewBackgroundColor:color});},\"data-testid\":\"canvas-background-picker\",elements:elements,appState:appState,updateData:updateData});}});export var actionClearCanvas=register({name:\"clearCanvas\",trackEvent:{category:\"canvas\"},predicate:function predicate(elements,appState,props,app){return!!app.props.UIOptions.canvasActions.clearCanvas&&!appState.viewModeEnabled;},perform:function perform(elements,appState,_,app){app.imageCache.clear();return{elements:elements.map(function(element){return newElementWith(element,{isDeleted:true});}),appState:_objectSpread(_objectSpread({},getDefaultAppState()),{},{files:{},theme:appState.theme,penMode:appState.penMode,penDetected:appState.penDetected,exportBackground:appState.exportBackground,exportEmbedScene:appState.exportEmbedScene,gridSize:appState.gridSize,showStats:appState.showStats,pasteDialog:appState.pasteDialog,activeTool:appState.activeTool.type===\"image\"?_objectSpread(_objectSpread({},appState.activeTool),{},{type:\"selection\"}):appState.activeTool}),commitToHistory:true};}});export var actionZoomIn=register({name:\"zoomIn\",viewMode:true,trackEvent:{category:\"canvas\"},perform:function perform(_elements,appState,_,app){return{appState:_objectSpread(_objectSpread({},appState),getStateForZoom({viewportX:appState.width/2+appState.offsetLeft,viewportY:appState.height/2+appState.offsetTop,nextZoom:getNormalizedZoom(appState.zoom.value+ZOOM_STEP)},appState)),commitToHistory:false};},PanelComponent:function PanelComponent(_ref2){var updateData=_ref2.updateData;return/*#__PURE__*/_jsx(ToolButton,{type:\"button\",className:\"zoom-in-button zoom-button\",icon:ZoomInIcon,title:\"\".concat(t(\"buttons.zoomIn\"),\" \\u2014 \").concat(getShortcutKey(\"CtrlOrCmd++\")),\"aria-label\":t(\"buttons.zoomIn\"),onClick:function onClick(){updateData(null);}});},keyTest:function keyTest(event){return(event.code===CODES.EQUAL||event.code===CODES.NUM_ADD)&&(event[KEYS.CTRL_OR_CMD]||event.shiftKey);}});export var actionZoomOut=register({name:\"zoomOut\",viewMode:true,trackEvent:{category:\"canvas\"},perform:function perform(_elements,appState,_,app){return{appState:_objectSpread(_objectSpread({},appState),getStateForZoom({viewportX:appState.width/2+appState.offsetLeft,viewportY:appState.height/2+appState.offsetTop,nextZoom:getNormalizedZoom(appState.zoom.value-ZOOM_STEP)},appState)),commitToHistory:false};},PanelComponent:function PanelComponent(_ref3){var updateData=_ref3.updateData;return/*#__PURE__*/_jsx(ToolButton,{type:\"button\",className:\"zoom-out-button zoom-button\",icon:ZoomOutIcon,title:\"\".concat(t(\"buttons.zoomOut\"),\" \\u2014 \").concat(getShortcutKey(\"CtrlOrCmd+-\")),\"aria-label\":t(\"buttons.zoomOut\"),onClick:function onClick(){updateData(null);}});},keyTest:function keyTest(event){return(event.code===CODES.MINUS||event.code===CODES.NUM_SUBTRACT)&&(event[KEYS.CTRL_OR_CMD]||event.shiftKey);}});export var actionResetZoom=register({name:\"resetZoom\",viewMode:true,trackEvent:{category:\"canvas\"},perform:function perform(_elements,appState,_,app){return{appState:_objectSpread(_objectSpread({},appState),getStateForZoom({viewportX:appState.width/2+appState.offsetLeft,viewportY:appState.height/2+appState.offsetTop,nextZoom:getNormalizedZoom(1)},appState)),commitToHistory:false};},PanelComponent:function PanelComponent(_ref4){var updateData=_ref4.updateData,appState=_ref4.appState;return/*#__PURE__*/_jsx(Tooltip,{label:t(\"buttons.resetZoom\"),style:{height:\"100%\"},children:/*#__PURE__*/_jsxs(ToolButton,{type:\"button\",className:\"reset-zoom-button zoom-button\",title:t(\"buttons.resetZoom\"),\"aria-label\":t(\"buttons.resetZoom\"),onClick:function onClick(){updateData(null);},children:[(appState.zoom.value*100).toFixed(0),\"%\"]})});},keyTest:function keyTest(event){return(event.code===CODES.ZERO||event.code===CODES.NUM_ZERO)&&(event[KEYS.CTRL_OR_CMD]||event.shiftKey);}});var zoomValueToFitBoundsOnViewport=function zoomValueToFitBoundsOnViewport(bounds,viewportDimensions){var _bounds=_slicedToArray(bounds,4),x1=_bounds[0],y1=_bounds[1],x2=_bounds[2],y2=_bounds[3];var commonBoundsWidth=x2-x1;var zoomValueForWidth=viewportDimensions.width/commonBoundsWidth;var commonBoundsHeight=y2-y1;var zoomValueForHeight=viewportDimensions.height/commonBoundsHeight;var smallestZoomValue=Math.min(zoomValueForWidth,zoomValueForHeight);var zoomAdjustedToSteps=Math.floor(smallestZoomValue/ZOOM_STEP)*ZOOM_STEP;var clampedZoomValueToFitElements=Math.min(Math.max(zoomAdjustedToSteps,MIN_ZOOM),1);return clampedZoomValueToFitElements;};export var zoomToFit=function zoomToFit(_ref5){var targetElements=_ref5.targetElements,appState=_ref5.appState,_ref5$fitToViewport=_ref5.fitToViewport,fitToViewport=_ref5$fitToViewport===void 0?false:_ref5$fitToViewport,_ref5$viewportZoomFac=_ref5.viewportZoomFactor,viewportZoomFactor=_ref5$viewportZoomFac===void 0?0.7:_ref5$viewportZoomFac;var commonBounds=getCommonBounds(getNonDeletedElements(targetElements));var _commonBounds=_slicedToArray(commonBounds,4),x1=_commonBounds[0],y1=_commonBounds[1],x2=_commonBounds[2],y2=_commonBounds[3];var centerX=(x1+x2)/2;var centerY=(y1+y2)/2;var newZoomValue;var scrollX;var scrollY;if(fitToViewport){var commonBoundsWidth=x2-x1;var commonBoundsHeight=y2-y1;newZoomValue=Math.min(appState.width/commonBoundsWidth,appState.height/commonBoundsHeight)*Math.min(1,Math.max(viewportZoomFactor,0.1));// Apply clamping to newZoomValue to be between 10% and 3000%\nnewZoomValue=Math.min(Math.max(newZoomValue,0.1),30.0);scrollX=appState.width/2*(1/newZoomValue)-centerX;scrollY=appState.height/2*(1/newZoomValue)-centerY;}else{newZoomValue=zoomValueToFitBoundsOnViewport(commonBounds,{width:appState.width,height:appState.height});var centerScroll=centerScrollOn({scenePoint:{x:centerX,y:centerY},viewportDimensions:{width:appState.width,height:appState.height},zoom:{value:newZoomValue}});scrollX=centerScroll.scrollX;scrollY=centerScroll.scrollY;}return{appState:_objectSpread(_objectSpread({},appState),{},{scrollX:scrollX,scrollY:scrollY,zoom:{value:newZoomValue}}),commitToHistory:false};};// Note, this action differs from actionZoomToFitSelection in that it doesn't\n// zoom beyond 100%. In other words, if the content is smaller than viewport\n// size, it won't be zoomed in.\nexport var actionZoomToFitSelectionInViewport=register({name:\"zoomToFitSelectionInViewport\",trackEvent:{category:\"canvas\"},perform:function perform(elements,appState,_,app){var selectedElements=app.scene.getSelectedElements(appState);return zoomToFit({targetElements:selectedElements.length?selectedElements:elements,appState:appState,fitToViewport:false});},// NOTE shift-2 should have been assigned actionZoomToFitSelection.\n// TBD on how proceed\nkeyTest:function keyTest(event){return event.code===CODES.TWO&&event.shiftKey&&!event.altKey&&!event[KEYS.CTRL_OR_CMD];}});export var actionZoomToFitSelection=register({name:\"zoomToFitSelection\",trackEvent:{category:\"canvas\"},perform:function perform(elements,appState,_,app){var selectedElements=app.scene.getSelectedElements(appState);return zoomToFit({targetElements:selectedElements.length?selectedElements:elements,appState:appState,fitToViewport:true});},// NOTE this action should use shift-2 per figma, alas\nkeyTest:function keyTest(event){return event.code===CODES.THREE&&event.shiftKey&&!event.altKey&&!event[KEYS.CTRL_OR_CMD];}});export var actionZoomToFit=register({name:\"zoomToFit\",viewMode:true,trackEvent:{category:\"canvas\"},perform:function perform(elements,appState){return zoomToFit({targetElements:elements,appState:appState,fitToViewport:false});},keyTest:function keyTest(event){return event.code===CODES.ONE&&event.shiftKey&&!event.altKey&&!event[KEYS.CTRL_OR_CMD];}});export var actionToggleTheme=register({name:\"toggleTheme\",viewMode:true,trackEvent:{category:\"canvas\"},perform:function perform(_,appState,value){return{appState:_objectSpread(_objectSpread({},appState),{},{theme:value||(appState.theme===THEME.LIGHT?THEME.DARK:THEME.LIGHT)}),commitToHistory:false};},keyTest:function keyTest(event){return event.altKey&&event.shiftKey&&event.code===CODES.D;},predicate:function predicate(elements,appState,props,app){return!!app.props.UIOptions.canvasActions.toggleTheme;}});export var actionToggleEraserTool=register({name:\"toggleEraserTool\",trackEvent:{category:\"toolbar\"},perform:function perform(elements,appState){var activeTool;if(isEraserActive(appState)){activeTool=updateActiveTool(appState,_objectSpread(_objectSpread({},appState.activeTool.lastActiveTool||{type:\"selection\"}),{},{lastActiveToolBeforeEraser:null}));}else{activeTool=updateActiveTool(appState,{type:\"eraser\",lastActiveToolBeforeEraser:appState.activeTool});}return{appState:_objectSpread(_objectSpread({},appState),{},{selectedElementIds:{},selectedGroupIds:{},activeTool:activeTool}),commitToHistory:true};},keyTest:function keyTest(event){return event.key===KEYS.E;}});export var actionToggleHandTool=register({name:\"toggleHandTool\",trackEvent:{category:\"toolbar\"},perform:function perform(elements,appState,_,app){var activeTool;if(isHandToolActive(appState)){activeTool=updateActiveTool(appState,_objectSpread(_objectSpread({},appState.activeTool.lastActiveTool||{type:\"selection\"}),{},{lastActiveToolBeforeEraser:null}));}else{activeTool=updateActiveTool(appState,{type:\"hand\",lastActiveToolBeforeEraser:appState.activeTool});setCursor(app.canvas,CURSOR_TYPE.GRAB);}return{appState:_objectSpread(_objectSpread({},appState),{},{selectedElementIds:{},selectedGroupIds:{},activeTool:activeTool}),commitToHistory:true};},keyTest:function keyTest(event){return event.key===KEYS.H;}});","map":{"version":3,"names":["ColorPicker","ZoomInIcon","ZoomOutIcon","ToolButton","CURSOR_TYPE","MIN_ZOOM","THEME","ZOOM_STEP","getCommonBounds","getNonDeletedElements","t","CODES","KEYS","getNormalizedZoom","centerScrollOn","getStateForZoom","getShortcutKey","setCursor","updateActiveTool","register","Tooltip","newElementWith","getDefaultAppState","isEraserActive","isHandToolActive","DEFAULT_CANVAS_BACKGROUND_PICKS","jsx","_jsx","jsxs","_jsxs","actionChangeViewBackgroundColor","name","trackEvent","predicate","elements","appState","props","app","UIOptions","canvasActions","changeViewBackgroundColor","viewModeEnabled","perform","_","value","_objectSpread","commitToHistory","viewBackgroundColor","PanelComponent","_ref","updateData","appProps","palette","topPicks","label","type","color","onChange","actionClearCanvas","category","clearCanvas","imageCache","clear","map","element","isDeleted","files","theme","penMode","penDetected","exportBackground","exportEmbedScene","gridSize","showStats","pasteDialog","activeTool","actionZoomIn","viewMode","_elements","viewportX","width","offsetLeft","viewportY","height","offsetTop","nextZoom","zoom","_ref2","className","icon","title","concat","onClick","keyTest","event","code","EQUAL","NUM_ADD","CTRL_OR_CMD","shiftKey","actionZoomOut","_ref3","MINUS","NUM_SUBTRACT","actionResetZoom","_ref4","style","children","toFixed","ZERO","NUM_ZERO","zoomValueToFitBoundsOnViewport","bounds","viewportDimensions","_bounds","_slicedToArray","x1","y1","x2","y2","commonBoundsWidth","zoomValueForWidth","commonBoundsHeight","zoomValueForHeight","smallestZoomValue","Math","min","zoomAdjustedToSteps","floor","clampedZoomValueToFitElements","max","zoomToFit","_ref5","targetElements","_ref5$fitToViewport","fitToViewport","_ref5$viewportZoomFac","viewportZoomFactor","commonBounds","_commonBounds","centerX","centerY","newZoomValue","scrollX","scrollY","centerScroll","scenePoint","x","y","actionZoomToFitSelectionInViewport","selectedElements","scene","getSelectedElements","length","TWO","altKey","actionZoomToFitSelection","THREE","actionZoomToFit","ONE","actionToggleTheme","LIGHT","DARK","D","toggleTheme","actionToggleEraserTool","lastActiveTool","lastActiveToolBeforeEraser","selectedElementIds","selectedGroupIds","key","E","actionToggleHandTool","canvas","GRAB","H"],"sources":["D:/project/excalidraw-cn/src/actions/actionCanvas.tsx"],"sourcesContent":["import { ColorPicker } from \"../components/ColorPicker/ColorPicker\";\nimport { ZoomInIcon, ZoomOutIcon } from \"../components/icons\";\nimport { ToolButton } from \"../components/ToolButton\";\nimport { CURSOR_TYPE, MIN_ZOOM, THEME, ZOOM_STEP } from \"../constants\";\nimport { getCommonBounds, getNonDeletedElements } from \"../element\";\nimport { ExcalidrawElement } from \"../element/types\";\nimport { t } from \"../i18n\";\nimport { CODES, KEYS } from \"../keys\";\nimport { getNormalizedZoom } from \"../scene\";\nimport { centerScrollOn } from \"../scene/scroll\";\nimport { getStateForZoom } from \"../scene/zoom\";\nimport { AppState, NormalizedZoomValue } from \"../types\";\nimport { getShortcutKey, setCursor, updateActiveTool } from \"../utils\";\nimport { register } from \"./register\";\nimport { Tooltip } from \"../components/Tooltip\";\nimport { newElementWith } from \"../element/mutateElement\";\nimport {\n  getDefaultAppState,\n  isEraserActive,\n  isHandToolActive,\n} from \"../appState\";\nimport { DEFAULT_CANVAS_BACKGROUND_PICKS } from \"../colors\";\nimport { Bounds } from \"../element/bounds\";\n\nexport const actionChangeViewBackgroundColor = register({\n  name: \"changeViewBackgroundColor\",\n  trackEvent: false,\n  predicate: (elements, appState, props, app) => {\n    return (\n      !!app.props.UIOptions.canvasActions.changeViewBackgroundColor &&\n      !appState.viewModeEnabled\n    );\n  },\n  perform: (_, appState, value) => {\n    return {\n      appState: { ...appState, ...value },\n      commitToHistory: !!value.viewBackgroundColor,\n    };\n  },\n  PanelComponent: ({ elements, appState, updateData, appProps }) => {\n    // FIXME move me to src/components/mainMenu/DefaultItems.tsx\n    return (\n      <ColorPicker\n        palette={null}\n        topPicks={DEFAULT_CANVAS_BACKGROUND_PICKS}\n        label={t(\"labels.canvasBackground\")}\n        type=\"canvasBackground\"\n        color={appState.viewBackgroundColor}\n        onChange={(color) => updateData({ viewBackgroundColor: color })}\n        data-testid=\"canvas-background-picker\"\n        elements={elements}\n        appState={appState}\n        updateData={updateData}\n      />\n    );\n  },\n});\n\nexport const actionClearCanvas = register({\n  name: \"clearCanvas\",\n  trackEvent: { category: \"canvas\" },\n  predicate: (elements, appState, props, app) => {\n    return (\n      !!app.props.UIOptions.canvasActions.clearCanvas &&\n      !appState.viewModeEnabled\n    );\n  },\n  perform: (elements, appState, _, app) => {\n    app.imageCache.clear();\n    return {\n      elements: elements.map((element) =>\n        newElementWith(element, { isDeleted: true }),\n      ),\n      appState: {\n        ...getDefaultAppState(),\n        files: {},\n        theme: appState.theme,\n        penMode: appState.penMode,\n        penDetected: appState.penDetected,\n        exportBackground: appState.exportBackground,\n        exportEmbedScene: appState.exportEmbedScene,\n        gridSize: appState.gridSize,\n        showStats: appState.showStats,\n        pasteDialog: appState.pasteDialog,\n        activeTool:\n          appState.activeTool.type === \"image\"\n            ? { ...appState.activeTool, type: \"selection\" }\n            : appState.activeTool,\n      },\n      commitToHistory: true,\n    };\n  },\n});\n\nexport const actionZoomIn = register({\n  name: \"zoomIn\",\n  viewMode: true,\n  trackEvent: { category: \"canvas\" },\n  perform: (_elements, appState, _, app) => {\n    return {\n      appState: {\n        ...appState,\n        ...getStateForZoom(\n          {\n            viewportX: appState.width / 2 + appState.offsetLeft,\n            viewportY: appState.height / 2 + appState.offsetTop,\n            nextZoom: getNormalizedZoom(appState.zoom.value + ZOOM_STEP),\n          },\n          appState,\n        ),\n      },\n      commitToHistory: false,\n    };\n  },\n  PanelComponent: ({ updateData }) => (\n    <ToolButton\n      type=\"button\"\n      className=\"zoom-in-button zoom-button\"\n      icon={ZoomInIcon}\n      title={`${t(\"buttons.zoomIn\")} — ${getShortcutKey(\"CtrlOrCmd++\")}`}\n      aria-label={t(\"buttons.zoomIn\")}\n      onClick={() => {\n        updateData(null);\n      }}\n    />\n  ),\n  keyTest: (event) =>\n    (event.code === CODES.EQUAL || event.code === CODES.NUM_ADD) &&\n    (event[KEYS.CTRL_OR_CMD] || event.shiftKey),\n});\n\nexport const actionZoomOut = register({\n  name: \"zoomOut\",\n  viewMode: true,\n  trackEvent: { category: \"canvas\" },\n  perform: (_elements, appState, _, app) => {\n    return {\n      appState: {\n        ...appState,\n        ...getStateForZoom(\n          {\n            viewportX: appState.width / 2 + appState.offsetLeft,\n            viewportY: appState.height / 2 + appState.offsetTop,\n            nextZoom: getNormalizedZoom(appState.zoom.value - ZOOM_STEP),\n          },\n          appState,\n        ),\n      },\n      commitToHistory: false,\n    };\n  },\n  PanelComponent: ({ updateData }) => (\n    <ToolButton\n      type=\"button\"\n      className=\"zoom-out-button zoom-button\"\n      icon={ZoomOutIcon}\n      title={`${t(\"buttons.zoomOut\")} — ${getShortcutKey(\"CtrlOrCmd+-\")}`}\n      aria-label={t(\"buttons.zoomOut\")}\n      onClick={() => {\n        updateData(null);\n      }}\n    />\n  ),\n  keyTest: (event) =>\n    (event.code === CODES.MINUS || event.code === CODES.NUM_SUBTRACT) &&\n    (event[KEYS.CTRL_OR_CMD] || event.shiftKey),\n});\n\nexport const actionResetZoom = register({\n  name: \"resetZoom\",\n  viewMode: true,\n  trackEvent: { category: \"canvas\" },\n  perform: (_elements, appState, _, app) => {\n    return {\n      appState: {\n        ...appState,\n        ...getStateForZoom(\n          {\n            viewportX: appState.width / 2 + appState.offsetLeft,\n            viewportY: appState.height / 2 + appState.offsetTop,\n            nextZoom: getNormalizedZoom(1),\n          },\n          appState,\n        ),\n      },\n      commitToHistory: false,\n    };\n  },\n  PanelComponent: ({ updateData, appState }) => (\n    <Tooltip label={t(\"buttons.resetZoom\")} style={{ height: \"100%\" }}>\n      <ToolButton\n        type=\"button\"\n        className=\"reset-zoom-button zoom-button\"\n        title={t(\"buttons.resetZoom\")}\n        aria-label={t(\"buttons.resetZoom\")}\n        onClick={() => {\n          updateData(null);\n        }}\n      >\n        {(appState.zoom.value * 100).toFixed(0)}%\n      </ToolButton>\n    </Tooltip>\n  ),\n  keyTest: (event) =>\n    (event.code === CODES.ZERO || event.code === CODES.NUM_ZERO) &&\n    (event[KEYS.CTRL_OR_CMD] || event.shiftKey),\n});\n\nconst zoomValueToFitBoundsOnViewport = (\n  bounds: Bounds,\n  viewportDimensions: { width: number; height: number },\n) => {\n  const [x1, y1, x2, y2] = bounds;\n  const commonBoundsWidth = x2 - x1;\n  const zoomValueForWidth = viewportDimensions.width / commonBoundsWidth;\n  const commonBoundsHeight = y2 - y1;\n  const zoomValueForHeight = viewportDimensions.height / commonBoundsHeight;\n  const smallestZoomValue = Math.min(zoomValueForWidth, zoomValueForHeight);\n  const zoomAdjustedToSteps =\n    Math.floor(smallestZoomValue / ZOOM_STEP) * ZOOM_STEP;\n  const clampedZoomValueToFitElements = Math.min(\n    Math.max(zoomAdjustedToSteps, MIN_ZOOM),\n    1,\n  );\n  return clampedZoomValueToFitElements as NormalizedZoomValue;\n};\n\nexport const zoomToFit = ({\n  targetElements,\n  appState,\n  fitToViewport = false,\n  viewportZoomFactor = 0.7,\n}: {\n  targetElements: readonly ExcalidrawElement[];\n  appState: Readonly<AppState>;\n  /** whether to fit content to viewport (beyond >100%) */\n  fitToViewport: boolean;\n  /** zoom content to cover X of the viewport, when fitToViewport=true */\n  viewportZoomFactor?: number;\n}) => {\n  const commonBounds = getCommonBounds(getNonDeletedElements(targetElements));\n\n  const [x1, y1, x2, y2] = commonBounds;\n  const centerX = (x1 + x2) / 2;\n  const centerY = (y1 + y2) / 2;\n\n  let newZoomValue;\n  let scrollX;\n  let scrollY;\n\n  if (fitToViewport) {\n    const commonBoundsWidth = x2 - x1;\n    const commonBoundsHeight = y2 - y1;\n\n    newZoomValue =\n      Math.min(\n        appState.width / commonBoundsWidth,\n        appState.height / commonBoundsHeight,\n      ) * Math.min(1, Math.max(viewportZoomFactor, 0.1));\n\n    // Apply clamping to newZoomValue to be between 10% and 3000%\n    newZoomValue = Math.min(\n      Math.max(newZoomValue, 0.1),\n      30.0,\n    ) as NormalizedZoomValue;\n\n    scrollX = (appState.width / 2) * (1 / newZoomValue) - centerX;\n    scrollY = (appState.height / 2) * (1 / newZoomValue) - centerY;\n  } else {\n    newZoomValue = zoomValueToFitBoundsOnViewport(commonBounds, {\n      width: appState.width,\n      height: appState.height,\n    });\n\n    const centerScroll = centerScrollOn({\n      scenePoint: { x: centerX, y: centerY },\n      viewportDimensions: {\n        width: appState.width,\n        height: appState.height,\n      },\n      zoom: { value: newZoomValue },\n    });\n\n    scrollX = centerScroll.scrollX;\n    scrollY = centerScroll.scrollY;\n  }\n\n  return {\n    appState: {\n      ...appState,\n      scrollX,\n      scrollY,\n      zoom: { value: newZoomValue },\n    },\n    commitToHistory: false,\n  };\n};\n\n// Note, this action differs from actionZoomToFitSelection in that it doesn't\n// zoom beyond 100%. In other words, if the content is smaller than viewport\n// size, it won't be zoomed in.\nexport const actionZoomToFitSelectionInViewport = register({\n  name: \"zoomToFitSelectionInViewport\",\n  trackEvent: { category: \"canvas\" },\n  perform: (elements, appState, _, app) => {\n    const selectedElements = app.scene.getSelectedElements(appState);\n    return zoomToFit({\n      targetElements: selectedElements.length ? selectedElements : elements,\n      appState,\n      fitToViewport: false,\n    });\n  },\n  // NOTE shift-2 should have been assigned actionZoomToFitSelection.\n  // TBD on how proceed\n  keyTest: (event) =>\n    event.code === CODES.TWO &&\n    event.shiftKey &&\n    !event.altKey &&\n    !event[KEYS.CTRL_OR_CMD],\n});\n\nexport const actionZoomToFitSelection = register({\n  name: \"zoomToFitSelection\",\n  trackEvent: { category: \"canvas\" },\n  perform: (elements, appState, _, app) => {\n    const selectedElements = app.scene.getSelectedElements(appState);\n    return zoomToFit({\n      targetElements: selectedElements.length ? selectedElements : elements,\n      appState,\n      fitToViewport: true,\n    });\n  },\n  // NOTE this action should use shift-2 per figma, alas\n  keyTest: (event) =>\n    event.code === CODES.THREE &&\n    event.shiftKey &&\n    !event.altKey &&\n    !event[KEYS.CTRL_OR_CMD],\n});\n\nexport const actionZoomToFit = register({\n  name: \"zoomToFit\",\n  viewMode: true,\n  trackEvent: { category: \"canvas\" },\n  perform: (elements, appState) =>\n    zoomToFit({ targetElements: elements, appState, fitToViewport: false }),\n  keyTest: (event) =>\n    event.code === CODES.ONE &&\n    event.shiftKey &&\n    !event.altKey &&\n    !event[KEYS.CTRL_OR_CMD],\n});\n\nexport const actionToggleTheme = register({\n  name: \"toggleTheme\",\n  viewMode: true,\n  trackEvent: { category: \"canvas\" },\n  perform: (_, appState, value) => {\n    return {\n      appState: {\n        ...appState,\n        theme:\n          value || (appState.theme === THEME.LIGHT ? THEME.DARK : THEME.LIGHT),\n      },\n      commitToHistory: false,\n    };\n  },\n  keyTest: (event) => event.altKey && event.shiftKey && event.code === CODES.D,\n  predicate: (elements, appState, props, app) => {\n    return !!app.props.UIOptions.canvasActions.toggleTheme;\n  },\n});\n\nexport const actionToggleEraserTool = register({\n  name: \"toggleEraserTool\",\n  trackEvent: { category: \"toolbar\" },\n  perform: (elements, appState) => {\n    let activeTool: AppState[\"activeTool\"];\n\n    if (isEraserActive(appState)) {\n      activeTool = updateActiveTool(appState, {\n        ...(appState.activeTool.lastActiveTool || {\n          type: \"selection\",\n        }),\n        lastActiveToolBeforeEraser: null,\n      });\n    } else {\n      activeTool = updateActiveTool(appState, {\n        type: \"eraser\",\n        lastActiveToolBeforeEraser: appState.activeTool,\n      });\n    }\n\n    return {\n      appState: {\n        ...appState,\n        selectedElementIds: {},\n        selectedGroupIds: {},\n        activeTool,\n      },\n      commitToHistory: true,\n    };\n  },\n  keyTest: (event) => event.key === KEYS.E,\n});\n\nexport const actionToggleHandTool = register({\n  name: \"toggleHandTool\",\n  trackEvent: { category: \"toolbar\" },\n  perform: (elements, appState, _, app) => {\n    let activeTool: AppState[\"activeTool\"];\n\n    if (isHandToolActive(appState)) {\n      activeTool = updateActiveTool(appState, {\n        ...(appState.activeTool.lastActiveTool || {\n          type: \"selection\",\n        }),\n        lastActiveToolBeforeEraser: null,\n      });\n    } else {\n      activeTool = updateActiveTool(appState, {\n        type: \"hand\",\n        lastActiveToolBeforeEraser: appState.activeTool,\n      });\n      setCursor(app.canvas, CURSOR_TYPE.GRAB);\n    }\n\n    return {\n      appState: {\n        ...appState,\n        selectedElementIds: {},\n        selectedGroupIds: {},\n        activeTool,\n      },\n      commitToHistory: true,\n    };\n  },\n  keyTest: (event) => event.key === KEYS.H,\n});\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}