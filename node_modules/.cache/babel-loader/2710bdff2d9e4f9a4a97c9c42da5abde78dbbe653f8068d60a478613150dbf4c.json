{"ast":null,"code":"import _objectWithoutProperties from\"D:/project/excalidraw-cn/node_modules/@babel/runtime/helpers/esm/objectWithoutProperties.js\";import _objectSpread from\"D:/project/excalidraw-cn/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import _slicedToArray from\"D:/project/excalidraw-cn/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";var _excluded=[\"suggestedBindings\",\"startBoundElement\",\"cursorButton\",\"scrollX\",\"scrollY\"],_excluded2=[\"canvas\",\"appState\"],_excluded3=[\"canvas\",\"appState\"];import clsx from\"clsx\";import React from\"react\";import{CLASSES,DEFAULT_SIDEBAR,LIBRARY_SIDEBAR_WIDTH}from\"../constants\";import{isTextElement,showSelectedShapeActions}from\"../element\";import{t}from\"../i18n\";import{calculateScrollCenter}from\"../scene\";import{capitalizeString,isShallowEqual}from\"../utils\";import{SelectedShapeActions,ShapesSwitcher}from\"./Actions\";import{ErrorDialog}from\"./ErrorDialog\";import{ImageExportDialog}from\"./ImageExportDialog\";import{FixedSideContainer}from\"./FixedSideContainer\";import{HintViewer}from\"./HintViewer\";import{Island}from\"./Island\";import{LoadingMessage}from\"./LoadingMessage\";import{LockButton}from\"./LockButton\";import{MobileMenu}from\"./MobileMenu\";import{PasteChartDialog}from\"./PasteChartDialog\";import{Section}from\"./Section\";import{HelpDialog}from\"./HelpDialog\";import Stack from\"./Stack\";import{UserList}from\"./UserList\";import{JSONExportDialog}from\"./JSONExportDialog\";import{PenModeButton}from\"./PenModeButton\";import{trackEvent}from\"../analytics\";import{useDevice}from\"../components/App\";import{Stats}from\"./Stats\";import{actionToggleStats}from\"../actions/actionToggleStats\";import Footer from\"./footer/Footer\";import{isSidebarDockedAtom}from\"./Sidebar/Sidebar\";import{jotaiScope}from\"../jotai\";import{Provider,useAtom,useAtomValue}from\"jotai\";import MainMenu from\"./main-menu/MainMenu\";import{ActiveConfirmDialog}from\"./ActiveConfirmDialog\";import{OverwriteConfirmDialog}from\"./OverwriteConfirm/OverwriteConfirm\";import{HandButton}from\"./HandButton\";import{isHandToolActive}from\"../appState\";import{TunnelsContext,useInitializeTunnels}from\"../context/tunnels\";import{LibraryIcon}from\"./icons\";import{UIAppStateContext}from\"../context/ui-appState\";import{DefaultSidebar}from\"./DefaultSidebar\";import{EyeDropper,activeEyeDropperAtom}from\"./EyeDropper\";import\"./LayerUI.scss\";import\"./Toolbar.scss\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";var DefaultMainMenu=function DefaultMainMenu(_ref){var UIOptions=_ref.UIOptions;return/*#__PURE__*/_jsxs(MainMenu,{__fallback:true,children:[/*#__PURE__*/_jsx(MainMenu.DefaultItems.LoadScene,{}),/*#__PURE__*/_jsx(MainMenu.DefaultItems.SaveToActiveFile,{}),UIOptions.canvasActions.export&&/*#__PURE__*/_jsx(MainMenu.DefaultItems.Export,{}),UIOptions.canvasActions.saveAsImage&&/*#__PURE__*/_jsx(MainMenu.DefaultItems.SaveAsImage,{}),/*#__PURE__*/_jsx(MainMenu.DefaultItems.Help,{}),/*#__PURE__*/_jsx(MainMenu.DefaultItems.ClearCanvas,{}),/*#__PURE__*/_jsx(MainMenu.Separator,{}),/*#__PURE__*/_jsx(MainMenu.Group,{title:\"Excalidraw links\",children:/*#__PURE__*/_jsx(MainMenu.DefaultItems.Socials,{})}),/*#__PURE__*/_jsx(MainMenu.Separator,{}),/*#__PURE__*/_jsx(MainMenu.DefaultItems.ToggleTheme,{}),/*#__PURE__*/_jsx(MainMenu.DefaultItems.ChangeCanvasBackground,{})]});};var DefaultOverwriteConfirmDialog=function DefaultOverwriteConfirmDialog(){return/*#__PURE__*/_jsxs(OverwriteConfirmDialog,{__fallback:true,children:[/*#__PURE__*/_jsx(OverwriteConfirmDialog.Actions.SaveToDisk,{}),/*#__PURE__*/_jsx(OverwriteConfirmDialog.Actions.ExportToImage,{})]});};var LayerUI=function LayerUI(_ref2){var actionManager=_ref2.actionManager,appState=_ref2.appState,files=_ref2.files,setAppState=_ref2.setAppState,elements=_ref2.elements,canvas=_ref2.canvas,onLockToggle=_ref2.onLockToggle,onHandToolToggle=_ref2.onHandToolToggle,onPenModeToggle=_ref2.onPenModeToggle,showExitZenModeBtn=_ref2.showExitZenModeBtn,renderTopRightUI=_ref2.renderTopRightUI,renderCustomStats=_ref2.renderCustomStats,UIOptions=_ref2.UIOptions,_onImageAction=_ref2.onImageAction,onExportImage=_ref2.onExportImage,renderWelcomeScreen=_ref2.renderWelcomeScreen,children=_ref2.children,app=_ref2.app;var device=useDevice();var tunnels=useInitializeTunnels();var _useAtom=useAtom(activeEyeDropperAtom,jotaiScope),_useAtom2=_slicedToArray(_useAtom,2),eyeDropperState=_useAtom2[0],setEyeDropperState=_useAtom2[1];var renderJSONExportDialog=function renderJSONExportDialog(){if(!UIOptions.canvasActions.export){return null;}return/*#__PURE__*/_jsx(JSONExportDialog,{elements:elements,appState:appState,files:files,actionManager:actionManager,exportOpts:UIOptions.canvasActions.export,canvas:canvas,setAppState:setAppState});};var renderImageExportDialog=function renderImageExportDialog(){if(!UIOptions.canvasActions.saveAsImage){return null;}return/*#__PURE__*/_jsx(ImageExportDialog,{elements:elements,appState:appState,files:files,actionManager:actionManager,onExportImage:onExportImage,onCloseRequest:function onCloseRequest(){return setAppState({openDialog:null});}});};var renderCanvasActions=function renderCanvasActions(){return/*#__PURE__*/_jsxs(\"div\",{style:{position:\"relative\"},children:[/*#__PURE__*/_jsx(tunnels.MainMenuTunnel.Out,{}),renderWelcomeScreen&&/*#__PURE__*/_jsx(tunnels.WelcomeScreenMenuHintTunnel.Out,{})]});};var renderSelectedShapeActions=function renderSelectedShapeActions(){return/*#__PURE__*/_jsx(Section,{heading:\"selectedShapeActions\",className:clsx(\"selected-shape-actions zen-mode-transition\",{\"transition-left\":appState.zenModeEnabled}),children:/*#__PURE__*/_jsx(Island,{className:CLASSES.SHAPE_ACTIONS_MENU,padding:2,style:{// we want to make sure this doesn't overflow so subtracting the\n// approximate height of hamburgerMenu + footer\nmaxHeight:\"\".concat(appState.height-166,\"px\")},children:/*#__PURE__*/_jsx(SelectedShapeActions,{appState:appState,elements:elements,renderAction:actionManager.renderAction})})});};var renderFixedSideContainer=function renderFixedSideContainer(){var _appState$openSidebar;var shouldRenderSelectedShapeActions=showSelectedShapeActions(appState,elements);return/*#__PURE__*/_jsx(FixedSideContainer,{side:\"top\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"App-menu App-menu_top\",children:[/*#__PURE__*/_jsxs(Stack.Col,{gap:6,className:clsx(\"App-menu_top__left\"),children:[renderCanvasActions(),shouldRenderSelectedShapeActions&&renderSelectedShapeActions()]}),!appState.viewModeEnabled&&/*#__PURE__*/_jsx(Section,{heading:\"shapes\",className:\"shapes-section\",children:function children(heading){return/*#__PURE__*/_jsxs(\"div\",{style:{position:\"relative\"},children:[renderWelcomeScreen&&/*#__PURE__*/_jsx(tunnels.WelcomeScreenToolbarHintTunnel.Out,{}),/*#__PURE__*/_jsx(Stack.Col,{gap:4,align:\"start\",children:/*#__PURE__*/_jsx(Stack.Row,{gap:1,className:clsx(\"App-toolbar-container\",{\"zen-mode\":appState.zenModeEnabled}),children:/*#__PURE__*/_jsxs(Island,{padding:1,className:clsx(\"App-toolbar\",{\"zen-mode\":appState.zenModeEnabled}),children:[/*#__PURE__*/_jsx(HintViewer,{appState:appState,isMobile:device.isMobile,device:device,app:app}),heading,/*#__PURE__*/_jsxs(Stack.Row,{gap:1,children:[/*#__PURE__*/_jsx(PenModeButton,{zenModeEnabled:appState.zenModeEnabled,checked:appState.penMode,onChange:onPenModeToggle,title:t(\"toolBar.penMode\"),penDetected:appState.penDetected}),/*#__PURE__*/_jsx(LockButton,{checked:appState.activeTool.locked,onChange:onLockToggle,title:t(\"toolBar.lock\")}),/*#__PURE__*/_jsx(\"div\",{className:\"App-toolbar__divider\"}),/*#__PURE__*/_jsx(HandButton,{checked:isHandToolActive(appState),onChange:function onChange(){return onHandToolToggle();},title:t(\"toolBar.hand\"),isMobile:true}),/*#__PURE__*/_jsx(ShapesSwitcher,{appState:appState,canvas:canvas,activeTool:appState.activeTool,setAppState:setAppState,onImageAction:function onImageAction(_ref3){var pointerType=_ref3.pointerType;_onImageAction({insertOnCanvasDirectly:pointerType!==\"mouse\"});}})]})]})})})]});}}),/*#__PURE__*/_jsxs(\"div\",{className:clsx(\"layer-ui__wrapper__top-right zen-mode-transition\",{\"transition-right\":appState.zenModeEnabled}),children:[/*#__PURE__*/_jsx(UserList,{collaborators:appState.collaborators}),renderTopRightUI===null||renderTopRightUI===void 0?void 0:renderTopRightUI(device.isMobile,appState),!appState.viewModeEnabled&&(// hide button when sidebar docked\n!isSidebarDocked||((_appState$openSidebar=appState.openSidebar)===null||_appState$openSidebar===void 0?void 0:_appState$openSidebar.name)!==DEFAULT_SIDEBAR.name)&&/*#__PURE__*/_jsx(tunnels.DefaultSidebarTriggerTunnel.Out,{})]})]})});};var renderSidebars=function renderSidebars(){return/*#__PURE__*/_jsx(DefaultSidebar,{__fallback:true,onDock:function onDock(docked){trackEvent(\"sidebar\",\"toggleDock (\".concat(docked?\"dock\":\"undock\",\")\"),\"(\".concat(device.isMobile?\"mobile\":\"desktop\",\")\"));}});};var isSidebarDocked=useAtomValue(isSidebarDockedAtom,jotaiScope);var layerUIJSX=/*#__PURE__*/_jsxs(_Fragment,{children:[children,/*#__PURE__*/_jsx(DefaultMainMenu,{UIOptions:UIOptions}),/*#__PURE__*/_jsx(DefaultSidebar.Trigger,{__fallback:true,icon:LibraryIcon,title:capitalizeString(t(\"toolBar.library\")),onToggle:function onToggle(open){if(open){trackEvent(\"sidebar\",\"\".concat(DEFAULT_SIDEBAR.name,\" (open)\"),\"button (\".concat(device.isMobile?\"mobile\":\"desktop\",\")\"));}},tab:DEFAULT_SIDEBAR.defaultTab,children:t(\"toolBar.library\")}),/*#__PURE__*/_jsx(DefaultOverwriteConfirmDialog,{}),appState.isLoading&&/*#__PURE__*/_jsx(LoadingMessage,{delay:250}),appState.errorMessage&&/*#__PURE__*/_jsx(ErrorDialog,{onClose:function onClose(){return setAppState({errorMessage:null});},children:appState.errorMessage}),eyeDropperState&&!device.isMobile&&/*#__PURE__*/_jsx(EyeDropper,{swapPreviewOnAlt:eyeDropperState.swapPreviewOnAlt,previewType:eyeDropperState.previewType,onCancel:function onCancel(){setEyeDropperState(null);},onSelect:function onSelect(color,event){var _eyeDropperState$onSe;setEyeDropperState(function(state){return state!==null&&state!==void 0&&state.keepOpenOnAlt&&event.altKey?state:null;});eyeDropperState===null||eyeDropperState===void 0?void 0:(_eyeDropperState$onSe=eyeDropperState.onSelect)===null||_eyeDropperState$onSe===void 0?void 0:_eyeDropperState$onSe.call(eyeDropperState,color,event);}}),appState.openDialog===\"help\"&&/*#__PURE__*/_jsx(HelpDialog,{onClose:function onClose(){setAppState({openDialog:null});}}),/*#__PURE__*/_jsx(ActiveConfirmDialog,{}),/*#__PURE__*/_jsx(tunnels.OverwriteConfirmDialogTunnel.Out,{}),renderImageExportDialog(),renderJSONExportDialog(),appState.pasteDialog.shown&&/*#__PURE__*/_jsx(PasteChartDialog,{setAppState:setAppState,appState:appState,onClose:function onClose(){return setAppState({pasteDialog:{shown:false,data:null}});}}),device.isMobile&&/*#__PURE__*/_jsx(MobileMenu,{app:app,appState:appState,elements:elements,actionManager:actionManager,renderJSONExportDialog:renderJSONExportDialog,renderImageExportDialog:renderImageExportDialog,setAppState:setAppState,onLockToggle:onLockToggle,onHandToolToggle:onHandToolToggle,onPenModeToggle:onPenModeToggle,canvas:canvas,onImageAction:_onImageAction,renderTopRightUI:renderTopRightUI,renderCustomStats:renderCustomStats,renderSidebars:renderSidebars,device:device,renderWelcomeScreen:renderWelcomeScreen}),!device.isMobile&&/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsxs(\"div\",{className:clsx(\"layer-ui__wrapper\",{\"disable-pointerEvents\":appState.draggingElement||appState.resizingElement||appState.editingElement&&!isTextElement(appState.editingElement)}),style:appState.openSidebar&&isSidebarDocked&&device.canDeviceFitSidebar?{width:\"calc(100% - \".concat(LIBRARY_SIDEBAR_WIDTH,\"px)\")}:{},children:[renderWelcomeScreen&&/*#__PURE__*/_jsx(tunnels.WelcomeScreenCenterTunnel.Out,{}),renderFixedSideContainer(),/*#__PURE__*/_jsx(Footer,{appState:appState,actionManager:actionManager,showExitZenModeBtn:showExitZenModeBtn,renderWelcomeScreen:renderWelcomeScreen}),appState.showStats&&/*#__PURE__*/_jsx(Stats,{appState:appState,setAppState:setAppState,elements:elements,onClose:function onClose(){actionManager.executeAction(actionToggleStats);},renderCustomStats:renderCustomStats}),appState.scrolledOutside&&/*#__PURE__*/_jsx(\"button\",{className:\"scroll-back-to-content\",onClick:function onClick(){setAppState(function(appState){return _objectSpread({},calculateScrollCenter(elements,appState,canvas));});},children:t(\"buttons.scrollBackToContent\")})]}),renderSidebars()]})]});return/*#__PURE__*/_jsx(UIAppStateContext.Provider,{value:appState,children:/*#__PURE__*/_jsx(Provider,{scope:tunnels.jotaiScope,children:/*#__PURE__*/_jsx(TunnelsContext.Provider,{value:tunnels,children:layerUIJSX})})});};var stripIrrelevantAppStateProps=function stripIrrelevantAppStateProps(appState){var suggestedBindings=appState.suggestedBindings,startBoundElement=appState.startBoundElement,cursorButton=appState.cursorButton,scrollX=appState.scrollX,scrollY=appState.scrollY,ret=_objectWithoutProperties(appState,_excluded);return ret;};var areEqual=function areEqual(prevProps,nextProps){// short-circuit early\nif(prevProps.children!==nextProps.children){return false;}var _prevCanvas=prevProps.canvas,prevAppState=prevProps.appState,prev=_objectWithoutProperties(prevProps,_excluded2);var _nextCanvas=nextProps.canvas,nextAppState=nextProps.appState,next=_objectWithoutProperties(nextProps,_excluded3);return isShallowEqual(// asserting AppState because we're being passed the whole AppState\n// but resolve to only the UI-relevant props\nstripIrrelevantAppStateProps(prevAppState),stripIrrelevantAppStateProps(nextAppState),{selectedElementIds:isShallowEqual,selectedGroupIds:isShallowEqual})&&isShallowEqual(prev,next);};export default/*#__PURE__*/React.memo(LayerUI,areEqual);","map":{"version":3,"names":["clsx","React","CLASSES","DEFAULT_SIDEBAR","LIBRARY_SIDEBAR_WIDTH","isTextElement","showSelectedShapeActions","t","calculateScrollCenter","capitalizeString","isShallowEqual","SelectedShapeActions","ShapesSwitcher","ErrorDialog","ImageExportDialog","FixedSideContainer","HintViewer","Island","LoadingMessage","LockButton","MobileMenu","PasteChartDialog","Section","HelpDialog","Stack","UserList","JSONExportDialog","PenModeButton","trackEvent","useDevice","Stats","actionToggleStats","Footer","isSidebarDockedAtom","jotaiScope","Provider","useAtom","useAtomValue","MainMenu","ActiveConfirmDialog","OverwriteConfirmDialog","HandButton","isHandToolActive","TunnelsContext","useInitializeTunnels","LibraryIcon","UIAppStateContext","DefaultSidebar","EyeDropper","activeEyeDropperAtom","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","DefaultMainMenu","_ref","UIOptions","__fallback","children","DefaultItems","LoadScene","SaveToActiveFile","canvasActions","export","Export","saveAsImage","SaveAsImage","Help","ClearCanvas","Separator","Group","title","Socials","ToggleTheme","ChangeCanvasBackground","DefaultOverwriteConfirmDialog","Actions","SaveToDisk","ExportToImage","LayerUI","_ref2","actionManager","appState","files","setAppState","elements","canvas","onLockToggle","onHandToolToggle","onPenModeToggle","showExitZenModeBtn","renderTopRightUI","renderCustomStats","onImageAction","onExportImage","renderWelcomeScreen","app","device","tunnels","_useAtom","_useAtom2","_slicedToArray","eyeDropperState","setEyeDropperState","renderJSONExportDialog","exportOpts","renderImageExportDialog","onCloseRequest","openDialog","renderCanvasActions","style","position","MainMenuTunnel","Out","WelcomeScreenMenuHintTunnel","renderSelectedShapeActions","heading","className","zenModeEnabled","SHAPE_ACTIONS_MENU","padding","maxHeight","concat","height","renderAction","renderFixedSideContainer","_appState$openSidebar","shouldRenderSelectedShapeActions","side","Col","gap","viewModeEnabled","WelcomeScreenToolbarHintTunnel","align","Row","isMobile","checked","penMode","onChange","penDetected","activeTool","locked","_ref3","pointerType","insertOnCanvasDirectly","collaborators","isSidebarDocked","openSidebar","name","DefaultSidebarTriggerTunnel","renderSidebars","onDock","docked","layerUIJSX","Trigger","icon","onToggle","open","tab","defaultTab","isLoading","delay","errorMessage","onClose","swapPreviewOnAlt","previewType","onCancel","onSelect","color","event","_eyeDropperState$onSe","state","keepOpenOnAlt","altKey","call","OverwriteConfirmDialogTunnel","pasteDialog","shown","data","draggingElement","resizingElement","editingElement","canDeviceFitSidebar","width","WelcomeScreenCenterTunnel","showStats","executeAction","scrolledOutside","onClick","_objectSpread","value","scope","stripIrrelevantAppStateProps","suggestedBindings","startBoundElement","cursorButton","scrollX","scrollY","ret","_objectWithoutProperties","_excluded","areEqual","prevProps","nextProps","_prevCanvas","prevAppState","prev","_excluded2","_nextCanvas","nextAppState","next","_excluded3","selectedElementIds","selectedGroupIds","memo"],"sources":["D:/project/excalidraw-cn/src/components/LayerUI.tsx"],"sourcesContent":["import clsx from \"clsx\";\nimport React from \"react\";\nimport { ActionManager } from \"../actions/manager\";\nimport { CLASSES, DEFAULT_SIDEBAR, LIBRARY_SIDEBAR_WIDTH } from \"../constants\";\nimport { isTextElement, showSelectedShapeActions } from \"../element\";\nimport { NonDeletedExcalidrawElement } from \"../element/types\";\nimport { Language, t } from \"../i18n\";\nimport { calculateScrollCenter } from \"../scene\";\nimport {\n  AppProps,\n  AppState,\n  ExcalidrawProps,\n  BinaryFiles,\n  UIAppState,\n  AppClassProperties,\n} from \"../types\";\nimport { capitalizeString, isShallowEqual } from \"../utils\";\nimport { SelectedShapeActions, ShapesSwitcher } from \"./Actions\";\nimport { ErrorDialog } from \"./ErrorDialog\";\nimport { ImageExportDialog } from \"./ImageExportDialog\";\nimport { FixedSideContainer } from \"./FixedSideContainer\";\nimport { HintViewer } from \"./HintViewer\";\nimport { Island } from \"./Island\";\nimport { LoadingMessage } from \"./LoadingMessage\";\nimport { LockButton } from \"./LockButton\";\nimport { MobileMenu } from \"./MobileMenu\";\nimport { PasteChartDialog } from \"./PasteChartDialog\";\nimport { Section } from \"./Section\";\nimport { HelpDialog } from \"./HelpDialog\";\nimport Stack from \"./Stack\";\nimport { UserList } from \"./UserList\";\nimport { JSONExportDialog } from \"./JSONExportDialog\";\nimport { PenModeButton } from \"./PenModeButton\";\nimport { trackEvent } from \"../analytics\";\nimport { useDevice } from \"../components/App\";\nimport { Stats } from \"./Stats\";\nimport { actionToggleStats } from \"../actions/actionToggleStats\";\nimport Footer from \"./footer/Footer\";\nimport { isSidebarDockedAtom } from \"./Sidebar/Sidebar\";\nimport { jotaiScope } from \"../jotai\";\nimport { Provider, useAtom, useAtomValue } from \"jotai\";\nimport MainMenu from \"./main-menu/MainMenu\";\nimport { ActiveConfirmDialog } from \"./ActiveConfirmDialog\";\nimport { OverwriteConfirmDialog } from \"./OverwriteConfirm/OverwriteConfirm\";\nimport { HandButton } from \"./HandButton\";\nimport { isHandToolActive } from \"../appState\";\nimport { TunnelsContext, useInitializeTunnels } from \"../context/tunnels\";\nimport { LibraryIcon } from \"./icons\";\nimport { UIAppStateContext } from \"../context/ui-appState\";\nimport { DefaultSidebar } from \"./DefaultSidebar\";\nimport { EyeDropper, activeEyeDropperAtom } from \"./EyeDropper\";\n\nimport \"./LayerUI.scss\";\nimport \"./Toolbar.scss\";\n\ninterface LayerUIProps {\n  actionManager: ActionManager;\n  appState: UIAppState;\n  files: BinaryFiles;\n  canvas: HTMLCanvasElement | null;\n  setAppState: React.Component<any, AppState>[\"setState\"];\n  elements: readonly NonDeletedExcalidrawElement[];\n  onLockToggle: () => void;\n  onHandToolToggle: () => void;\n  onPenModeToggle: () => void;\n  showExitZenModeBtn: boolean;\n  langCode: Language[\"code\"];\n  renderTopRightUI?: ExcalidrawProps[\"renderTopRightUI\"];\n  renderCustomStats?: ExcalidrawProps[\"renderCustomStats\"];\n  UIOptions: AppProps[\"UIOptions\"];\n  onImageAction: (data: { insertOnCanvasDirectly: boolean }) => void;\n  onExportImage: AppClassProperties[\"onExportImage\"];\n  renderWelcomeScreen: boolean;\n  children?: React.ReactNode;\n  app: AppClassProperties;\n}\n\nconst DefaultMainMenu: React.FC<{\n  UIOptions: AppProps[\"UIOptions\"];\n}> = ({ UIOptions }) => {\n  return (\n    <MainMenu __fallback>\n      <MainMenu.DefaultItems.LoadScene />\n      <MainMenu.DefaultItems.SaveToActiveFile />\n      {/* FIXME we should to test for this inside the item itself */}\n      {UIOptions.canvasActions.export && <MainMenu.DefaultItems.Export />}\n      {/* FIXME we should to test for this inside the item itself */}\n      {UIOptions.canvasActions.saveAsImage && (\n        <MainMenu.DefaultItems.SaveAsImage />\n      )}\n      <MainMenu.DefaultItems.Help />\n      <MainMenu.DefaultItems.ClearCanvas />\n      <MainMenu.Separator />\n      <MainMenu.Group title=\"Excalidraw links\">\n        <MainMenu.DefaultItems.Socials />\n      </MainMenu.Group>\n      <MainMenu.Separator />\n      <MainMenu.DefaultItems.ToggleTheme />\n      <MainMenu.DefaultItems.ChangeCanvasBackground />\n    </MainMenu>\n  );\n};\n\nconst DefaultOverwriteConfirmDialog = () => {\n  return (\n    <OverwriteConfirmDialog __fallback>\n      <OverwriteConfirmDialog.Actions.SaveToDisk />\n      <OverwriteConfirmDialog.Actions.ExportToImage />\n    </OverwriteConfirmDialog>\n  );\n};\n\nconst LayerUI = ({\n  actionManager,\n  appState,\n  files,\n  setAppState,\n  elements,\n  canvas,\n  onLockToggle,\n  onHandToolToggle,\n  onPenModeToggle,\n  showExitZenModeBtn,\n  renderTopRightUI,\n  renderCustomStats,\n  UIOptions,\n  onImageAction,\n  onExportImage,\n  renderWelcomeScreen,\n  children,\n  app,\n}: LayerUIProps) => {\n  const device = useDevice();\n  const tunnels = useInitializeTunnels();\n\n  const [eyeDropperState, setEyeDropperState] = useAtom(\n    activeEyeDropperAtom,\n    jotaiScope,\n  );\n\n  const renderJSONExportDialog = () => {\n    if (!UIOptions.canvasActions.export) {\n      return null;\n    }\n\n    return (\n      <JSONExportDialog\n        elements={elements}\n        appState={appState}\n        files={files}\n        actionManager={actionManager}\n        exportOpts={UIOptions.canvasActions.export}\n        canvas={canvas}\n        setAppState={setAppState}\n      />\n    );\n  };\n\n  const renderImageExportDialog = () => {\n    if (!UIOptions.canvasActions.saveAsImage) {\n      return null;\n    }\n\n    return (\n      <ImageExportDialog\n        elements={elements}\n        appState={appState}\n        files={files}\n        actionManager={actionManager}\n        onExportImage={onExportImage}\n        onCloseRequest={() => setAppState({ openDialog: null })}\n      />\n    );\n  };\n\n  const renderCanvasActions = () => (\n    <div style={{ position: \"relative\" }}>\n      {/* wrapping to Fragment stops React from occasionally complaining\n                about identical Keys */}\n      <tunnels.MainMenuTunnel.Out />\n      {renderWelcomeScreen && <tunnels.WelcomeScreenMenuHintTunnel.Out />}\n    </div>\n  );\n\n  const renderSelectedShapeActions = () => (\n    <Section\n      heading=\"selectedShapeActions\"\n      className={clsx(\"selected-shape-actions zen-mode-transition\", {\n        \"transition-left\": appState.zenModeEnabled,\n      })}\n    >\n      <Island\n        className={CLASSES.SHAPE_ACTIONS_MENU}\n        padding={2}\n        style={{\n          // we want to make sure this doesn't overflow so subtracting the\n          // approximate height of hamburgerMenu + footer\n          maxHeight: `${appState.height - 166}px`,\n        }}\n      >\n        <SelectedShapeActions\n          appState={appState}\n          elements={elements}\n          renderAction={actionManager.renderAction}\n        />\n      </Island>\n    </Section>\n  );\n\n  const renderFixedSideContainer = () => {\n    const shouldRenderSelectedShapeActions = showSelectedShapeActions(\n      appState,\n      elements,\n    );\n\n    return (\n      <FixedSideContainer side=\"top\">\n        <div className=\"App-menu App-menu_top\">\n          <Stack.Col gap={6} className={clsx(\"App-menu_top__left\")}>\n            {renderCanvasActions()}\n            {shouldRenderSelectedShapeActions && renderSelectedShapeActions()}\n          </Stack.Col>\n          {!appState.viewModeEnabled && (\n            <Section heading=\"shapes\" className=\"shapes-section\">\n              {(heading: React.ReactNode) => (\n                <div style={{ position: \"relative\" }}>\n                  {renderWelcomeScreen && (\n                    <tunnels.WelcomeScreenToolbarHintTunnel.Out />\n                  )}\n                  <Stack.Col gap={4} align=\"start\">\n                    <Stack.Row\n                      gap={1}\n                      className={clsx(\"App-toolbar-container\", {\n                        \"zen-mode\": appState.zenModeEnabled,\n                      })}\n                    >\n                      <Island\n                        padding={1}\n                        className={clsx(\"App-toolbar\", {\n                          \"zen-mode\": appState.zenModeEnabled,\n                        })}\n                      >\n                        <HintViewer\n                          appState={appState}\n                          isMobile={device.isMobile}\n                          device={device}\n                          app={app}\n                        />\n                        {heading}\n                        <Stack.Row gap={1}>\n                          <PenModeButton\n                            zenModeEnabled={appState.zenModeEnabled}\n                            checked={appState.penMode}\n                            onChange={onPenModeToggle}\n                            title={t(\"toolBar.penMode\")}\n                            penDetected={appState.penDetected}\n                          />\n                          <LockButton\n                            checked={appState.activeTool.locked}\n                            onChange={onLockToggle}\n                            title={t(\"toolBar.lock\")}\n                          />\n\n                          <div className=\"App-toolbar__divider\" />\n\n                          <HandButton\n                            checked={isHandToolActive(appState)}\n                            onChange={() => onHandToolToggle()}\n                            title={t(\"toolBar.hand\")}\n                            isMobile\n                          />\n\n                          <ShapesSwitcher\n                            appState={appState}\n                            canvas={canvas}\n                            activeTool={appState.activeTool}\n                            setAppState={setAppState}\n                            onImageAction={({ pointerType }) => {\n                              onImageAction({\n                                insertOnCanvasDirectly: pointerType !== \"mouse\",\n                              });\n                            }}\n                          />\n                        </Stack.Row>\n                      </Island>\n                    </Stack.Row>\n                  </Stack.Col>\n                </div>\n              )}\n            </Section>\n          )}\n          <div\n            className={clsx(\n              \"layer-ui__wrapper__top-right zen-mode-transition\",\n              {\n                \"transition-right\": appState.zenModeEnabled,\n              },\n            )}\n          >\n            <UserList collaborators={appState.collaborators} />\n            {renderTopRightUI?.(device.isMobile, appState)}\n            {!appState.viewModeEnabled &&\n              // hide button when sidebar docked\n              (!isSidebarDocked ||\n                appState.openSidebar?.name !== DEFAULT_SIDEBAR.name) && (\n                <tunnels.DefaultSidebarTriggerTunnel.Out />\n              )}\n          </div>\n        </div>\n      </FixedSideContainer>\n    );\n  };\n\n  const renderSidebars = () => {\n    return (\n      <DefaultSidebar\n        __fallback\n        onDock={(docked) => {\n          trackEvent(\n            \"sidebar\",\n            `toggleDock (${docked ? \"dock\" : \"undock\"})`,\n            `(${device.isMobile ? \"mobile\" : \"desktop\"})`,\n          );\n        }}\n      />\n    );\n  };\n\n  const isSidebarDocked = useAtomValue(isSidebarDockedAtom, jotaiScope);\n\n  const layerUIJSX = (\n    <>\n      {/* ------------------------- tunneled UI ---------------------------- */}\n      {/* make sure we render host app components first so that we can detect\n          them first on initial render to optimize layout shift */}\n      {children}\n      {/* render component fallbacks. Can be rendered anywhere as they'll be\n          tunneled away. We only render tunneled components that actually\n        have defaults when host do not render anything. */}\n      <DefaultMainMenu UIOptions={UIOptions} />\n      <DefaultSidebar.Trigger\n        __fallback\n        icon={LibraryIcon}\n        title={capitalizeString(t(\"toolBar.library\"))}\n        onToggle={(open) => {\n          if (open) {\n            trackEvent(\n              \"sidebar\",\n              `${DEFAULT_SIDEBAR.name} (open)`,\n              `button (${device.isMobile ? \"mobile\" : \"desktop\"})`,\n            );\n          }\n        }}\n        tab={DEFAULT_SIDEBAR.defaultTab}\n      >\n        {t(\"toolBar.library\")}\n      </DefaultSidebar.Trigger>\n      <DefaultOverwriteConfirmDialog />\n      {/* ------------------------------------------------------------------ */}\n\n      {appState.isLoading && <LoadingMessage delay={250} />}\n      {appState.errorMessage && (\n        <ErrorDialog onClose={() => setAppState({ errorMessage: null })}>\n          {appState.errorMessage}\n        </ErrorDialog>\n      )}\n      {eyeDropperState && !device.isMobile && (\n        <EyeDropper\n          swapPreviewOnAlt={eyeDropperState.swapPreviewOnAlt}\n          previewType={eyeDropperState.previewType}\n          onCancel={() => {\n            setEyeDropperState(null);\n          }}\n          onSelect={(color, event) => {\n            setEyeDropperState((state) => {\n              return state?.keepOpenOnAlt && event.altKey ? state : null;\n            });\n            eyeDropperState?.onSelect?.(color, event);\n          }}\n        />\n      )}\n      {appState.openDialog === \"help\" && (\n        <HelpDialog\n          onClose={() => {\n            setAppState({ openDialog: null });\n          }}\n        />\n      )}\n      <ActiveConfirmDialog />\n      <tunnels.OverwriteConfirmDialogTunnel.Out />\n      {renderImageExportDialog()}\n      {renderJSONExportDialog()}\n      {appState.pasteDialog.shown && (\n        <PasteChartDialog\n          setAppState={setAppState}\n          appState={appState}\n          onClose={() =>\n            setAppState({\n              pasteDialog: { shown: false, data: null },\n            })\n          }\n        />\n      )}\n      {device.isMobile && (\n        <MobileMenu\n          app={app}\n          appState={appState}\n          elements={elements}\n          actionManager={actionManager}\n          renderJSONExportDialog={renderJSONExportDialog}\n          renderImageExportDialog={renderImageExportDialog}\n          setAppState={setAppState}\n          onLockToggle={onLockToggle}\n          onHandToolToggle={onHandToolToggle}\n          onPenModeToggle={onPenModeToggle}\n          canvas={canvas}\n          onImageAction={onImageAction}\n          renderTopRightUI={renderTopRightUI}\n          renderCustomStats={renderCustomStats}\n          renderSidebars={renderSidebars}\n          device={device}\n          renderWelcomeScreen={renderWelcomeScreen}\n        />\n      )}\n      {!device.isMobile && (\n        <>\n          <div\n            className={clsx(\"layer-ui__wrapper\", {\n              \"disable-pointerEvents\":\n                appState.draggingElement ||\n                appState.resizingElement ||\n                (appState.editingElement &&\n                  !isTextElement(appState.editingElement)),\n            })}\n            style={\n              appState.openSidebar &&\n              isSidebarDocked &&\n              device.canDeviceFitSidebar\n                ? { width: `calc(100% - ${LIBRARY_SIDEBAR_WIDTH}px)` }\n                : {}\n            }\n          >\n            {renderWelcomeScreen && <tunnels.WelcomeScreenCenterTunnel.Out />}\n            {renderFixedSideContainer()}\n            <Footer\n              appState={appState}\n              actionManager={actionManager}\n              showExitZenModeBtn={showExitZenModeBtn}\n              renderWelcomeScreen={renderWelcomeScreen}\n            />\n            {appState.showStats && (\n              <Stats\n                appState={appState}\n                setAppState={setAppState}\n                elements={elements}\n                onClose={() => {\n                  actionManager.executeAction(actionToggleStats);\n                }}\n                renderCustomStats={renderCustomStats}\n              />\n            )}\n            {appState.scrolledOutside && (\n              <button\n                className=\"scroll-back-to-content\"\n                onClick={() => {\n                  setAppState((appState) => ({\n                    ...calculateScrollCenter(elements, appState, canvas),\n                  }));\n                }}\n              >\n                {t(\"buttons.scrollBackToContent\")}\n              </button>\n            )}\n          </div>\n          {renderSidebars()}\n        </>\n      )}\n    </>\n  );\n\n  return (\n    <UIAppStateContext.Provider value={appState}>\n      <Provider scope={tunnels.jotaiScope}>\n        <TunnelsContext.Provider value={tunnels}>\n          {layerUIJSX}\n        </TunnelsContext.Provider>\n      </Provider>\n    </UIAppStateContext.Provider>\n  );\n};\n\nconst stripIrrelevantAppStateProps = (appState: AppState): UIAppState => {\n  const {\n    suggestedBindings,\n    startBoundElement,\n    cursorButton,\n    scrollX,\n    scrollY,\n    ...ret\n  } = appState;\n  return ret;\n};\n\nconst areEqual = (prevProps: LayerUIProps, nextProps: LayerUIProps) => {\n  // short-circuit early\n  if (prevProps.children !== nextProps.children) {\n    return false;\n  }\n\n  const { canvas: _prevCanvas, appState: prevAppState, ...prev } = prevProps;\n  const { canvas: _nextCanvas, appState: nextAppState, ...next } = nextProps;\n\n  return (\n    isShallowEqual(\n      // asserting AppState because we're being passed the whole AppState\n      // but resolve to only the UI-relevant props\n      stripIrrelevantAppStateProps(prevAppState as AppState),\n      stripIrrelevantAppStateProps(nextAppState as AppState),\n      {\n        selectedElementIds: isShallowEqual,\n        selectedGroupIds: isShallowEqual,\n      },\n    ) && isShallowEqual(prev, next)\n  );\n};\n\nexport default React.memo(LayerUI, areEqual);\n"],"mappings":"0fAAA,MAAO,CAAAA,IAAI,KAAM,MAAM,CACvB,MAAO,CAAAC,KAAK,KAAM,OAAO,CAEzB,OAASC,OAAO,CAAEC,eAAe,CAAEC,qBAAqB,KAAQ,cAAc,CAC9E,OAASC,aAAa,CAAEC,wBAAwB,KAAQ,YAAY,CAEpE,OAAmBC,CAAC,KAAQ,SAAS,CACrC,OAASC,qBAAqB,KAAQ,UAAU,CAShD,OAASC,gBAAgB,CAAEC,cAAc,KAAQ,UAAU,CAC3D,OAASC,oBAAoB,CAAEC,cAAc,KAAQ,WAAW,CAChE,OAASC,WAAW,KAAQ,eAAe,CAC3C,OAASC,iBAAiB,KAAQ,qBAAqB,CACvD,OAASC,kBAAkB,KAAQ,sBAAsB,CACzD,OAASC,UAAU,KAAQ,cAAc,CACzC,OAASC,MAAM,KAAQ,UAAU,CACjC,OAASC,cAAc,KAAQ,kBAAkB,CACjD,OAASC,UAAU,KAAQ,cAAc,CACzC,OAASC,UAAU,KAAQ,cAAc,CACzC,OAASC,gBAAgB,KAAQ,oBAAoB,CACrD,OAASC,OAAO,KAAQ,WAAW,CACnC,OAASC,UAAU,KAAQ,cAAc,CACzC,MAAO,CAAAC,KAAK,KAAM,SAAS,CAC3B,OAASC,QAAQ,KAAQ,YAAY,CACrC,OAASC,gBAAgB,KAAQ,oBAAoB,CACrD,OAASC,aAAa,KAAQ,iBAAiB,CAC/C,OAASC,UAAU,KAAQ,cAAc,CACzC,OAASC,SAAS,KAAQ,mBAAmB,CAC7C,OAASC,KAAK,KAAQ,SAAS,CAC/B,OAASC,iBAAiB,KAAQ,8BAA8B,CAChE,MAAO,CAAAC,MAAM,KAAM,iBAAiB,CACpC,OAASC,mBAAmB,KAAQ,mBAAmB,CACvD,OAASC,UAAU,KAAQ,UAAU,CACrC,OAASC,QAAQ,CAAEC,OAAO,CAAEC,YAAY,KAAQ,OAAO,CACvD,MAAO,CAAAC,QAAQ,KAAM,sBAAsB,CAC3C,OAASC,mBAAmB,KAAQ,uBAAuB,CAC3D,OAASC,sBAAsB,KAAQ,qCAAqC,CAC5E,OAASC,UAAU,KAAQ,cAAc,CACzC,OAASC,gBAAgB,KAAQ,aAAa,CAC9C,OAASC,cAAc,CAAEC,oBAAoB,KAAQ,oBAAoB,CACzE,OAASC,WAAW,KAAQ,SAAS,CACrC,OAASC,iBAAiB,KAAQ,wBAAwB,CAC1D,OAASC,cAAc,KAAQ,kBAAkB,CACjD,OAASC,UAAU,CAAEC,oBAAoB,KAAQ,cAAc,CAE/D,MAAO,gBAAgB,CACvB,MAAO,gBAAgB,CAAC,OAAAC,GAAA,IAAAC,IAAA,gCAAAC,IAAA,IAAAC,KAAA,gCAAAC,QAAA,IAAAC,SAAA,yBAwBxB,GAAM,CAAAC,eAEJ,CAAG,QAFC,CAAAA,eAEJA,CAAAC,IAAA,CAAsB,IAAhB,CAAAC,SAAS,CAAAD,IAAA,CAATC,SAAS,CACf,mBACEL,KAAA,CAACf,QAAQ,EAACqB,UAAU,MAAAC,QAAA,eAClBT,IAAA,CAACb,QAAQ,CAACuB,YAAY,CAACC,SAAS,IAAG,cACnCX,IAAA,CAACb,QAAQ,CAACuB,YAAY,CAACE,gBAAgB,IAAG,CAEzCL,SAAS,CAACM,aAAa,CAACC,MAAM,eAAId,IAAA,CAACb,QAAQ,CAACuB,YAAY,CAACK,MAAM,IAAG,CAElER,SAAS,CAACM,aAAa,CAACG,WAAW,eAClChB,IAAA,CAACb,QAAQ,CAACuB,YAAY,CAACO,WAAW,IACnC,cACDjB,IAAA,CAACb,QAAQ,CAACuB,YAAY,CAACQ,IAAI,IAAG,cAC9BlB,IAAA,CAACb,QAAQ,CAACuB,YAAY,CAACS,WAAW,IAAG,cACrCnB,IAAA,CAACb,QAAQ,CAACiC,SAAS,IAAG,cACtBpB,IAAA,CAACb,QAAQ,CAACkC,KAAK,EAACC,KAAK,CAAC,kBAAkB,CAAAb,QAAA,cACtCT,IAAA,CAACb,QAAQ,CAACuB,YAAY,CAACa,OAAO,IAAG,EAClB,cACjBvB,IAAA,CAACb,QAAQ,CAACiC,SAAS,IAAG,cACtBpB,IAAA,CAACb,QAAQ,CAACuB,YAAY,CAACc,WAAW,IAAG,cACrCxB,IAAA,CAACb,QAAQ,CAACuB,YAAY,CAACe,sBAAsB,IAAG,GACvC,CAEf,CAAC,CAED,GAAM,CAAAC,6BAA6B,CAAG,QAAhC,CAAAA,6BAA6BA,CAAA,CAAS,CAC1C,mBACExB,KAAA,CAACb,sBAAsB,EAACmB,UAAU,MAAAC,QAAA,eAChCT,IAAA,CAACX,sBAAsB,CAACsC,OAAO,CAACC,UAAU,IAAG,cAC7C5B,IAAA,CAACX,sBAAsB,CAACsC,OAAO,CAACE,aAAa,IAAG,GACzB,CAE7B,CAAC,CAED,GAAM,CAAAC,OAAO,CAAG,QAAV,CAAAA,OAAOA,CAAAC,KAAA,CAmBO,IAlBlB,CAAAC,aAAa,CAAAD,KAAA,CAAbC,aAAa,CACbC,QAAQ,CAAAF,KAAA,CAARE,QAAQ,CACRC,KAAK,CAAAH,KAAA,CAALG,KAAK,CACLC,WAAW,CAAAJ,KAAA,CAAXI,WAAW,CACXC,QAAQ,CAAAL,KAAA,CAARK,QAAQ,CACRC,MAAM,CAAAN,KAAA,CAANM,MAAM,CACNC,YAAY,CAAAP,KAAA,CAAZO,YAAY,CACZC,gBAAgB,CAAAR,KAAA,CAAhBQ,gBAAgB,CAChBC,eAAe,CAAAT,KAAA,CAAfS,eAAe,CACfC,kBAAkB,CAAAV,KAAA,CAAlBU,kBAAkB,CAClBC,gBAAgB,CAAAX,KAAA,CAAhBW,gBAAgB,CAChBC,iBAAiB,CAAAZ,KAAA,CAAjBY,iBAAiB,CACjBpC,SAAS,CAAAwB,KAAA,CAATxB,SAAS,CACTqC,cAAa,CAAAb,KAAA,CAAba,aAAa,CACbC,aAAa,CAAAd,KAAA,CAAbc,aAAa,CACbC,mBAAmB,CAAAf,KAAA,CAAnBe,mBAAmB,CACnBrC,QAAQ,CAAAsB,KAAA,CAARtB,QAAQ,CACRsC,GAAG,CAAAhB,KAAA,CAAHgB,GAAG,CAEH,GAAM,CAAAC,MAAM,CAAGtE,SAAS,EAAE,CAC1B,GAAM,CAAAuE,OAAO,CAAGxD,oBAAoB,EAAE,CAEtC,IAAAyD,QAAA,CAA8CjE,OAAO,CACnDa,oBAAoB,CACpBf,UAAU,CACX,CAAAoE,SAAA,CAAAC,cAAA,CAAAF,QAAA,IAHMG,eAAe,CAAAF,SAAA,IAAEG,kBAAkB,CAAAH,SAAA,IAK1C,GAAM,CAAAI,sBAAsB,CAAG,QAAzB,CAAAA,sBAAsBA,CAAA,CAAS,CACnC,GAAI,CAAChD,SAAS,CAACM,aAAa,CAACC,MAAM,CAAE,CACnC,MAAO,KAAI,CACb,CAEA,mBACEd,IAAA,CAACzB,gBAAgB,EACf6D,QAAQ,CAAEA,QAAS,CACnBH,QAAQ,CAAEA,QAAS,CACnBC,KAAK,CAAEA,KAAM,CACbF,aAAa,CAAEA,aAAc,CAC7BwB,UAAU,CAAEjD,SAAS,CAACM,aAAa,CAACC,MAAO,CAC3CuB,MAAM,CAAEA,MAAO,CACfF,WAAW,CAAEA,WAAY,EACzB,CAEN,CAAC,CAED,GAAM,CAAAsB,uBAAuB,CAAG,QAA1B,CAAAA,uBAAuBA,CAAA,CAAS,CACpC,GAAI,CAAClD,SAAS,CAACM,aAAa,CAACG,WAAW,CAAE,CACxC,MAAO,KAAI,CACb,CAEA,mBACEhB,IAAA,CAACrC,iBAAiB,EAChByE,QAAQ,CAAEA,QAAS,CACnBH,QAAQ,CAAEA,QAAS,CACnBC,KAAK,CAAEA,KAAM,CACbF,aAAa,CAAEA,aAAc,CAC7Ba,aAAa,CAAEA,aAAc,CAC7Ba,cAAc,CAAE,SAAAA,eAAA,QAAM,CAAAvB,WAAW,CAAC,CAAEwB,UAAU,CAAE,IAAK,CAAC,CAAC,EAAC,EACxD,CAEN,CAAC,CAED,GAAM,CAAAC,mBAAmB,CAAG,QAAtB,CAAAA,mBAAmBA,CAAA,qBACvB1D,KAAA,QAAK2D,KAAK,CAAE,CAAEC,QAAQ,CAAE,UAAW,CAAE,CAAArD,QAAA,eAGnCT,IAAA,CAACiD,OAAO,CAACc,cAAc,CAACC,GAAG,IAAG,CAC7BlB,mBAAmB,eAAI9C,IAAA,CAACiD,OAAO,CAACgB,2BAA2B,CAACD,GAAG,IAAG,GAC/D,EACP,CAED,GAAM,CAAAE,0BAA0B,CAAG,QAA7B,CAAAA,0BAA0BA,CAAA,qBAC9BlE,IAAA,CAAC7B,OAAO,EACNgG,OAAO,CAAC,sBAAsB,CAC9BC,SAAS,CAAEvH,IAAI,CAAC,4CAA4C,CAAE,CAC5D,iBAAiB,CAAEoF,QAAQ,CAACoC,cAC9B,CAAC,CAAE,CAAA5D,QAAA,cAEHT,IAAA,CAAClC,MAAM,EACLsG,SAAS,CAAErH,OAAO,CAACuH,kBAAmB,CACtCC,OAAO,CAAE,CAAE,CACXV,KAAK,CAAE,CACL;AACA;AACAW,SAAS,IAAAC,MAAA,CAAKxC,QAAQ,CAACyC,MAAM,CAAG,GAAG,MACrC,CAAE,CAAAjE,QAAA,cAEFT,IAAA,CAACxC,oBAAoB,EACnByE,QAAQ,CAAEA,QAAS,CACnBG,QAAQ,CAAEA,QAAS,CACnBuC,YAAY,CAAE3C,aAAa,CAAC2C,YAAa,EACzC,EACK,EACD,EACX,CAED,GAAM,CAAAC,wBAAwB,CAAG,QAA3B,CAAAA,wBAAwBA,CAAA,CAAS,KAAAC,qBAAA,CACrC,GAAM,CAAAC,gCAAgC,CAAG3H,wBAAwB,CAC/D8E,QAAQ,CACRG,QAAQ,CACT,CAED,mBACEpC,IAAA,CAACpC,kBAAkB,EAACmH,IAAI,CAAC,KAAK,CAAAtE,QAAA,cAC5BP,KAAA,QAAKkE,SAAS,CAAC,uBAAuB,CAAA3D,QAAA,eACpCP,KAAA,CAAC7B,KAAK,CAAC2G,GAAG,EAACC,GAAG,CAAE,CAAE,CAACb,SAAS,CAAEvH,IAAI,CAAC,oBAAoB,CAAE,CAAA4D,QAAA,EACtDmD,mBAAmB,EAAE,CACrBkB,gCAAgC,EAAIZ,0BAA0B,EAAE,GACvD,CACX,CAACjC,QAAQ,CAACiD,eAAe,eACxBlF,IAAA,CAAC7B,OAAO,EAACgG,OAAO,CAAC,QAAQ,CAACC,SAAS,CAAC,gBAAgB,CAAA3D,QAAA,CACjD,SAAAA,SAAC0D,OAAwB,qBACxBjE,KAAA,QAAK2D,KAAK,CAAE,CAAEC,QAAQ,CAAE,UAAW,CAAE,CAAArD,QAAA,EAClCqC,mBAAmB,eAClB9C,IAAA,CAACiD,OAAO,CAACkC,8BAA8B,CAACnB,GAAG,IAC5C,cACDhE,IAAA,CAAC3B,KAAK,CAAC2G,GAAG,EAACC,GAAG,CAAE,CAAE,CAACG,KAAK,CAAC,OAAO,CAAA3E,QAAA,cAC9BT,IAAA,CAAC3B,KAAK,CAACgH,GAAG,EACRJ,GAAG,CAAE,CAAE,CACPb,SAAS,CAAEvH,IAAI,CAAC,uBAAuB,CAAE,CACvC,UAAU,CAAEoF,QAAQ,CAACoC,cACvB,CAAC,CAAE,CAAA5D,QAAA,cAEHP,KAAA,CAACpC,MAAM,EACLyG,OAAO,CAAE,CAAE,CACXH,SAAS,CAAEvH,IAAI,CAAC,aAAa,CAAE,CAC7B,UAAU,CAAEoF,QAAQ,CAACoC,cACvB,CAAC,CAAE,CAAA5D,QAAA,eAEHT,IAAA,CAACnC,UAAU,EACToE,QAAQ,CAAEA,QAAS,CACnBqD,QAAQ,CAAEtC,MAAM,CAACsC,QAAS,CAC1BtC,MAAM,CAAEA,MAAO,CACfD,GAAG,CAAEA,GAAI,EACT,CACDoB,OAAO,cACRjE,KAAA,CAAC7B,KAAK,CAACgH,GAAG,EAACJ,GAAG,CAAE,CAAE,CAAAxE,QAAA,eAChBT,IAAA,CAACxB,aAAa,EACZ6F,cAAc,CAAEpC,QAAQ,CAACoC,cAAe,CACxCkB,OAAO,CAAEtD,QAAQ,CAACuD,OAAQ,CAC1BC,QAAQ,CAAEjD,eAAgB,CAC1BlB,KAAK,CAAElE,CAAC,CAAC,iBAAiB,CAAE,CAC5BsI,WAAW,CAAEzD,QAAQ,CAACyD,WAAY,EAClC,cACF1F,IAAA,CAAChC,UAAU,EACTuH,OAAO,CAAEtD,QAAQ,CAAC0D,UAAU,CAACC,MAAO,CACpCH,QAAQ,CAAEnD,YAAa,CACvBhB,KAAK,CAAElE,CAAC,CAAC,cAAc,CAAE,EACzB,cAEF4C,IAAA,QAAKoE,SAAS,CAAC,sBAAsB,EAAG,cAExCpE,IAAA,CAACV,UAAU,EACTiG,OAAO,CAAEhG,gBAAgB,CAAC0C,QAAQ,CAAE,CACpCwD,QAAQ,CAAE,SAAAA,SAAA,QAAM,CAAAlD,gBAAgB,EAAE,EAAC,CACnCjB,KAAK,CAAElE,CAAC,CAAC,cAAc,CAAE,CACzBkI,QAAQ,OACR,cAEFtF,IAAA,CAACvC,cAAc,EACbwE,QAAQ,CAAEA,QAAS,CACnBI,MAAM,CAAEA,MAAO,CACfsD,UAAU,CAAE1D,QAAQ,CAAC0D,UAAW,CAChCxD,WAAW,CAAEA,WAAY,CACzBS,aAAa,CAAE,SAAAA,cAAAiD,KAAA,CAAqB,IAAlB,CAAAC,WAAW,CAAAD,KAAA,CAAXC,WAAW,CAC3BlD,cAAa,CAAC,CACZmD,sBAAsB,CAAED,WAAW,GAAK,OAC1C,CAAC,CAAC,CACJ,CAAE,EACF,GACQ,GACL,EACC,EACF,GACR,EACP,EAEJ,cACD5F,KAAA,QACEkE,SAAS,CAAEvH,IAAI,CACb,kDAAkD,CAClD,CACE,kBAAkB,CAAEoF,QAAQ,CAACoC,cAC/B,CAAC,CACD,CAAA5D,QAAA,eAEFT,IAAA,CAAC1B,QAAQ,EAAC0H,aAAa,CAAE/D,QAAQ,CAAC+D,aAAc,EAAG,CAClDtD,gBAAgB,SAAhBA,gBAAgB,iBAAhBA,gBAAgB,CAAGM,MAAM,CAACsC,QAAQ,CAAErD,QAAQ,CAAC,CAC7C,CAACA,QAAQ,CAACiD,eAAe,GACxB;AACC,CAACe,eAAe,EACf,EAAApB,qBAAA,CAAA5C,QAAQ,CAACiE,WAAW,UAAArB,qBAAA,iBAApBA,qBAAA,CAAsBsB,IAAI,IAAKnJ,eAAe,CAACmJ,IAAI,CAAC,eACpDnG,IAAA,CAACiD,OAAO,CAACmD,2BAA2B,CAACpC,GAAG,IACzC,GACC,GACF,EACa,CAEzB,CAAC,CAED,GAAM,CAAAqC,cAAc,CAAG,QAAjB,CAAAA,cAAcA,CAAA,CAAS,CAC3B,mBACErG,IAAA,CAACJ,cAAc,EACbY,UAAU,MACV8F,MAAM,CAAE,SAAAA,OAACC,MAAM,CAAK,CAClB9H,UAAU,CACR,SAAS,gBAAAgG,MAAA,CACM8B,MAAM,CAAG,MAAM,CAAG,QAAQ,UAAA9B,MAAA,CACrCzB,MAAM,CAACsC,QAAQ,CAAG,QAAQ,CAAG,SAAS,MAC3C,CACH,CAAE,EACF,CAEN,CAAC,CAED,GAAM,CAAAW,eAAe,CAAG/G,YAAY,CAACJ,mBAAmB,CAAEC,UAAU,CAAC,CAErE,GAAM,CAAAyH,UAAU,cACdtG,KAAA,CAAAE,SAAA,EAAAK,QAAA,EAIGA,QAAQ,cAITT,IAAA,CAACK,eAAe,EAACE,SAAS,CAAEA,SAAU,EAAG,cACzCP,IAAA,CAACJ,cAAc,CAAC6G,OAAO,EACrBjG,UAAU,MACVkG,IAAI,CAAEhH,WAAY,CAClB4B,KAAK,CAAEhE,gBAAgB,CAACF,CAAC,CAAC,iBAAiB,CAAC,CAAE,CAC9CuJ,QAAQ,CAAE,SAAAA,SAACC,IAAI,CAAK,CAClB,GAAIA,IAAI,CAAE,CACRnI,UAAU,CACR,SAAS,IAAAgG,MAAA,CACNzH,eAAe,CAACmJ,IAAI,uBAAA1B,MAAA,CACZzB,MAAM,CAACsC,QAAQ,CAAG,QAAQ,CAAG,SAAS,MAClD,CACH,CACF,CAAE,CACFuB,GAAG,CAAE7J,eAAe,CAAC8J,UAAW,CAAArG,QAAA,CAE/BrD,CAAC,CAAC,iBAAiB,CAAC,EACE,cACzB4C,IAAA,CAAC0B,6BAA6B,IAAG,CAGhCO,QAAQ,CAAC8E,SAAS,eAAI/G,IAAA,CAACjC,cAAc,EAACiJ,KAAK,CAAE,GAAI,EAAG,CACpD/E,QAAQ,CAACgF,YAAY,eACpBjH,IAAA,CAACtC,WAAW,EAACwJ,OAAO,CAAE,SAAAA,QAAA,QAAM,CAAA/E,WAAW,CAAC,CAAE8E,YAAY,CAAE,IAAK,CAAC,CAAC,EAAC,CAAAxG,QAAA,CAC7DwB,QAAQ,CAACgF,YAAY,EAEzB,CACA5D,eAAe,EAAI,CAACL,MAAM,CAACsC,QAAQ,eAClCtF,IAAA,CAACH,UAAU,EACTsH,gBAAgB,CAAE9D,eAAe,CAAC8D,gBAAiB,CACnDC,WAAW,CAAE/D,eAAe,CAAC+D,WAAY,CACzCC,QAAQ,CAAE,SAAAA,SAAA,CAAM,CACd/D,kBAAkB,CAAC,IAAI,CAAC,CAC1B,CAAE,CACFgE,QAAQ,CAAE,SAAAA,SAACC,KAAK,CAAEC,KAAK,CAAK,KAAAC,qBAAA,CAC1BnE,kBAAkB,CAAC,SAACoE,KAAK,CAAK,CAC5B,MAAO,CAAAA,KAAK,SAALA,KAAK,WAALA,KAAK,CAAEC,aAAa,EAAIH,KAAK,CAACI,MAAM,CAAGF,KAAK,CAAG,IAAI,CAC5D,CAAC,CAAC,CACFrE,eAAe,SAAfA,eAAe,kBAAAoE,qBAAA,CAAfpE,eAAe,CAAEiE,QAAQ,UAAAG,qBAAA,iBAAzBA,qBAAA,CAAAI,IAAA,CAAAxE,eAAe,CAAakE,KAAK,CAAEC,KAAK,CAAC,CAC3C,CAAE,EAEL,CACAvF,QAAQ,CAAC0B,UAAU,GAAK,MAAM,eAC7B3D,IAAA,CAAC5B,UAAU,EACT8I,OAAO,CAAE,SAAAA,QAAA,CAAM,CACb/E,WAAW,CAAC,CAAEwB,UAAU,CAAE,IAAK,CAAC,CAAC,CACnC,CAAE,EAEL,cACD3D,IAAA,CAACZ,mBAAmB,IAAG,cACvBY,IAAA,CAACiD,OAAO,CAAC6E,4BAA4B,CAAC9D,GAAG,IAAG,CAC3CP,uBAAuB,EAAE,CACzBF,sBAAsB,EAAE,CACxBtB,QAAQ,CAAC8F,WAAW,CAACC,KAAK,eACzBhI,IAAA,CAAC9B,gBAAgB,EACfiE,WAAW,CAAEA,WAAY,CACzBF,QAAQ,CAAEA,QAAS,CACnBiF,OAAO,CAAE,SAAAA,QAAA,QACP,CAAA/E,WAAW,CAAC,CACV4F,WAAW,CAAE,CAAEC,KAAK,CAAE,KAAK,CAAEC,IAAI,CAAE,IAAK,CAC1C,CAAC,CAAC,EACH,EAEJ,CACAjF,MAAM,CAACsC,QAAQ,eACdtF,IAAA,CAAC/B,UAAU,EACT8E,GAAG,CAAEA,GAAI,CACTd,QAAQ,CAAEA,QAAS,CACnBG,QAAQ,CAAEA,QAAS,CACnBJ,aAAa,CAAEA,aAAc,CAC7BuB,sBAAsB,CAAEA,sBAAuB,CAC/CE,uBAAuB,CAAEA,uBAAwB,CACjDtB,WAAW,CAAEA,WAAY,CACzBG,YAAY,CAAEA,YAAa,CAC3BC,gBAAgB,CAAEA,gBAAiB,CACnCC,eAAe,CAAEA,eAAgB,CACjCH,MAAM,CAAEA,MAAO,CACfO,aAAa,CAAEA,cAAc,CAC7BF,gBAAgB,CAAEA,gBAAiB,CACnCC,iBAAiB,CAAEA,iBAAkB,CACrC0D,cAAc,CAAEA,cAAe,CAC/BrD,MAAM,CAAEA,MAAO,CACfF,mBAAmB,CAAEA,mBAAoB,EAE5C,CACA,CAACE,MAAM,CAACsC,QAAQ,eACfpF,KAAA,CAAAE,SAAA,EAAAK,QAAA,eACEP,KAAA,QACEkE,SAAS,CAAEvH,IAAI,CAAC,mBAAmB,CAAE,CACnC,uBAAuB,CACrBoF,QAAQ,CAACiG,eAAe,EACxBjG,QAAQ,CAACkG,eAAe,EACvBlG,QAAQ,CAACmG,cAAc,EACtB,CAAClL,aAAa,CAAC+E,QAAQ,CAACmG,cAAc,CAC5C,CAAC,CAAE,CACHvE,KAAK,CACH5B,QAAQ,CAACiE,WAAW,EACpBD,eAAe,EACfjD,MAAM,CAACqF,mBAAmB,CACtB,CAAEC,KAAK,gBAAA7D,MAAA,CAAiBxH,qBAAqB,OAAM,CAAC,CACpD,CAAC,CACN,CAAAwD,QAAA,EAEAqC,mBAAmB,eAAI9C,IAAA,CAACiD,OAAO,CAACsF,yBAAyB,CAACvE,GAAG,IAAG,CAChEY,wBAAwB,EAAE,cAC3B5E,IAAA,CAACnB,MAAM,EACLoD,QAAQ,CAAEA,QAAS,CACnBD,aAAa,CAAEA,aAAc,CAC7BS,kBAAkB,CAAEA,kBAAmB,CACvCK,mBAAmB,CAAEA,mBAAoB,EACzC,CACDb,QAAQ,CAACuG,SAAS,eACjBxI,IAAA,CAACrB,KAAK,EACJsD,QAAQ,CAAEA,QAAS,CACnBE,WAAW,CAAEA,WAAY,CACzBC,QAAQ,CAAEA,QAAS,CACnB8E,OAAO,CAAE,SAAAA,QAAA,CAAM,CACblF,aAAa,CAACyG,aAAa,CAAC7J,iBAAiB,CAAC,CAChD,CAAE,CACF+D,iBAAiB,CAAEA,iBAAkB,EAExC,CACAV,QAAQ,CAACyG,eAAe,eACvB1I,IAAA,WACEoE,SAAS,CAAC,wBAAwB,CAClCuE,OAAO,CAAE,SAAAA,QAAA,CAAM,CACbxG,WAAW,CAAC,SAACF,QAAQ,SAAA2G,aAAA,IAChBvL,qBAAqB,CAAC+E,QAAQ,CAAEH,QAAQ,CAAEI,MAAM,CAAC,GACpD,CAAC,CACL,CAAE,CAAA5B,QAAA,CAEDrD,CAAC,CAAC,6BAA6B,CAAC,EAEpC,GACG,CACLiJ,cAAc,EAAE,GAEpB,GAEJ,CAED,mBACErG,IAAA,CAACL,iBAAiB,CAACX,QAAQ,EAAC6J,KAAK,CAAE5G,QAAS,CAAAxB,QAAA,cAC1CT,IAAA,CAAChB,QAAQ,EAAC8J,KAAK,CAAE7F,OAAO,CAAClE,UAAW,CAAA0B,QAAA,cAClCT,IAAA,CAACR,cAAc,CAACR,QAAQ,EAAC6J,KAAK,CAAE5F,OAAQ,CAAAxC,QAAA,CACrC+F,UAAU,EACa,EACjB,EACgB,CAEjC,CAAC,CAED,GAAM,CAAAuC,4BAA4B,CAAG,QAA/B,CAAAA,4BAA4BA,CAAI9G,QAAkB,CAAiB,CACvE,GACE,CAAA+G,iBAAiB,CAMf/G,QAAQ,CANV+G,iBAAiB,CACjBC,iBAAiB,CAKfhH,QAAQ,CALVgH,iBAAiB,CACjBC,YAAY,CAIVjH,QAAQ,CAJViH,YAAY,CACZC,OAAO,CAGLlH,QAAQ,CAHVkH,OAAO,CACPC,OAAO,CAELnH,QAAQ,CAFVmH,OAAO,CACJC,GAAG,CAAAC,wBAAA,CACJrH,QAAQ,CAAAsH,SAAA,EACZ,MAAO,CAAAF,GAAG,CACZ,CAAC,CAED,GAAM,CAAAG,QAAQ,CAAG,QAAX,CAAAA,QAAQA,CAAIC,SAAuB,CAAEC,SAAuB,CAAK,CACrE;AACA,GAAID,SAAS,CAAChJ,QAAQ,GAAKiJ,SAAS,CAACjJ,QAAQ,CAAE,CAC7C,MAAO,MAAK,CACd,CAEA,GAAgB,CAAAkJ,WAAW,CAAsCF,SAAS,CAAlEpH,MAAM,CAAyBuH,YAAY,CAAcH,SAAS,CAA7CxH,QAAQ,CAAmB4H,IAAI,CAAAP,wBAAA,CAAKG,SAAS,CAAAK,UAAA,EAC1E,GAAgB,CAAAC,WAAW,CAAsCL,SAAS,CAAlErH,MAAM,CAAyB2H,YAAY,CAAcN,SAAS,CAA7CzH,QAAQ,CAAmBgI,IAAI,CAAAX,wBAAA,CAAKI,SAAS,CAAAQ,UAAA,EAE1E,MACE,CAAA3M,cAAc,CACZ;AACA;AACAwL,4BAA4B,CAACa,YAAY,CAAa,CACtDb,4BAA4B,CAACiB,YAAY,CAAa,CACtD,CACEG,kBAAkB,CAAE5M,cAAc,CAClC6M,gBAAgB,CAAE7M,cACpB,CAAC,CACF,EAAIA,cAAc,CAACsM,IAAI,CAAEI,IAAI,CAAC,CAEnC,CAAC,CAED,2BAAenN,KAAK,CAACuN,IAAI,CAACvI,OAAO,CAAE0H,QAAQ,CAAC"},"metadata":{},"sourceType":"module","externalDependencies":[]}