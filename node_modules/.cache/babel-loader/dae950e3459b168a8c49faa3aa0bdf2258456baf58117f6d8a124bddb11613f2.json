{"ast":null,"code":"import _defineProperty from\"D:/project/excalidraw-cn/node_modules/@babel/runtime/helpers/esm/defineProperty.js\";var _LOCAL_STATE_VERSIONS;import{STORAGE_KEYS}from\"../app_constants\";// in-memory state (this tab's current state) versions. Currently just\n// timestamps of the last time the state was saved to browser storage.\nvar LOCAL_STATE_VERSIONS=(_LOCAL_STATE_VERSIONS={},_defineProperty(_LOCAL_STATE_VERSIONS,STORAGE_KEYS.VERSION_DATA_STATE,-1),_defineProperty(_LOCAL_STATE_VERSIONS,STORAGE_KEYS.VERSION_FILES,-1),_LOCAL_STATE_VERSIONS);export var isBrowserStorageStateNewer=function isBrowserStorageStateNewer(type){var storageTimestamp=JSON.parse(localStorage.getItem(type)||\"-1\");return storageTimestamp>LOCAL_STATE_VERSIONS[type];};export var updateBrowserStateVersion=function updateBrowserStateVersion(type){var timestamp=Date.now();localStorage.setItem(type,JSON.stringify(timestamp));LOCAL_STATE_VERSIONS[type]=timestamp;};export var resetBrowserStateVersions=function resetBrowserStateVersions(){for(var _i=0,_arr=Object.keys(LOCAL_STATE_VERSIONS);_i<_arr.length;_i++){var key=_arr[_i];var timestamp=-1;localStorage.setItem(key,JSON.stringify(timestamp));LOCAL_STATE_VERSIONS[key]=timestamp;}};","map":{"version":3,"names":["STORAGE_KEYS","LOCAL_STATE_VERSIONS","_LOCAL_STATE_VERSIONS","_defineProperty","VERSION_DATA_STATE","VERSION_FILES","isBrowserStorageStateNewer","type","storageTimestamp","JSON","parse","localStorage","getItem","updateBrowserStateVersion","timestamp","Date","now","setItem","stringify","resetBrowserStateVersions","_i","_arr","Object","keys","length","key"],"sources":["D:/project/excalidraw-cn/src/excalidraw-app/data/tabSync.ts"],"sourcesContent":["import { STORAGE_KEYS } from \"../app_constants\";\n\n// in-memory state (this tab's current state) versions. Currently just\n// timestamps of the last time the state was saved to browser storage.\nconst LOCAL_STATE_VERSIONS = {\n  [STORAGE_KEYS.VERSION_DATA_STATE]: -1,\n  [STORAGE_KEYS.VERSION_FILES]: -1,\n};\n\ntype BrowserStateTypes = keyof typeof LOCAL_STATE_VERSIONS;\n\nexport const isBrowserStorageStateNewer = (type: BrowserStateTypes) => {\n  const storageTimestamp = JSON.parse(localStorage.getItem(type) || \"-1\");\n  return storageTimestamp > LOCAL_STATE_VERSIONS[type];\n};\n\nexport const updateBrowserStateVersion = (type: BrowserStateTypes) => {\n  const timestamp = Date.now();\n  localStorage.setItem(type, JSON.stringify(timestamp));\n  LOCAL_STATE_VERSIONS[type] = timestamp;\n};\n\nexport const resetBrowserStateVersions = () => {\n  for (const key of Object.keys(LOCAL_STATE_VERSIONS) as BrowserStateTypes[]) {\n    const timestamp = -1;\n    localStorage.setItem(key, JSON.stringify(timestamp));\n    LOCAL_STATE_VERSIONS[key] = timestamp;\n  }\n};\n"],"mappings":"0IAAA,OAASA,YAAY,KAAQ,kBAAkB,CAE/C;AACA;AACA,GAAM,CAAAC,oBAAoB,EAAAC,qBAAA,IAAAC,eAAA,CAAAD,qBAAA,CACvBF,YAAY,CAACI,kBAAkB,CAAG,CAAC,CAAC,EAAAD,eAAA,CAAAD,qBAAA,CACpCF,YAAY,CAACK,aAAa,CAAG,CAAC,CAAC,EAAAH,qBAAA,CACjC,CAID,MAAO,IAAM,CAAAI,0BAA0B,CAAG,QAA7B,CAAAA,0BAA0BA,CAAIC,IAAuB,CAAK,CACrE,GAAM,CAAAC,gBAAgB,CAAGC,IAAI,CAACC,KAAK,CAACC,YAAY,CAACC,OAAO,CAACL,IAAI,CAAC,EAAI,IAAI,CAAC,CACvE,MAAO,CAAAC,gBAAgB,CAAGP,oBAAoB,CAACM,IAAI,CAAC,CACtD,CAAC,CAED,MAAO,IAAM,CAAAM,yBAAyB,CAAG,QAA5B,CAAAA,yBAAyBA,CAAIN,IAAuB,CAAK,CACpE,GAAM,CAAAO,SAAS,CAAGC,IAAI,CAACC,GAAG,EAAE,CAC5BL,YAAY,CAACM,OAAO,CAACV,IAAI,CAAEE,IAAI,CAACS,SAAS,CAACJ,SAAS,CAAC,CAAC,CACrDb,oBAAoB,CAACM,IAAI,CAAC,CAAGO,SAAS,CACxC,CAAC,CAED,MAAO,IAAM,CAAAK,yBAAyB,CAAG,QAA5B,CAAAA,yBAAyBA,CAAA,CAAS,CAC7C,QAAAC,EAAA,GAAAC,IAAA,CAAkBC,MAAM,CAACC,IAAI,CAACtB,oBAAoB,CAAC,CAAAmB,EAAA,CAAAC,IAAA,CAAAG,MAAA,CAAAJ,EAAA,GAAyB,CAAvE,GAAM,CAAAK,GAAG,CAAAJ,IAAA,CAAAD,EAAA,EACZ,GAAM,CAAAN,SAAS,CAAG,CAAC,CAAC,CACpBH,YAAY,CAACM,OAAO,CAACQ,GAAG,CAAEhB,IAAI,CAACS,SAAS,CAACJ,SAAS,CAAC,CAAC,CACpDb,oBAAoB,CAACwB,GAAG,CAAC,CAAGX,SAAS,CACvC,CACF,CAAC"},"metadata":{},"sourceType":"module","externalDependencies":[]}