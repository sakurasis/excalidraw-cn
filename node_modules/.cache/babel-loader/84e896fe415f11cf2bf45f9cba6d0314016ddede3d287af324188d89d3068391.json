{"ast":null,"code":"import _slicedToArray from\"D:/project/excalidraw-cn/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import clsx from\"clsx\";import{memo,useEffect,useRef,useState}from\"react\";import{useDevice}from\"../components/App\";import\"./LibraryUnit.scss\";import{CheckboxItem}from\"./CheckboxItem\";import{PlusIcon}from\"./icons\";import{useLibraryItemSvg}from\"../hooks/useLibraryItemSvg\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";export var LibraryUnit=/*#__PURE__*/memo(function(_ref){var id=_ref.id,elements=_ref.elements,isPending=_ref.isPending,onClick=_ref.onClick,selected=_ref.selected,onToggle=_ref.onToggle,onDrag=_ref.onDrag,svgCache=_ref.svgCache;var ref=useRef(null);var svg=useLibraryItemSvg(id,elements,svgCache);useEffect(function(){var node=ref.current;if(!node){return;}if(svg){node.innerHTML=svg.outerHTML;}return function(){node.innerHTML=\"\";};},[svg]);var _useState=useState(false),_useState2=_slicedToArray(_useState,2),isHovered=_useState2[0],setIsHovered=_useState2[1];var isMobile=useDevice().isMobile;var adder=isPending&&/*#__PURE__*/_jsx(\"div\",{className:\"library-unit__adder\",children:PlusIcon});return/*#__PURE__*/_jsxs(\"div\",{className:clsx(\"library-unit\",{\"library-unit__active\":elements,\"library-unit--hover\":elements&&isHovered,\"library-unit--selected\":selected,\"library-unit--skeleton\":!svg}),onMouseEnter:function onMouseEnter(){return setIsHovered(true);},onMouseLeave:function onMouseLeave(){return setIsHovered(false);},children:[/*#__PURE__*/_jsx(\"div\",{className:clsx(\"library-unit__dragger\",{\"library-unit__pulse\":!!isPending}),ref:ref,draggable:!!elements,onClick:!!elements||!!isPending?function(event){if(id&&event.shiftKey){onToggle(id,event);}else{onClick(id);}}:undefined,onDragStart:function onDragStart(event){if(!id){event.preventDefault();return;}setIsHovered(false);onDrag(id,event);}}),adder,id&&elements&&(isHovered||isMobile||selected)&&/*#__PURE__*/_jsx(CheckboxItem,{checked:selected,onChange:function onChange(checked,event){return onToggle(id,event);},className:\"library-unit__checkbox\"})]});});export var EmptyLibraryUnit=function EmptyLibraryUnit(){return/*#__PURE__*/_jsx(\"div\",{className:\"library-unit library-unit--skeleton\"});};","map":{"version":3,"names":["clsx","memo","useEffect","useRef","useState","useDevice","CheckboxItem","PlusIcon","useLibraryItemSvg","jsx","_jsx","jsxs","_jsxs","LibraryUnit","_ref","id","elements","isPending","onClick","selected","onToggle","onDrag","svgCache","ref","svg","node","current","innerHTML","outerHTML","_useState","_useState2","_slicedToArray","isHovered","setIsHovered","isMobile","adder","className","children","onMouseEnter","onMouseLeave","draggable","event","shiftKey","undefined","onDragStart","preventDefault","checked","onChange","EmptyLibraryUnit"],"sources":["D:/project/excalidraw-cn/src/components/LibraryUnit.tsx"],"sourcesContent":["import clsx from \"clsx\";\nimport { memo, useEffect, useRef, useState } from \"react\";\nimport { useDevice } from \"../components/App\";\nimport { LibraryItem } from \"../types\";\nimport \"./LibraryUnit.scss\";\nimport { CheckboxItem } from \"./CheckboxItem\";\nimport { PlusIcon } from \"./icons\";\nimport { SvgCache, useLibraryItemSvg } from \"../hooks/useLibraryItemSvg\";\n\nexport const LibraryUnit = memo(\n  ({\n    id,\n    elements,\n    isPending,\n    onClick,\n    selected,\n    onToggle,\n    onDrag,\n    svgCache,\n  }: {\n    id: LibraryItem[\"id\"] | /** for pending item */ null;\n    elements?: LibraryItem[\"elements\"];\n    isPending?: boolean;\n    onClick: (id: LibraryItem[\"id\"] | null) => void;\n    selected: boolean;\n    onToggle: (id: string, event: React.MouseEvent) => void;\n    onDrag: (id: string, event: React.DragEvent) => void;\n    svgCache: SvgCache;\n  }) => {\n    const ref = useRef<HTMLDivElement | null>(null);\n    const svg = useLibraryItemSvg(id, elements, svgCache);\n\n    useEffect(() => {\n      const node = ref.current;\n\n      if (!node) {\n        return;\n      }\n\n      if (svg) {\n        node.innerHTML = svg.outerHTML;\n      }\n\n      return () => {\n        node.innerHTML = \"\";\n      };\n    }, [svg]);\n\n    const [isHovered, setIsHovered] = useState(false);\n    const isMobile = useDevice().isMobile;\n    const adder = isPending && (\n      <div className=\"library-unit__adder\">{PlusIcon}</div>\n    );\n\n    return (\n      <div\n        className={clsx(\"library-unit\", {\n          \"library-unit__active\": elements,\n          \"library-unit--hover\": elements && isHovered,\n          \"library-unit--selected\": selected,\n          \"library-unit--skeleton\": !svg,\n        })}\n        onMouseEnter={() => setIsHovered(true)}\n        onMouseLeave={() => setIsHovered(false)}\n      >\n        <div\n          className={clsx(\"library-unit__dragger\", {\n            \"library-unit__pulse\": !!isPending,\n          })}\n          ref={ref}\n          draggable={!!elements}\n          onClick={\n            !!elements || !!isPending\n              ? (event) => {\n                  if (id && event.shiftKey) {\n                    onToggle(id, event);\n                  } else {\n                    onClick(id);\n                  }\n                }\n              : undefined\n          }\n          onDragStart={(event) => {\n            if (!id) {\n              event.preventDefault();\n              return;\n            }\n            setIsHovered(false);\n            onDrag(id, event);\n          }}\n        />\n        {adder}\n        {id && elements && (isHovered || isMobile || selected) && (\n          <CheckboxItem\n            checked={selected}\n            onChange={(checked, event) => onToggle(id, event)}\n            className=\"library-unit__checkbox\"\n          />\n        )}\n      </div>\n    );\n  },\n);\n\nexport const EmptyLibraryUnit = () => (\n  <div className=\"library-unit library-unit--skeleton\" />\n);\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}