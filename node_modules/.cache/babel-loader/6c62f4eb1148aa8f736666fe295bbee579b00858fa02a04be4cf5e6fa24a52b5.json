{"ast":null,"code":"import _regeneratorRuntime from\"D:/project/excalidraw-cn/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _objectSpread from\"D:/project/excalidraw-cn/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import _asyncToGenerator from\"D:/project/excalidraw-cn/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import{exportCanvas}from\".\";import{getNonDeletedElements}from\"../element\";import{getFileHandleType,isImageFileHandleType}from\"./blob\";export var resaveAsImageWithScene=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(elements,appState,files){var _appState,exportBackground,viewBackgroundColor,name,fileHandle,fileHandleType;return _regeneratorRuntime().wrap(function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:_appState=appState,exportBackground=_appState.exportBackground,viewBackgroundColor=_appState.viewBackgroundColor,name=_appState.name,fileHandle=_appState.fileHandle;fileHandleType=getFileHandleType(fileHandle);if(!(!fileHandle||!isImageFileHandleType(fileHandleType))){_context.next=4;break;}throw new Error(\"fileHandle should exist and should be of type svg or png when resaving\");case 4:appState=_objectSpread(_objectSpread({},appState),{},{exportEmbedScene:true});_context.next=7;return exportCanvas(fileHandleType,getNonDeletedElements(elements),appState,files,{exportBackground:exportBackground,viewBackgroundColor:viewBackgroundColor,name:name,fileHandle:fileHandle});case 7:return _context.abrupt(\"return\",{fileHandle:fileHandle});case 8:case\"end\":return _context.stop();}},_callee);}));return function resaveAsImageWithScene(_x,_x2,_x3){return _ref.apply(this,arguments);};}();","map":{"version":3,"names":["exportCanvas","getNonDeletedElements","getFileHandleType","isImageFileHandleType","resaveAsImageWithScene","_ref","_asyncToGenerator","_regeneratorRuntime","mark","_callee","elements","appState","files","_appState","exportBackground","viewBackgroundColor","name","fileHandle","fileHandleType","wrap","_callee$","_context","prev","next","Error","_objectSpread","exportEmbedScene","abrupt","stop","_x","_x2","_x3","apply","arguments"],"sources":["D:/project/excalidraw-cn/src/data/resave.ts"],"sourcesContent":["import { ExcalidrawElement } from \"../element/types\";\nimport { AppState, BinaryFiles } from \"../types\";\nimport { exportCanvas } from \".\";\nimport { getNonDeletedElements } from \"../element\";\nimport { getFileHandleType, isImageFileHandleType } from \"./blob\";\n\nexport const resaveAsImageWithScene = async (\n  elements: readonly ExcalidrawElement[],\n  appState: AppState,\n  files: BinaryFiles,\n) => {\n  const { exportBackground, viewBackgroundColor, name, fileHandle } = appState;\n\n  const fileHandleType = getFileHandleType(fileHandle);\n\n  if (!fileHandle || !isImageFileHandleType(fileHandleType)) {\n    throw new Error(\n      \"fileHandle should exist and should be of type svg or png when resaving\",\n    );\n  }\n  appState = {\n    ...appState,\n    exportEmbedScene: true,\n  };\n\n  await exportCanvas(\n    fileHandleType,\n    getNonDeletedElements(elements),\n    appState,\n    files,\n    {\n      exportBackground,\n      viewBackgroundColor,\n      name,\n      fileHandle,\n    },\n  );\n\n  return { fileHandle };\n};\n"],"mappings":"yVAEA,OAASA,YAAY,KAAQ,GAAG,CAChC,OAASC,qBAAqB,KAAQ,YAAY,CAClD,OAASC,iBAAiB,CAAEC,qBAAqB,KAAQ,QAAQ,CAEjE,MAAO,IAAM,CAAAC,sBAAsB,6BAAAC,IAAA,CAAAC,iBAAA,cAAAC,mBAAA,GAAAC,IAAA,CAAG,SAAAC,QACpCC,QAAsC,CACtCC,QAAkB,CAClBC,KAAkB,MAAAC,SAAA,CAAAC,gBAAA,CAAAC,mBAAA,CAAAC,IAAA,CAAAC,UAAA,CAAAC,cAAA,QAAAX,mBAAA,GAAAY,IAAA,UAAAC,SAAAC,QAAA,iBAAAA,QAAA,CAAAC,IAAA,CAAAD,QAAA,CAAAE,IAAA,SAAAV,SAAA,CAEkDF,QAAQ,CAApEG,gBAAgB,CAAAD,SAAA,CAAhBC,gBAAgB,CAAEC,mBAAmB,CAAAF,SAAA,CAAnBE,mBAAmB,CAAEC,IAAI,CAAAH,SAAA,CAAJG,IAAI,CAAEC,UAAU,CAAAJ,SAAA,CAAVI,UAAU,CAEzDC,cAAc,CAAGhB,iBAAiB,CAACe,UAAU,CAAC,MAEhD,CAACA,UAAU,EAAI,CAACd,qBAAqB,CAACe,cAAc,CAAC,GAAAG,QAAA,CAAAE,IAAA,eACjD,IAAI,CAAAC,KAAK,CACb,wEAAwE,CACzE,QAEHb,QAAQ,CAAAc,aAAA,CAAAA,aAAA,IACHd,QAAQ,MACXe,gBAAgB,CAAE,IAAI,EACvB,CAACL,QAAA,CAAAE,IAAA,SAEI,CAAAvB,YAAY,CAChBkB,cAAc,CACdjB,qBAAqB,CAACS,QAAQ,CAAC,CAC/BC,QAAQ,CACRC,KAAK,CACL,CACEE,gBAAgB,CAAhBA,gBAAgB,CAChBC,mBAAmB,CAAnBA,mBAAmB,CACnBC,IAAI,CAAJA,IAAI,CACJC,UAAU,CAAVA,UACF,CAAC,CACF,eAAAI,QAAA,CAAAM,MAAA,UAEM,CAAEV,UAAU,CAAVA,UAAW,CAAC,0BAAAI,QAAA,CAAAO,IAAA,MAAAnB,OAAA,GACtB,kBAjCY,CAAAL,sBAAsBA,CAAAyB,EAAA,CAAAC,GAAA,CAAAC,GAAA,SAAA1B,IAAA,CAAA2B,KAAA,MAAAC,SAAA,OAiClC"},"metadata":{},"sourceType":"module","externalDependencies":[]}