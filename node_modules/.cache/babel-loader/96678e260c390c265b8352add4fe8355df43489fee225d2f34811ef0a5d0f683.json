{"ast":null,"code":"import _objectSpread from\"D:/project/excalidraw-cn/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import _slicedToArray from\"D:/project/excalidraw-cn/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import{getShortcutKey,sceneCoordsToViewportCoords,viewportCoordsToSceneCoords,wrapEvent}from\"../utils\";import{mutateElement}from\"./mutateElement\";import{register}from\"../actions/register\";import{ToolButton}from\"../components/ToolButton\";import{FreedrawIcon,LinkIcon,TrashIcon}from\"../components/icons\";import{t}from\"../i18n\";import{useCallback,useEffect,useLayoutEffect,useRef,useState}from\"react\";import clsx from\"clsx\";import{KEYS}from\"../keys\";import{DEFAULT_LINK_SIZE}from\"../renderer/renderElement\";import{rotate}from\"../math\";import{EVENT,HYPERLINK_TOOLTIP_DELAY,MIME_TYPES}from\"../constants\";import{getTooltipDiv,updateTooltipPosition}from\"../components/Tooltip\";import{getSelectedElements}from\"../scene\";import{isPointHittingElementBoundingBox}from\"./collision\";import{getElementAbsoluteCoords}from\"./\";import{isLocalLink,normalizeLink}from\"../data/url\";import\"./Hyperlink.scss\";import{trackEvent}from\"../analytics\";import{useExcalidrawAppState}from\"../components/App\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var CONTAINER_WIDTH=320;var SPACE_BOTTOM=85;var CONTAINER_PADDING=5;var CONTAINER_HEIGHT=42;var AUTO_HIDE_TIMEOUT=500;export var EXTERNAL_LINK_IMG=document.createElement(\"img\");EXTERNAL_LINK_IMG.src=\"data:\".concat(MIME_TYPES.svg,\", \").concat(encodeURIComponent(\"<svg xmlns=\\\"http://www.w3.org/2000/svg\\\" width=\\\"16\\\" height=\\\"16\\\" viewBox=\\\"0 0 24 24\\\" fill=\\\"none\\\" stroke=\\\"#1971c2\\\" stroke-width=\\\"2\\\" stroke-linecap=\\\"round\\\" stroke-linejoin=\\\"round\\\" class=\\\"feather feather-external-link\\\"><path d=\\\"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6\\\"></path><polyline points=\\\"15 3 21 3 21 9\\\"></polyline><line x1=\\\"10\\\" y1=\\\"14\\\" x2=\\\"21\\\" y2=\\\"3\\\"></line></svg>\"));var IS_HYPERLINK_TOOLTIP_VISIBLE=false;export var Hyperlink=function Hyperlink(_ref){var element=_ref.element,setAppState=_ref.setAppState,onLinkOpen=_ref.onLinkOpen;var appState=useExcalidrawAppState();var linkVal=element.link||\"\";var _useState=useState(linkVal),_useState2=_slicedToArray(_useState,2),inputVal=_useState2[0],setInputVal=_useState2[1];var inputRef=useRef(null);var isEditing=appState.showHyperlinkPopup===\"editor\"||!linkVal;var handleSubmit=useCallback(function(){if(!inputRef.current){return;}var link=normalizeLink(inputRef.current.value);if(!element.link&&link){trackEvent(\"hyperlink\",\"create\");}mutateElement(element,{link:link});setAppState({showHyperlinkPopup:\"info\"});},[element,setAppState]);useLayoutEffect(function(){return function(){handleSubmit();};},[handleSubmit]);useEffect(function(){var timeoutId=null;var handlePointerMove=function handlePointerMove(event){if(isEditing){return;}if(timeoutId){clearTimeout(timeoutId);}var shouldHide=shouldHideLinkPopup(element,appState,[event.clientX,event.clientY]);if(shouldHide){timeoutId=window.setTimeout(function(){setAppState({showHyperlinkPopup:false});},AUTO_HIDE_TIMEOUT);}};window.addEventListener(EVENT.POINTER_MOVE,handlePointerMove,false);return function(){window.removeEventListener(EVENT.POINTER_MOVE,handlePointerMove,false);if(timeoutId){clearTimeout(timeoutId);}};},[appState,element,isEditing,setAppState]);var handleRemove=useCallback(function(){trackEvent(\"hyperlink\",\"delete\");mutateElement(element,{link:null});if(isEditing){inputRef.current.value=\"\";}setAppState({showHyperlinkPopup:false});},[setAppState,element,isEditing]);var onEdit=function onEdit(){trackEvent(\"hyperlink\",\"edit\",\"popup-ui\");setAppState({showHyperlinkPopup:\"editor\"});};var _getCoordsForPopover=getCoordsForPopover(element,appState),x=_getCoordsForPopover.x,y=_getCoordsForPopover.y;if(appState.draggingElement||appState.resizingElement||appState.isRotating||appState.openMenu){return null;}return/*#__PURE__*/_jsxs(\"div\",{className:\"excalidraw-hyperlinkContainer\",style:{top:\"\".concat(y,\"px\"),left:\"\".concat(x,\"px\"),width:CONTAINER_WIDTH,padding:CONTAINER_PADDING},children:[isEditing?/*#__PURE__*/_jsx(\"input\",{className:clsx(\"excalidraw-hyperlinkContainer-input\"),placeholder:\"Type or paste your link here\",ref:inputRef,value:inputVal,onChange:function onChange(event){return setInputVal(event.target.value);},autoFocus:true,onKeyDown:function onKeyDown(event){event.stopPropagation();// prevent cmd/ctrl+k shortcut when editing link\nif(event[KEYS.CTRL_OR_CMD]&&event.key===KEYS.K){event.preventDefault();}if(event.key===KEYS.ENTER||event.key===KEYS.ESCAPE){handleSubmit();}}}):/*#__PURE__*/_jsx(\"a\",{href:normalizeLink(element.link||\"\"),className:clsx(\"excalidraw-hyperlinkContainer-link\",{\"d-none\":isEditing}),target:isLocalLink(element.link)?\"_self\":\"_blank\",onClick:function onClick(event){if(element.link&&onLinkOpen){var customEvent=wrapEvent(EVENT.EXCALIDRAW_LINK,event.nativeEvent);onLinkOpen(_objectSpread(_objectSpread({},element),{},{link:normalizeLink(element.link)}),customEvent);if(customEvent.defaultPrevented){event.preventDefault();}}},rel:\"noopener noreferrer\",children:element.link}),/*#__PURE__*/_jsxs(\"div\",{className:\"excalidraw-hyperlinkContainer__buttons\",children:[!isEditing&&/*#__PURE__*/_jsx(ToolButton,{type:\"button\",title:t(\"buttons.edit\"),\"aria-label\":t(\"buttons.edit\"),label:t(\"buttons.edit\"),onClick:onEdit,className:\"excalidraw-hyperlinkContainer--edit\",icon:FreedrawIcon}),linkVal&&/*#__PURE__*/_jsx(ToolButton,{type:\"button\",title:t(\"buttons.remove\"),\"aria-label\":t(\"buttons.remove\"),label:t(\"buttons.remove\"),onClick:handleRemove,className:\"excalidraw-hyperlinkContainer--remove\",icon:TrashIcon})]})]});};var getCoordsForPopover=function getCoordsForPopover(element,appState){var _getElementAbsoluteCo=getElementAbsoluteCoords(element),_getElementAbsoluteCo2=_slicedToArray(_getElementAbsoluteCo,2),x1=_getElementAbsoluteCo2[0],y1=_getElementAbsoluteCo2[1];var _sceneCoordsToViewpor=sceneCoordsToViewportCoords({sceneX:x1+element.width/2,sceneY:y1},appState),viewportX=_sceneCoordsToViewpor.x,viewportY=_sceneCoordsToViewpor.y;var x=viewportX-appState.offsetLeft-CONTAINER_WIDTH/2;var y=viewportY-appState.offsetTop-SPACE_BOTTOM;return{x:x,y:y};};export var actionLink=register({name:\"hyperlink\",perform:function perform(elements,appState){if(appState.showHyperlinkPopup===\"editor\"){return false;}return{elements:elements,appState:_objectSpread(_objectSpread({},appState),{},{showHyperlinkPopup:\"editor\",openMenu:null}),commitToHistory:true};},trackEvent:{category:\"hyperlink\",action:\"click\"},keyTest:function keyTest(event){return event[KEYS.CTRL_OR_CMD]&&event.key===KEYS.K;},contextItemLabel:function contextItemLabel(elements,appState){return getContextMenuLabel(elements,appState);},predicate:function predicate(elements,appState){var selectedElements=getSelectedElements(elements,appState);return selectedElements.length===1;},PanelComponent:function PanelComponent(_ref2){var elements=_ref2.elements,appState=_ref2.appState,updateData=_ref2.updateData;var selectedElements=getSelectedElements(elements,appState);return/*#__PURE__*/_jsx(ToolButton,{type:\"button\",icon:LinkIcon,\"aria-label\":t(getContextMenuLabel(elements,appState)),title:\"\".concat(t(\"labels.link.label\"),\" - \").concat(getShortcutKey(\"CtrlOrCmd+K\")),onClick:function onClick(){return updateData(null);},selected:selectedElements.length===1&&!!selectedElements[0].link});}});export var getContextMenuLabel=function getContextMenuLabel(elements,appState){var selectedElements=getSelectedElements(elements,appState);var label=selectedElements[0].link?\"labels.link.edit\":\"labels.link.create\";return label;};export var getLinkHandleFromCoords=function getLinkHandleFromCoords(_ref3,angle,appState){var _ref4=_slicedToArray(_ref3,4),x1=_ref4[0],y1=_ref4[1],x2=_ref4[2],y2=_ref4[3];var size=DEFAULT_LINK_SIZE;var linkWidth=size/appState.zoom.value;var linkHeight=size/appState.zoom.value;var linkMarginY=size/appState.zoom.value;var centerX=(x1+x2)/2;var centerY=(y1+y2)/2;var centeringOffset=(size-8)/(2*appState.zoom.value);var dashedLineMargin=4/appState.zoom.value;// Same as `ne` resize handle\nvar x=x2+dashedLineMargin-centeringOffset;var y=y1-dashedLineMargin-linkMarginY+centeringOffset;var _rotate=rotate(x+linkWidth/2,y+linkHeight/2,centerX,centerY,angle),_rotate2=_slicedToArray(_rotate,2),rotatedX=_rotate2[0],rotatedY=_rotate2[1];return[rotatedX-linkWidth/2,rotatedY-linkHeight/2,linkWidth,linkHeight];};export var isPointHittingLinkIcon=function isPointHittingLinkIcon(element,appState,_ref5,isMobile){var _ref6=_slicedToArray(_ref5,2),x=_ref6[0],y=_ref6[1];if(!element.link||appState.selectedElementIds[element.id]){return false;}var threshold=4/appState.zoom.value;if(!isMobile&&appState.viewModeEnabled&&isPointHittingElementBoundingBox(element,[x,y],threshold,null)){return true;}var _getElementAbsoluteCo3=getElementAbsoluteCoords(element),_getElementAbsoluteCo4=_slicedToArray(_getElementAbsoluteCo3,4),x1=_getElementAbsoluteCo4[0],y1=_getElementAbsoluteCo4[1],x2=_getElementAbsoluteCo4[2],y2=_getElementAbsoluteCo4[3];var _getLinkHandleFromCoo=getLinkHandleFromCoords([x1,y1,x2,y2],element.angle,appState),_getLinkHandleFromCoo2=_slicedToArray(_getLinkHandleFromCoo,4),linkX=_getLinkHandleFromCoo2[0],linkY=_getLinkHandleFromCoo2[1],linkWidth=_getLinkHandleFromCoo2[2],linkHeight=_getLinkHandleFromCoo2[3];var hitLink=x>linkX-threshold&&x<linkX+threshold+linkWidth&&y>linkY-threshold&&y<linkY+linkHeight+threshold;return hitLink;};var HYPERLINK_TOOLTIP_TIMEOUT_ID=null;export var showHyperlinkTooltip=function showHyperlinkTooltip(element,appState){if(HYPERLINK_TOOLTIP_TIMEOUT_ID){clearTimeout(HYPERLINK_TOOLTIP_TIMEOUT_ID);}HYPERLINK_TOOLTIP_TIMEOUT_ID=window.setTimeout(function(){return renderTooltip(element,appState);},HYPERLINK_TOOLTIP_DELAY);};var renderTooltip=function renderTooltip(element,appState){if(!element.link){return;}var tooltipDiv=getTooltipDiv();tooltipDiv.classList.add(\"excalidraw-tooltip--visible\");tooltipDiv.style.maxWidth=\"20rem\";tooltipDiv.textContent=element.link;var _getElementAbsoluteCo5=getElementAbsoluteCoords(element),_getElementAbsoluteCo6=_slicedToArray(_getElementAbsoluteCo5,4),x1=_getElementAbsoluteCo6[0],y1=_getElementAbsoluteCo6[1],x2=_getElementAbsoluteCo6[2],y2=_getElementAbsoluteCo6[3];var _getLinkHandleFromCoo3=getLinkHandleFromCoords([x1,y1,x2,y2],element.angle,appState),_getLinkHandleFromCoo4=_slicedToArray(_getLinkHandleFromCoo3,4),linkX=_getLinkHandleFromCoo4[0],linkY=_getLinkHandleFromCoo4[1],linkWidth=_getLinkHandleFromCoo4[2],linkHeight=_getLinkHandleFromCoo4[3];var linkViewportCoords=sceneCoordsToViewportCoords({sceneX:linkX,sceneY:linkY},appState);updateTooltipPosition(tooltipDiv,{left:linkViewportCoords.x,top:linkViewportCoords.y,width:linkWidth,height:linkHeight},\"top\");trackEvent(\"hyperlink\",\"tooltip\",\"link-icon\");IS_HYPERLINK_TOOLTIP_VISIBLE=true;};export var hideHyperlinkToolip=function hideHyperlinkToolip(){if(HYPERLINK_TOOLTIP_TIMEOUT_ID){clearTimeout(HYPERLINK_TOOLTIP_TIMEOUT_ID);}if(IS_HYPERLINK_TOOLTIP_VISIBLE){IS_HYPERLINK_TOOLTIP_VISIBLE=false;getTooltipDiv().classList.remove(\"excalidraw-tooltip--visible\");}};export var shouldHideLinkPopup=function shouldHideLinkPopup(element,appState,_ref7){var _ref8=_slicedToArray(_ref7,2),clientX=_ref8[0],clientY=_ref8[1];var _viewportCoordsToScen=viewportCoordsToSceneCoords({clientX:clientX,clientY:clientY},appState),sceneX=_viewportCoordsToScen.x,sceneY=_viewportCoordsToScen.y;var threshold=15/appState.zoom.value;// hitbox to prevent hiding when hovered in element bounding box\nif(isPointHittingElementBoundingBox(element,[sceneX,sceneY],threshold,null)){return false;}var _getElementAbsoluteCo7=getElementAbsoluteCoords(element),_getElementAbsoluteCo8=_slicedToArray(_getElementAbsoluteCo7,3),x1=_getElementAbsoluteCo8[0],y1=_getElementAbsoluteCo8[1],x2=_getElementAbsoluteCo8[2];// hit box to prevent hiding when hovered in the vertical area between element and popover\nif(sceneX>=x1&&sceneX<=x2&&sceneY>=y1-SPACE_BOTTOM&&sceneY<=y1){return false;}// hit box to prevent hiding when hovered around popover within threshold\nvar _getCoordsForPopover2=getCoordsForPopover(element,appState),popoverX=_getCoordsForPopover2.x,popoverY=_getCoordsForPopover2.y;if(clientX>=popoverX-threshold&&clientX<=popoverX+CONTAINER_WIDTH+CONTAINER_PADDING*2+threshold&&clientY>=popoverY-threshold&&clientY<=popoverY+threshold+CONTAINER_PADDING*2+CONTAINER_HEIGHT){return false;}return true;};","map":{"version":3,"names":["getShortcutKey","sceneCoordsToViewportCoords","viewportCoordsToSceneCoords","wrapEvent","mutateElement","register","ToolButton","FreedrawIcon","LinkIcon","TrashIcon","t","useCallback","useEffect","useLayoutEffect","useRef","useState","clsx","KEYS","DEFAULT_LINK_SIZE","rotate","EVENT","HYPERLINK_TOOLTIP_DELAY","MIME_TYPES","getTooltipDiv","updateTooltipPosition","getSelectedElements","isPointHittingElementBoundingBox","getElementAbsoluteCoords","isLocalLink","normalizeLink","trackEvent","useExcalidrawAppState","jsx","_jsx","jsxs","_jsxs","CONTAINER_WIDTH","SPACE_BOTTOM","CONTAINER_PADDING","CONTAINER_HEIGHT","AUTO_HIDE_TIMEOUT","EXTERNAL_LINK_IMG","document","createElement","src","concat","svg","encodeURIComponent","IS_HYPERLINK_TOOLTIP_VISIBLE","Hyperlink","_ref","element","setAppState","onLinkOpen","appState","linkVal","link","_useState","_useState2","_slicedToArray","inputVal","setInputVal","inputRef","isEditing","showHyperlinkPopup","handleSubmit","current","value","timeoutId","handlePointerMove","event","clearTimeout","shouldHide","shouldHideLinkPopup","clientX","clientY","window","setTimeout","addEventListener","POINTER_MOVE","removeEventListener","handleRemove","onEdit","_getCoordsForPopover","getCoordsForPopover","x","y","draggingElement","resizingElement","isRotating","openMenu","className","style","top","left","width","padding","children","placeholder","ref","onChange","target","autoFocus","onKeyDown","stopPropagation","CTRL_OR_CMD","key","K","preventDefault","ENTER","ESCAPE","href","onClick","customEvent","EXCALIDRAW_LINK","nativeEvent","_objectSpread","defaultPrevented","rel","type","title","label","icon","_getElementAbsoluteCo","_getElementAbsoluteCo2","x1","y1","_sceneCoordsToViewpor","sceneX","sceneY","viewportX","viewportY","offsetLeft","offsetTop","actionLink","name","perform","elements","commitToHistory","category","action","keyTest","contextItemLabel","getContextMenuLabel","predicate","selectedElements","length","PanelComponent","_ref2","updateData","selected","getLinkHandleFromCoords","_ref3","angle","_ref4","x2","y2","size","linkWidth","zoom","linkHeight","linkMarginY","centerX","centerY","centeringOffset","dashedLineMargin","_rotate","_rotate2","rotatedX","rotatedY","isPointHittingLinkIcon","_ref5","isMobile","_ref6","selectedElementIds","id","threshold","viewModeEnabled","_getElementAbsoluteCo3","_getElementAbsoluteCo4","_getLinkHandleFromCoo","_getLinkHandleFromCoo2","linkX","linkY","hitLink","HYPERLINK_TOOLTIP_TIMEOUT_ID","showHyperlinkTooltip","renderTooltip","tooltipDiv","classList","add","maxWidth","textContent","_getElementAbsoluteCo5","_getElementAbsoluteCo6","_getLinkHandleFromCoo3","_getLinkHandleFromCoo4","linkViewportCoords","height","hideHyperlinkToolip","remove","_ref7","_ref8","_viewportCoordsToScen","_getElementAbsoluteCo7","_getElementAbsoluteCo8","_getCoordsForPopover2","popoverX","popoverY"],"sources":["D:/project/excalidraw-cn/src/element/Hyperlink.tsx"],"sourcesContent":["import { AppState, ExcalidrawProps, Point, UIAppState } from \"../types\";\nimport {\n  getShortcutKey,\n  sceneCoordsToViewportCoords,\n  viewportCoordsToSceneCoords,\n  wrapEvent,\n} from \"../utils\";\nimport { mutateElement } from \"./mutateElement\";\nimport { NonDeletedExcalidrawElement } from \"./types\";\n\nimport { register } from \"../actions/register\";\nimport { ToolButton } from \"../components/ToolButton\";\nimport { FreedrawIcon, LinkIcon, TrashIcon } from \"../components/icons\";\nimport { t } from \"../i18n\";\nimport {\n  useCallback,\n  useEffect,\n  useLayoutEffect,\n  useRef,\n  useState,\n} from \"react\";\nimport clsx from \"clsx\";\nimport { KEYS } from \"../keys\";\nimport { DEFAULT_LINK_SIZE } from \"../renderer/renderElement\";\nimport { rotate } from \"../math\";\nimport { EVENT, HYPERLINK_TOOLTIP_DELAY, MIME_TYPES } from \"../constants\";\nimport { Bounds } from \"./bounds\";\nimport { getTooltipDiv, updateTooltipPosition } from \"../components/Tooltip\";\nimport { getSelectedElements } from \"../scene\";\nimport { isPointHittingElementBoundingBox } from \"./collision\";\nimport { getElementAbsoluteCoords } from \"./\";\nimport { isLocalLink, normalizeLink } from \"../data/url\";\n\nimport \"./Hyperlink.scss\";\nimport { trackEvent } from \"../analytics\";\nimport { useExcalidrawAppState } from \"../components/App\";\n\nconst CONTAINER_WIDTH = 320;\nconst SPACE_BOTTOM = 85;\nconst CONTAINER_PADDING = 5;\nconst CONTAINER_HEIGHT = 42;\nconst AUTO_HIDE_TIMEOUT = 500;\n\nexport const EXTERNAL_LINK_IMG = document.createElement(\"img\");\nEXTERNAL_LINK_IMG.src = `data:${MIME_TYPES.svg}, ${encodeURIComponent(\n  `<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"#1971c2\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\" class=\"feather feather-external-link\"><path d=\"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6\"></path><polyline points=\"15 3 21 3 21 9\"></polyline><line x1=\"10\" y1=\"14\" x2=\"21\" y2=\"3\"></line></svg>`,\n)}`;\n\nlet IS_HYPERLINK_TOOLTIP_VISIBLE = false;\n\nexport const Hyperlink = ({\n  element,\n  setAppState,\n  onLinkOpen,\n}: {\n  element: NonDeletedExcalidrawElement;\n  setAppState: React.Component<any, AppState>[\"setState\"];\n  onLinkOpen: ExcalidrawProps[\"onLinkOpen\"];\n}) => {\n  const appState = useExcalidrawAppState();\n\n  const linkVal = element.link || \"\";\n\n  const [inputVal, setInputVal] = useState(linkVal);\n  const inputRef = useRef<HTMLInputElement>(null);\n  const isEditing = appState.showHyperlinkPopup === \"editor\" || !linkVal;\n\n  const handleSubmit = useCallback(() => {\n    if (!inputRef.current) {\n      return;\n    }\n\n    const link = normalizeLink(inputRef.current.value);\n\n    if (!element.link && link) {\n      trackEvent(\"hyperlink\", \"create\");\n    }\n\n    mutateElement(element, { link });\n    setAppState({ showHyperlinkPopup: \"info\" });\n  }, [element, setAppState]);\n\n  useLayoutEffect(() => {\n    return () => {\n      handleSubmit();\n    };\n  }, [handleSubmit]);\n\n  useEffect(() => {\n    let timeoutId: number | null = null;\n    const handlePointerMove = (event: PointerEvent) => {\n      if (isEditing) {\n        return;\n      }\n      if (timeoutId) {\n        clearTimeout(timeoutId);\n      }\n      const shouldHide = shouldHideLinkPopup(element, appState, [\n        event.clientX,\n        event.clientY,\n      ]) as boolean;\n      if (shouldHide) {\n        timeoutId = window.setTimeout(() => {\n          setAppState({ showHyperlinkPopup: false });\n        }, AUTO_HIDE_TIMEOUT);\n      }\n    };\n    window.addEventListener(EVENT.POINTER_MOVE, handlePointerMove, false);\n    return () => {\n      window.removeEventListener(EVENT.POINTER_MOVE, handlePointerMove, false);\n      if (timeoutId) {\n        clearTimeout(timeoutId);\n      }\n    };\n  }, [appState, element, isEditing, setAppState]);\n\n  const handleRemove = useCallback(() => {\n    trackEvent(\"hyperlink\", \"delete\");\n    mutateElement(element, { link: null });\n    if (isEditing) {\n      inputRef.current!.value = \"\";\n    }\n    setAppState({ showHyperlinkPopup: false });\n  }, [setAppState, element, isEditing]);\n\n  const onEdit = () => {\n    trackEvent(\"hyperlink\", \"edit\", \"popup-ui\");\n    setAppState({ showHyperlinkPopup: \"editor\" });\n  };\n  const { x, y } = getCoordsForPopover(element, appState);\n  if (\n    appState.draggingElement ||\n    appState.resizingElement ||\n    appState.isRotating ||\n    appState.openMenu\n  ) {\n    return null;\n  }\n  return (\n    <div\n      className=\"excalidraw-hyperlinkContainer\"\n      style={{\n        top: `${y}px`,\n        left: `${x}px`,\n        width: CONTAINER_WIDTH,\n        padding: CONTAINER_PADDING,\n      }}\n    >\n      {isEditing ? (\n        <input\n          className={clsx(\"excalidraw-hyperlinkContainer-input\")}\n          placeholder=\"Type or paste your link here\"\n          ref={inputRef}\n          value={inputVal}\n          onChange={(event) => setInputVal(event.target.value)}\n          autoFocus\n          onKeyDown={(event) => {\n            event.stopPropagation();\n            // prevent cmd/ctrl+k shortcut when editing link\n            if (event[KEYS.CTRL_OR_CMD] && event.key === KEYS.K) {\n              event.preventDefault();\n            }\n            if (event.key === KEYS.ENTER || event.key === KEYS.ESCAPE) {\n              handleSubmit();\n            }\n          }}\n        />\n      ) : (\n        <a\n          href={normalizeLink(element.link || \"\")}\n          className={clsx(\"excalidraw-hyperlinkContainer-link\", {\n            \"d-none\": isEditing,\n          })}\n          target={isLocalLink(element.link) ? \"_self\" : \"_blank\"}\n          onClick={(event) => {\n            if (element.link && onLinkOpen) {\n              const customEvent = wrapEvent(\n                EVENT.EXCALIDRAW_LINK,\n                event.nativeEvent,\n              );\n              onLinkOpen(\n                {\n                  ...element,\n                  link: normalizeLink(element.link),\n                },\n                customEvent,\n              );\n              if (customEvent.defaultPrevented) {\n                event.preventDefault();\n              }\n            }\n          }}\n          rel=\"noopener noreferrer\"\n        >\n          {element.link}\n        </a>\n      )}\n      <div className=\"excalidraw-hyperlinkContainer__buttons\">\n        {!isEditing && (\n          <ToolButton\n            type=\"button\"\n            title={t(\"buttons.edit\")}\n            aria-label={t(\"buttons.edit\")}\n            label={t(\"buttons.edit\")}\n            onClick={onEdit}\n            className=\"excalidraw-hyperlinkContainer--edit\"\n            icon={FreedrawIcon}\n          />\n        )}\n\n        {linkVal && (\n          <ToolButton\n            type=\"button\"\n            title={t(\"buttons.remove\")}\n            aria-label={t(\"buttons.remove\")}\n            label={t(\"buttons.remove\")}\n            onClick={handleRemove}\n            className=\"excalidraw-hyperlinkContainer--remove\"\n            icon={TrashIcon}\n          />\n        )}\n      </div>\n    </div>\n  );\n};\n\nconst getCoordsForPopover = (\n  element: NonDeletedExcalidrawElement,\n  appState: AppState,\n) => {\n  const [x1, y1] = getElementAbsoluteCoords(element);\n  const { x: viewportX, y: viewportY } = sceneCoordsToViewportCoords(\n    { sceneX: x1 + element.width / 2, sceneY: y1 },\n    appState,\n  );\n  const x = viewportX - appState.offsetLeft - CONTAINER_WIDTH / 2;\n  const y = viewportY - appState.offsetTop - SPACE_BOTTOM;\n  return { x, y };\n};\n\nexport const actionLink = register({\n  name: \"hyperlink\",\n  perform: (elements, appState) => {\n    if (appState.showHyperlinkPopup === \"editor\") {\n      return false;\n    }\n\n    return {\n      elements,\n      appState: {\n        ...appState,\n        showHyperlinkPopup: \"editor\",\n        openMenu: null,\n      },\n      commitToHistory: true,\n    };\n  },\n  trackEvent: { category: \"hyperlink\", action: \"click\" },\n  keyTest: (event) => event[KEYS.CTRL_OR_CMD] && event.key === KEYS.K,\n  contextItemLabel: (elements, appState) =>\n    getContextMenuLabel(elements, appState),\n  predicate: (elements, appState) => {\n    const selectedElements = getSelectedElements(elements, appState);\n    return selectedElements.length === 1;\n  },\n  PanelComponent: ({ elements, appState, updateData }) => {\n    const selectedElements = getSelectedElements(elements, appState);\n\n    return (\n      <ToolButton\n        type=\"button\"\n        icon={LinkIcon}\n        aria-label={t(getContextMenuLabel(elements, appState))}\n        title={`${t(\"labels.link.label\")} - ${getShortcutKey(\"CtrlOrCmd+K\")}`}\n        onClick={() => updateData(null)}\n        selected={selectedElements.length === 1 && !!selectedElements[0].link}\n      />\n    );\n  },\n});\n\nexport const getContextMenuLabel = (\n  elements: readonly NonDeletedExcalidrawElement[],\n  appState: AppState,\n) => {\n  const selectedElements = getSelectedElements(elements, appState);\n  const label = selectedElements[0]!.link\n    ? \"labels.link.edit\"\n    : \"labels.link.create\";\n  return label;\n};\n\nexport const getLinkHandleFromCoords = (\n  [x1, y1, x2, y2]: Bounds,\n  angle: number,\n  appState: UIAppState,\n): [x: number, y: number, width: number, height: number] => {\n  const size = DEFAULT_LINK_SIZE;\n  const linkWidth = size / appState.zoom.value;\n  const linkHeight = size / appState.zoom.value;\n  const linkMarginY = size / appState.zoom.value;\n  const centerX = (x1 + x2) / 2;\n  const centerY = (y1 + y2) / 2;\n  const centeringOffset = (size - 8) / (2 * appState.zoom.value);\n  const dashedLineMargin = 4 / appState.zoom.value;\n\n  // Same as `ne` resize handle\n  const x = x2 + dashedLineMargin - centeringOffset;\n  const y = y1 - dashedLineMargin - linkMarginY + centeringOffset;\n\n  const [rotatedX, rotatedY] = rotate(\n    x + linkWidth / 2,\n    y + linkHeight / 2,\n    centerX,\n    centerY,\n    angle,\n  );\n  return [\n    rotatedX - linkWidth / 2,\n    rotatedY - linkHeight / 2,\n    linkWidth,\n    linkHeight,\n  ];\n};\n\nexport const isPointHittingLinkIcon = (\n  element: NonDeletedExcalidrawElement,\n  appState: AppState,\n  [x, y]: Point,\n  isMobile: boolean,\n) => {\n  if (!element.link || appState.selectedElementIds[element.id]) {\n    return false;\n  }\n  const threshold = 4 / appState.zoom.value;\n  if (\n    !isMobile &&\n    appState.viewModeEnabled &&\n    isPointHittingElementBoundingBox(element, [x, y], threshold, null)\n  ) {\n    return true;\n  }\n  const [x1, y1, x2, y2] = getElementAbsoluteCoords(element);\n\n  const [linkX, linkY, linkWidth, linkHeight] = getLinkHandleFromCoords(\n    [x1, y1, x2, y2],\n    element.angle,\n    appState,\n  );\n  const hitLink =\n    x > linkX - threshold &&\n    x < linkX + threshold + linkWidth &&\n    y > linkY - threshold &&\n    y < linkY + linkHeight + threshold;\n  return hitLink;\n};\n\nlet HYPERLINK_TOOLTIP_TIMEOUT_ID: number | null = null;\nexport const showHyperlinkTooltip = (\n  element: NonDeletedExcalidrawElement,\n  appState: AppState,\n) => {\n  if (HYPERLINK_TOOLTIP_TIMEOUT_ID) {\n    clearTimeout(HYPERLINK_TOOLTIP_TIMEOUT_ID);\n  }\n  HYPERLINK_TOOLTIP_TIMEOUT_ID = window.setTimeout(\n    () => renderTooltip(element, appState),\n    HYPERLINK_TOOLTIP_DELAY,\n  );\n};\n\nconst renderTooltip = (\n  element: NonDeletedExcalidrawElement,\n  appState: AppState,\n) => {\n  if (!element.link) {\n    return;\n  }\n\n  const tooltipDiv = getTooltipDiv();\n\n  tooltipDiv.classList.add(\"excalidraw-tooltip--visible\");\n  tooltipDiv.style.maxWidth = \"20rem\";\n  tooltipDiv.textContent = element.link;\n\n  const [x1, y1, x2, y2] = getElementAbsoluteCoords(element);\n\n  const [linkX, linkY, linkWidth, linkHeight] = getLinkHandleFromCoords(\n    [x1, y1, x2, y2],\n    element.angle,\n    appState,\n  );\n\n  const linkViewportCoords = sceneCoordsToViewportCoords(\n    { sceneX: linkX, sceneY: linkY },\n    appState,\n  );\n\n  updateTooltipPosition(\n    tooltipDiv,\n    {\n      left: linkViewportCoords.x,\n      top: linkViewportCoords.y,\n      width: linkWidth,\n      height: linkHeight,\n    },\n    \"top\",\n  );\n  trackEvent(\"hyperlink\", \"tooltip\", \"link-icon\");\n\n  IS_HYPERLINK_TOOLTIP_VISIBLE = true;\n};\nexport const hideHyperlinkToolip = () => {\n  if (HYPERLINK_TOOLTIP_TIMEOUT_ID) {\n    clearTimeout(HYPERLINK_TOOLTIP_TIMEOUT_ID);\n  }\n  if (IS_HYPERLINK_TOOLTIP_VISIBLE) {\n    IS_HYPERLINK_TOOLTIP_VISIBLE = false;\n    getTooltipDiv().classList.remove(\"excalidraw-tooltip--visible\");\n  }\n};\n\nexport const shouldHideLinkPopup = (\n  element: NonDeletedExcalidrawElement,\n  appState: AppState,\n  [clientX, clientY]: Point,\n): Boolean => {\n  const { x: sceneX, y: sceneY } = viewportCoordsToSceneCoords(\n    { clientX, clientY },\n    appState,\n  );\n\n  const threshold = 15 / appState.zoom.value;\n  // hitbox to prevent hiding when hovered in element bounding box\n  if (\n    isPointHittingElementBoundingBox(element, [sceneX, sceneY], threshold, null)\n  ) {\n    return false;\n  }\n  const [x1, y1, x2] = getElementAbsoluteCoords(element);\n  // hit box to prevent hiding when hovered in the vertical area between element and popover\n  if (\n    sceneX >= x1 &&\n    sceneX <= x2 &&\n    sceneY >= y1 - SPACE_BOTTOM &&\n    sceneY <= y1\n  ) {\n    return false;\n  }\n  // hit box to prevent hiding when hovered around popover within threshold\n  const { x: popoverX, y: popoverY } = getCoordsForPopover(element, appState);\n\n  if (\n    clientX >= popoverX - threshold &&\n    clientX <= popoverX + CONTAINER_WIDTH + CONTAINER_PADDING * 2 + threshold &&\n    clientY >= popoverY - threshold &&\n    clientY <= popoverY + threshold + CONTAINER_PADDING * 2 + CONTAINER_HEIGHT\n  ) {\n    return false;\n  }\n  return true;\n};\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}