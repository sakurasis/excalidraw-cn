{"ast":null,"code":"import _slicedToArray from\"D:/project/excalidraw-cn/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React,{memo,useEffect,useState}from\"react\";import{EmptyLibraryUnit,LibraryUnit}from\"./LibraryUnit\";import{useTransition}from\"../hooks/useTransition\";import{jsx as _jsx}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";export var LibraryMenuSectionGrid=function LibraryMenuSectionGrid(_ref){var children=_ref.children;return/*#__PURE__*/_jsx(\"div\",{className:\"library-menu-items-container__grid\",children:children});};export var LibraryMenuSection=/*#__PURE__*/memo(function(_ref2){var items=_ref2.items,onItemSelectToggle=_ref2.onItemSelectToggle,onItemDrag=_ref2.onItemDrag,isItemSelected=_ref2.isItemSelected,onClick=_ref2.onClick,svgCache=_ref2.svgCache,itemsRenderedPerBatch=_ref2.itemsRenderedPerBatch;var _useTransition=useTransition(),_useTransition2=_slicedToArray(_useTransition,2),startTransition=_useTransition2[1];var _useState=useState(0),_useState2=_slicedToArray(_useState,2),index=_useState2[0],setIndex=_useState2[1];useEffect(function(){if(index<items.length){startTransition(function(){setIndex(index+itemsRenderedPerBatch);});}},[index,items.length,startTransition,itemsRenderedPerBatch]);return/*#__PURE__*/_jsx(_Fragment,{children:items.map(function(item,i){var _item$id;return i<index?/*#__PURE__*/_jsx(LibraryUnit,{elements:item===null||item===void 0?void 0:item.elements,isPending:!(item!==null&&item!==void 0&&item.id)&&!!(item!==null&&item!==void 0&&item.elements),onClick:onClick,svgCache:svgCache,id:item===null||item===void 0?void 0:item.id,selected:isItemSelected(item.id),onToggle:onItemSelectToggle,onDrag:onItemDrag},(_item$id=item===null||item===void 0?void 0:item.id)!==null&&_item$id!==void 0?_item$id:i):/*#__PURE__*/_jsx(EmptyLibraryUnit,{},i);})});});","map":{"version":3,"names":["React","memo","useEffect","useState","EmptyLibraryUnit","LibraryUnit","useTransition","jsx","_jsx","Fragment","_Fragment","LibraryMenuSectionGrid","_ref","children","className","LibraryMenuSection","_ref2","items","onItemSelectToggle","onItemDrag","isItemSelected","onClick","svgCache","itemsRenderedPerBatch","_useTransition","_useTransition2","_slicedToArray","startTransition","_useState","_useState2","index","setIndex","length","map","item","i","_item$id","elements","isPending","id","selected","onToggle","onDrag"],"sources":["D:/project/excalidraw-cn/src/components/LibraryMenuSection.tsx"],"sourcesContent":["import React, { memo, ReactNode, useEffect, useState } from \"react\";\nimport { EmptyLibraryUnit, LibraryUnit } from \"./LibraryUnit\";\nimport { LibraryItem } from \"../types\";\nimport { ExcalidrawElement, NonDeleted } from \"../element/types\";\nimport { SvgCache } from \"../hooks/useLibraryItemSvg\";\nimport { useTransition } from \"../hooks/useTransition\";\n\ntype LibraryOrPendingItem = (\n  | LibraryItem\n  | /* pending library item */ {\n      id: null;\n      elements: readonly NonDeleted<ExcalidrawElement>[];\n    }\n)[];\n\ninterface Props {\n  items: LibraryOrPendingItem;\n  onClick: (id: LibraryItem[\"id\"] | null) => void;\n  onItemSelectToggle: (id: LibraryItem[\"id\"], event: React.MouseEvent) => void;\n  onItemDrag: (id: LibraryItem[\"id\"], event: React.DragEvent) => void;\n  isItemSelected: (id: LibraryItem[\"id\"] | null) => boolean;\n  svgCache: SvgCache;\n  itemsRenderedPerBatch: number;\n}\n\nexport const LibraryMenuSectionGrid = ({\n  children,\n}: {\n  children: ReactNode;\n}) => {\n  return <div className=\"library-menu-items-container__grid\">{children}</div>;\n};\n\nexport const LibraryMenuSection = memo(\n  ({\n    items,\n    onItemSelectToggle,\n    onItemDrag,\n    isItemSelected,\n    onClick,\n    svgCache,\n    itemsRenderedPerBatch,\n  }: Props) => {\n    const [, startTransition] = useTransition();\n    const [index, setIndex] = useState(0);\n\n    useEffect(() => {\n      if (index < items.length) {\n        startTransition(() => {\n          setIndex(index + itemsRenderedPerBatch);\n        });\n      }\n    }, [index, items.length, startTransition, itemsRenderedPerBatch]);\n\n    return (\n      <>\n        {items.map((item, i) => {\n          return i < index ? (\n            <LibraryUnit\n              elements={item?.elements}\n              isPending={!item?.id && !!item?.elements}\n              onClick={onClick}\n              svgCache={svgCache}\n              id={item?.id}\n              selected={isItemSelected(item.id)}\n              onToggle={onItemSelectToggle}\n              onDrag={onItemDrag}\n              key={item?.id ?? i}\n            />\n          ) : (\n            <EmptyLibraryUnit key={i} />\n          );\n        })}\n      </>\n    );\n  },\n);\n"],"mappings":"8GAAA,MAAO,CAAAA,KAAK,EAAIC,IAAI,CAAaC,SAAS,CAAEC,QAAQ,KAAQ,OAAO,CACnE,OAASC,gBAAgB,CAAEC,WAAW,KAAQ,eAAe,CAI7D,OAASC,aAAa,KAAQ,wBAAwB,CAAC,OAAAC,GAAA,IAAAC,IAAA,gCAAAC,QAAA,IAAAC,SAAA,yBAoBvD,MAAO,IAAM,CAAAC,sBAAsB,CAAG,QAAzB,CAAAA,sBAAsBA,CAAAC,IAAA,CAI7B,IAHJ,CAAAC,QAAQ,CAAAD,IAAA,CAARC,QAAQ,CAIR,mBAAOL,IAAA,QAAKM,SAAS,CAAC,oCAAoC,CAAAD,QAAA,CAAEA,QAAQ,EAAO,CAC7E,CAAC,CAED,MAAO,IAAM,CAAAE,kBAAkB,cAAGd,IAAI,CACpC,SAAAe,KAAA,CAQa,IAPX,CAAAC,KAAK,CAAAD,KAAA,CAALC,KAAK,CACLC,kBAAkB,CAAAF,KAAA,CAAlBE,kBAAkB,CAClBC,UAAU,CAAAH,KAAA,CAAVG,UAAU,CACVC,cAAc,CAAAJ,KAAA,CAAdI,cAAc,CACdC,OAAO,CAAAL,KAAA,CAAPK,OAAO,CACPC,QAAQ,CAAAN,KAAA,CAARM,QAAQ,CACRC,qBAAqB,CAAAP,KAAA,CAArBO,qBAAqB,CAErB,IAAAC,cAAA,CAA4BlB,aAAa,EAAE,CAAAmB,eAAA,CAAAC,cAAA,CAAAF,cAAA,IAAlCG,eAAe,CAAAF,eAAA,IACxB,IAAAG,SAAA,CAA0BzB,QAAQ,CAAC,CAAC,CAAC,CAAA0B,UAAA,CAAAH,cAAA,CAAAE,SAAA,IAA9BE,KAAK,CAAAD,UAAA,IAAEE,QAAQ,CAAAF,UAAA,IAEtB3B,SAAS,CAAC,UAAM,CACd,GAAI4B,KAAK,CAAGb,KAAK,CAACe,MAAM,CAAE,CACxBL,eAAe,CAAC,UAAM,CACpBI,QAAQ,CAACD,KAAK,CAAGP,qBAAqB,CAAC,CACzC,CAAC,CAAC,CACJ,CACF,CAAC,CAAE,CAACO,KAAK,CAAEb,KAAK,CAACe,MAAM,CAAEL,eAAe,CAAEJ,qBAAqB,CAAC,CAAC,CAEjE,mBACEf,IAAA,CAAAE,SAAA,EAAAG,QAAA,CACGI,KAAK,CAACgB,GAAG,CAAC,SAACC,IAAI,CAAEC,CAAC,CAAK,KAAAC,QAAA,CACtB,MAAO,CAAAD,CAAC,CAAGL,KAAK,cACdtB,IAAA,CAACH,WAAW,EACVgC,QAAQ,CAAEH,IAAI,SAAJA,IAAI,iBAAJA,IAAI,CAAEG,QAAS,CACzBC,SAAS,CAAE,EAACJ,IAAI,SAAJA,IAAI,WAAJA,IAAI,CAAEK,EAAE,GAAI,CAAC,EAACL,IAAI,SAAJA,IAAI,WAAJA,IAAI,CAAEG,QAAQ,CAAC,CACzChB,OAAO,CAAEA,OAAQ,CACjBC,QAAQ,CAAEA,QAAS,CACnBiB,EAAE,CAAEL,IAAI,SAAJA,IAAI,iBAAJA,IAAI,CAAEK,EAAG,CACbC,QAAQ,CAAEpB,cAAc,CAACc,IAAI,CAACK,EAAE,CAAE,CAClCE,QAAQ,CAAEvB,kBAAmB,CAC7BwB,MAAM,CAAEvB,UAAW,GAAAiB,QAAA,CACdF,IAAI,SAAJA,IAAI,iBAAJA,IAAI,CAAEK,EAAE,UAAAH,QAAA,UAAAA,QAAA,CAAID,CAAC,CAClB,cAEF3B,IAAA,CAACJ,gBAAgB,IAAM+B,CAAC,CACzB,CACH,CAAC,CAAC,EACD,CAEP,CAAC,CACF"},"metadata":{},"sourceType":"module","externalDependencies":[]}