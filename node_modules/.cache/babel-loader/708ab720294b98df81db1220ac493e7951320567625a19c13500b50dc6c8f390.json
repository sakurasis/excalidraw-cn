{"ast":null,"code":"import _regeneratorRuntime from\"D:/project/excalidraw-cn/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"D:/project/excalidraw-cn/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"D:/project/excalidraw-cn/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import{useRef,useState}from\"react\";import*as Popover from\"@radix-ui/react-popover\";import{copyTextToSystemClipboard}from\"../clipboard\";import{useI18n}from\"../i18n\";import{Dialog}from\"./Dialog\";import{TextField}from\"./TextField\";import{FilledButton}from\"./FilledButton\";import{copyIcon,tablerCheckIcon}from\"./icons\";import\"./ShareableLinkDialog.scss\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";export var ShareableLinkDialog=function ShareableLinkDialog(_ref){var link=_ref.link,onCloseRequest=_ref.onCloseRequest,setErrorMessage=_ref.setErrorMessage;var _useI18n=useI18n(),t=_useI18n.t;var _useState=useState(false),_useState2=_slicedToArray(_useState,2),justCopied=_useState2[0],setJustCopied=_useState2[1];var timerRef=useRef(0);var ref=useRef(null);var copyRoomLink=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(){var _ref$current;return _regeneratorRuntime().wrap(function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:_context.prev=0;_context.next=3;return copyTextToSystemClipboard(link);case 3:setJustCopied(true);if(timerRef.current){window.clearTimeout(timerRef.current);}timerRef.current=window.setTimeout(function(){setJustCopied(false);},3000);_context.next=11;break;case 8:_context.prev=8;_context.t0=_context[\"catch\"](0);setErrorMessage(_context.t0.message);case 11:(_ref$current=ref.current)===null||_ref$current===void 0?void 0:_ref$current.select();case 12:case\"end\":return _context.stop();}},_callee,null,[[0,8]]);}));return function copyRoomLink(){return _ref2.apply(this,arguments);};}();return/*#__PURE__*/_jsx(Dialog,{onCloseRequest:onCloseRequest,title:false,size:\"small\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"ShareableLinkDialog\",children:[/*#__PURE__*/_jsx(\"h3\",{children:\"Shareable link\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"ShareableLinkDialog__linkRow\",children:[/*#__PURE__*/_jsx(TextField,{ref:ref,label:\"Link\",readonly:true,fullWidth:true,value:link,selectOnRender:true}),/*#__PURE__*/_jsxs(Popover.Root,{open:justCopied,children:[/*#__PURE__*/_jsx(Popover.Trigger,{asChild:true,children:/*#__PURE__*/_jsx(FilledButton,{size:\"large\",label:\"Copy link\",startIcon:copyIcon,onClick:copyRoomLink})}),/*#__PURE__*/_jsxs(Popover.Content,{onOpenAutoFocus:function onOpenAutoFocus(event){return event.preventDefault();},onCloseAutoFocus:function onCloseAutoFocus(event){return event.preventDefault();},className:\"ShareableLinkDialog__popover\",side:\"top\",align:\"end\",sideOffset:5.5,children:[tablerCheckIcon,\" copied\"]})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"ShareableLinkDialog__description\",children:[\"\\uD83D\\uDD12 \",t(\"alerts.uploadedSecurly\")]})]})});};","map":{"version":3,"names":["useRef","useState","Popover","copyTextToSystemClipboard","useI18n","Dialog","TextField","FilledButton","copyIcon","tablerCheckIcon","jsx","_jsx","jsxs","_jsxs","ShareableLinkDialog","_ref","link","onCloseRequest","setErrorMessage","_useI18n","t","_useState","_useState2","_slicedToArray","justCopied","setJustCopied","timerRef","ref","copyRoomLink","_ref2","_asyncToGenerator","_regeneratorRuntime","mark","_callee","_ref$current","wrap","_callee$","_context","prev","next","current","window","clearTimeout","setTimeout","t0","message","select","stop","apply","arguments","title","size","children","className","label","readonly","fullWidth","value","selectOnRender","Root","open","Trigger","asChild","startIcon","onClick","Content","onOpenAutoFocus","event","preventDefault","onCloseAutoFocus","side","align","sideOffset"],"sources":["D:/project/excalidraw-cn/src/components/ShareableLinkDialog.tsx"],"sourcesContent":["import { useRef, useState } from \"react\";\nimport * as Popover from \"@radix-ui/react-popover\";\n\nimport { copyTextToSystemClipboard } from \"../clipboard\";\nimport { useI18n } from \"../i18n\";\n\nimport { Dialog } from \"./Dialog\";\nimport { TextField } from \"./TextField\";\nimport { FilledButton } from \"./FilledButton\";\nimport { copyIcon, tablerCheckIcon } from \"./icons\";\n\nimport \"./ShareableLinkDialog.scss\";\n\nexport type ShareableLinkDialogProps = {\n  link: string;\n\n  onCloseRequest: () => void;\n  setErrorMessage: (error: string) => void;\n};\n\nexport const ShareableLinkDialog = ({\n  link,\n  onCloseRequest,\n  setErrorMessage,\n}: ShareableLinkDialogProps) => {\n  const { t } = useI18n();\n  const [justCopied, setJustCopied] = useState(false);\n  const timerRef = useRef<number>(0);\n  const ref = useRef<HTMLInputElement>(null);\n\n  const copyRoomLink = async () => {\n    try {\n      await copyTextToSystemClipboard(link);\n\n      setJustCopied(true);\n\n      if (timerRef.current) {\n        window.clearTimeout(timerRef.current);\n      }\n\n      timerRef.current = window.setTimeout(() => {\n        setJustCopied(false);\n      }, 3000);\n    } catch (error: any) {\n      setErrorMessage(error.message);\n    }\n\n    ref.current?.select();\n  };\n\n  return (\n    <Dialog onCloseRequest={onCloseRequest} title={false} size=\"small\">\n      <div className=\"ShareableLinkDialog\">\n        <h3>Shareable link</h3>\n        <div className=\"ShareableLinkDialog__linkRow\">\n          <TextField\n            ref={ref}\n            label=\"Link\"\n            readonly\n            fullWidth\n            value={link}\n            selectOnRender\n          />\n          <Popover.Root open={justCopied}>\n            <Popover.Trigger asChild>\n              <FilledButton\n                size=\"large\"\n                label=\"Copy link\"\n                startIcon={copyIcon}\n                onClick={copyRoomLink}\n              />\n            </Popover.Trigger>\n            <Popover.Content\n              onOpenAutoFocus={(event) => event.preventDefault()}\n              onCloseAutoFocus={(event) => event.preventDefault()}\n              className=\"ShareableLinkDialog__popover\"\n              side=\"top\"\n              align=\"end\"\n              sideOffset={5.5}\n            >\n              {tablerCheckIcon} copied\n            </Popover.Content>\n          </Popover.Root>\n        </div>\n        <div className=\"ShareableLinkDialog__description\">\n          ðŸ”’ {t(\"alerts.uploadedSecurly\")}\n        </div>\n      </div>\n    </Dialog>\n  );\n};\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}